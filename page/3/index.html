<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    fxh
</title>
<link rel="shortcut icon" href="https://caifxh.github.io/favicon.ico?v=1586405129501">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://caifxh.github.io/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://caifxh.github.io/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://caifxh.github.io">
                <img class="avatar" src="https://caifxh.github.io/images/avatar.png?v=1586405129501" alt="">
            </a>
            <div class="site-title">
                <h1>
                    fxh
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    é¦–é¡µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-container main-container">
                <div id="content" class="main-container-left">
                    
        
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/dan-diao-dui-lie-you-hua-dp/">
                        å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–dp
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-27</time>
                    
                        <a href="https://caifxh.github.io/tag/hLQFdtGuD/" class="post-tag i-tag
                            i-tag-other_4">
            #DP
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            


acwing272



#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=3010;
int f[2][N];
int a[N],b[N];
int n;
int ans;

int main()
{
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	for(int i=1;i&amp;lt;=n;i++) scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);
	for(int i=1;i&amp;lt;=n;i++) scanf(&amp;quot;%d&amp;quot;,&amp;amp;b[i]);
	
	for(int i=1;i&amp;lt;=n;i++)
	{
		int val=0;//è®°å½•å†³ç­–é›†åˆS(i,j)ä¸­dp[i-1][k]çš„æœ€å¤§å€¼
		for(int j=1;j&amp;lt;=n;j++)
		{
			if(a[i] != b[j]) f[i&amp;amp;1][j]=f[i-1&amp;amp;1][j];
			else f[i&amp;amp;1][j]=val+1;
			if(b[j] &amp;lt; a[i]) val=max(val,f[i-1&amp;amp;1][j]);//jæ»¡è¶³æ¡ä»¶ï¼ŒåŠ å…¥å†³ç­–é›†åˆï¼Œæ›´æ–°æœ€å€¼ 
		}
	}
	
	for(int i=1;i&amp;lt;=n;i++)
	    ans=max(ans,f[n&amp;amp;1][i]);
			
	printf(&amp;quot;%d\n&amp;quot;,ans);
	return 0;
}

poj2373
åœ¨ä¸€ç‰‡è‰åœºä¸Š:æœ‰ä¸€æ¡é•¿åº¦ä¸ºL (1 &amp;lt;= L &amp;lt;= 1,000,000ï¼Œ Lä¸ºå¶æ•°)çš„çº¿æ®µã€‚ Johnçš„N (1 &amp;lt;= N &amp;lt;= 1000)å¤´å¥¶ç‰›éƒ½æ²¿ç€è‰åœºä¸Šè¿™æ¡çº¿æ®µåƒè‰ï¼Œæ¯å¤´ç‰›çš„æ´»åŠ¨èŒƒå›´æ˜¯ä¸€ä¸ªå¼€åŒºé—´(S,E)ï¼Œ Sï¼ŒEéƒ½æ˜¯æ•´æ•°ã€‚ä¸åŒå¥¶ç‰›çš„æ´»åŠ¨èŒƒå›´å¯ä»¥æœ‰é‡å ã€‚Johnè¦åœ¨è¿™æ¡çº¿æ®µä¸Šå®‰è£…å–·æ°´å¤´çŒæº‰è‰åœºã€‚æ¯ä¸ªå–·æ°´å¤´çš„å–·æ´’åŠå¾„å¯ä»¥éšæ„è°ƒèŠ‚ï¼Œè°ƒèŠ‚èŒƒå›´æ˜¯ [A B ](1 &amp;lt;= A &amp;lt;= B &amp;lt;= 1000)ï¼ŒA,Béƒ½æ˜¯æ•´æ•°ã€‚è¦æ±‚çº¿æ®µä¸Šçš„æ¯ä¸ªæ•´ç‚¹æ°å¥½ä½äºä¸€ä¸ªå–·æ°´å¤´çš„å–·æ´’èŒƒå›´å†…æ¯å¤´å¥¶ç‰›çš„æ´»åŠ¨èŒƒå›´è¦ä½äºä¸€ä¸ªå–·æ°´å¤´çš„å–·æ´’èŒƒå›´å†…ä»»ä½•å–·æ°´å¤´çš„å–·æ´’èŒƒå›´ä¸å¯è¶Šè¿‡çº¿æ®µçš„ä¸¤ç«¯(å·¦ç«¯æ˜¯0,å³ç«¯æ˜¯L )ã€‚
è¯·é—®ï¼Œ John æœ€å°‘éœ€è¦å®‰è£…å¤šå°‘ä¸ªå–·æ°´å¤´ã€‚





çŠ¶æ€dp[i] è¡¨ç¤ºæ°å¥½åˆ°è¦†ç›–åˆ° [0, i]æ—¶æœ€å°‘éœ€è¦çš„å–·æ°´è£…ç½®æ•°é‡, ç­”æ¡ˆè‡ªç„¶ä¹Ÿå°±æ˜¯dp[L], æŠŠé•¿åº¦ä½œä¸ºå®¹é‡,æ˜¯çº¿æ€§Dpçš„ä¸€ç§å¸¸è§æ–¹æ¡ˆ


iä¸€å®šæ˜¯å¶æ•°, å› ä¸ºæˆ‘ä»¬çš„ç›®çš„æ˜¯æ”¾ç½®åˆé€‚çš„å–·æ°´è£…ç½®æ¥è¦†ç›–, 2*r(ç›´å¾„)ä¸€å®šæ˜¯å¶æ•°


iä¸€å®šä¸åœ¨å¥¶ç‰›çš„èŒƒå›´ä¹‹å†…, å› ä¸ºå¦‚æœiåœ¨æŸå¥¶ç‰›èŒƒå›´ä¹‹å†…, è¯¥å¥¶ç‰›èŒƒå›´ä¹Ÿå°±è¢«åˆ†å‰²ä¸ºäº†ä¸¤å—,ä¸ç¬¦åˆé¢˜ä¸­è¦æ±‚çš„æ°å¥½ä½äºä¸€ä¸ªå–·æ°´å™¨çš„è¦†ç›–èŒƒå›´å†…


iä¸€å®šå¤§äº2*a, å› ä¸ºæœ€å°åŠå¾„æ˜¯a


å¯¹äºi &amp;gt; 2 *aæ—¶, dp[i]åœ¨æ»¡è¶³12çš„æƒ…å†µä¸‹, åº”è¯¥åœ¨[i-2b, i-2a]è¿™ä¸ªåŒºé—´ä¸­æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„+1.è¿™ä¸ªåœ°æ–¹éœ€è¦ä»”ç»†ç†ä¸€ä¸‹, å°±æ˜¯dp[i]å¹¶ä¸è¡¨ç¤ºæŠŠå–·æ°´å™¨æ”¾åœ¨äº†i, è€Œæ˜¯æ”¾åœ¨äº†[i-2b, i-2a]è¿™ä¸ªåŒºé—´ä¸­, ä¾æ¬¡é€’æ¨.


å¯å¾—çŠ¶æ€è½¬ç§»æ–¹ç¨‹: dp[i] = min{dp[j] | i-2b &amp;lt;= j &amp;lt;= i-2a} +1
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=1e6+10,INF=0x3f3f3f3f;
int f[N];
bool flag[N];
int n,l,a,b;

int main()
{
	cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;l&amp;gt;&amp;gt;a&amp;gt;&amp;gt;b;
	memset(f,0x3f,sizeof f);
	
	for(int i=0;i&amp;lt;n;i++)
	{
		int s,e;
		cin&amp;gt;&amp;gt;s&amp;gt;&amp;gt;e;
		for(int j=s+1;j&amp;lt;e;j++)
			flag[j]=1;
	}
	
	if(l &amp;amp; 1) puts(&amp;quot;-1&amp;quot;);
	else 
	{
		f[0]=0;
		for(int i=2;i&amp;lt;=l;i+=2)
		{
			if(!flag[i])
			{
				int val=INF;
				for(int j=a;j&amp;lt;=b;j++)
				{
					int k=i-2*j;
					if(k &amp;lt; 0) break;
					val=min(val,f[k]);
				}
				f[i]=val+1;
			}
		}
		
		if(f[l] &amp;gt;= INF) puts(&amp;quot;-1&amp;quot;);
		else cout&amp;lt;&amp;lt;f[l]&amp;lt;&amp;lt;endl;
	}
	return 0;
}




code

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=1e6+10,INF=0x3f3f3f3f;
int f[N];
int q[N];
bool flag[N];
int n,l,a,b;

int main()
{
	cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;l&amp;gt;&amp;gt;a&amp;gt;&amp;gt;b;
	memset(f,0x3f,sizeof f);
	
	for(int i=0;i&amp;lt;n;i++)
	{
		int s,e;
		cin&amp;gt;&amp;gt;s&amp;gt;&amp;gt;e;
		for(int j=s+1;j&amp;lt;e;j++)
			flag[j]=1;
	}
	
	f[0]=0;
	int hh=0,tt=-1;
	for(int i=a*2;i&amp;lt;=l;i+=2)
	{
		if(hh &amp;lt;= tt &amp;amp;&amp;amp; i-2*b &amp;gt; q[hh]) hh++;
		while(hh&amp;lt;=tt &amp;amp;&amp;amp; f[q[tt]] &amp;gt;= f[i-2*a])
			tt--;
		q[++tt]=i-2*a;
		if(!flag[i]) f[i]=f[q[hh]]+1;
	}
	
	if(f[l] &amp;gt;= INF) puts(&amp;quot;-1&amp;quot;);
	else cout&amp;lt;&amp;lt;f[l]&amp;lt;&amp;lt;endl;

	return 0;
}

acwing1088



#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=2e6+10;
typedef long long LL;
int p[N],d[N];
LL s[N];
int q[N];
bool ans[N];
int n;

int main()
{
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    for(int i=1;i&amp;lt;=n;i++)
    {
        scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;p[i],&amp;amp;d[i]);
        p[i+n]=p[i];
        d[i+n]=d[i];
    }

    for(int i=1;i&amp;lt;=n*2;i++) s[i]=s[i-1]+p[i]-d[i];

    int hh=0,tt=-1;
    for(int i=1;i&amp;lt;=n*2;i++)//é¡ºæ—¶é’ˆæ±‚é•¿åº¦ä¸ºnçš„çª—å£å†…å‰ç¼€å’Œçš„æœ€å°å€¼
    {
        if(hh &amp;lt;= tt &amp;amp;&amp;amp; i - q[hh] &amp;gt;= n) hh++;

        while(hh &amp;lt;= tt &amp;amp;&amp;amp; s[q[tt]] &amp;gt;= s[i])
            tt--;
        q[++tt]=i;
        if(i &amp;gt;= n &amp;amp;&amp;amp; s[q[hh]] &amp;gt;= s[i-n])
            ans[i-n+1]=true;
    }

    d[0]=d[n];
    for(int i=n*2;i&amp;gt;=1;i--) s[i]=s[i+1]+p[i]-d[i-1];

    hh=0,tt=-1;
    for(int i=n*2;i&amp;gt;=1;i--)//é€†æ—¶é’ˆæ±‚é•¿åº¦ä¸ºnçš„çª—å£å†…åç¼€å’Œçš„æœ€å°å€¼
    {
        if(hh &amp;lt;= tt &amp;amp;&amp;amp; q[hh]-i &amp;gt;= n) hh++;

        while(hh &amp;lt;= tt &amp;amp;&amp;amp; s[q[tt]] &amp;gt;= s[i])
            tt--;
        q[++tt]=i;
        if(i&amp;lt;=n+1 &amp;amp;&amp;amp; s[q[hh]] &amp;gt;= s[i+n])
            ans[i-1]=true;
    }

    for(int i=1;i&amp;lt;=n;i++)
        if(ans[i]) puts(&amp;quot;TAK&amp;quot;);
        else puts(&amp;quot;NIE&amp;quot;);
    return 0;   
}

acwing1089

#include &amp;lt;cstring&amp;gt;
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
const int N = 2e5 + 10, INF = 0x3f3f3f3f;
int n, m;
int w[N], q[N];
int f[N];

int main()
{
    scanf(&amp;quot;%d%d&amp;quot;, &amp;amp;n, &amp;amp;m);
    for (int i = 1; i &amp;lt;= n; i ++ ) scanf(&amp;quot;%d&amp;quot;, &amp;amp;w[i]);

    int hh = 0, tt = 0;
    q[0]=0;
    for (int i = 1; i &amp;lt;= n; i ++ )
    {
        if (i - q[hh] &amp;gt; m) hh ++ ;
        f[i] = f[q[hh]] + w[i];
        while (hh &amp;lt;= tt &amp;amp;&amp;amp; f[q[tt]] &amp;gt;= f[i]) tt -- ;
        q[ ++ tt] = i;
    }

    int res = INF;
    for (int i = n - m + 1; i &amp;lt;= n; i ++ ) res = min(res, f[i]);
    printf(&amp;quot;%d\n&amp;quot;, res);

    return 0;
}

acwing1090

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=50010,INF=0x3f3f3f3f;
int n,t;
int a[N];
int f[N];
int q[N];

bool check(int mid)
{
    int hh=0,tt=-1;
    q[++tt]=0;
    for(int i=1;i&amp;lt;=n;i++)
    {
        if(hh &amp;lt;= tt &amp;amp;&amp;amp; i - q[hh] &amp;gt; mid+1) hh++;
        f[i]=f[q[hh]]+a[i];
        while(hh &amp;lt;= tt &amp;amp;&amp;amp; f[q[tt]] &amp;gt;= f[i])
            tt--;
        q[++tt]=i;
    }
    
    int res=INF;
    for(int i=n-mid;i&amp;lt;=n;i++)
        res=min(res,f[i]);
    
    return res&amp;lt;=t;
}

int main()
{
    cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;t;
    for(int i=1;i&amp;lt;=n;i++)
        cin&amp;gt;&amp;gt;a[i];

    int l=0,r=n;
    while(l &amp;lt; r)
    {
        int mid=l+r&amp;gt;&amp;gt;1;
        if(check(mid))
            r=mid;
        else
            l=mid+1;
    }
    
    cout&amp;lt;&amp;lt;l&amp;lt;&amp;lt;endl;
    return 0;
}

acwing1087

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
typedef long long LL;
const int N=100010;
LL f[N][2];
int n,k;
int e[N];
LL s[N];
int q[N];

int main()
{
    cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;k;
    
    for(int i=1;i&amp;lt;=n;i++)
        cin&amp;gt;&amp;gt;e[i];
        
    for(int i=1;i&amp;lt;=n;i++)
    	s[i]=s[i-1]+e[i];
    
    int hh=0,tt=-1;
    q[++tt]=0;
    for(int i=1;i&amp;lt;=n;i++)
    {
    	f[i][0]=max(f[i-1][0],f[i-1][1]);
    	if(hh &amp;lt;= tt &amp;amp;&amp;amp; i-q[hh] &amp;gt; k) hh++;
    	
    	f[i][1]=f[q[hh]][0]-s[q[hh]]+s[i];
    	while(hh &amp;lt;= tt &amp;amp;&amp;amp; f[i][0]-s[i] &amp;gt;= f[q[tt]][0] -s[q[tt]])
    		tt--;
    	q[++tt]=i;
	}
	
	cout&amp;lt;&amp;lt;max(f[n][0],f[n][1])&amp;lt;&amp;lt;endl;
	return 0;
}

acwing1087

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
typedef long long LL;
const int N=100010,INF=0x3f3f3f3f;
LL f[N];
int n,k;
int e[N];
LL s[N];
int q[N];

int main()
{
    cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;k;
    
    for(int i=1;i&amp;lt;=n;i++)
        cin&amp;gt;&amp;gt;e[i];
        
    for(int i=1;i&amp;lt;=n;i++)
    	s[i]=s[i-1]+e[i];
    
    int hh=0,tt=-1;
    q[++tt]=0;
    for(int i=1;i&amp;lt;=n;i++)
    {
    	if(hh &amp;lt;= tt &amp;amp;&amp;amp; i-q[hh] &amp;gt; k) hh++;
    	
    	f[i]=f[q[hh]-1]-s[q[hh]]+s[i];
    	while(hh &amp;lt;= tt &amp;amp;&amp;amp; f[i-1]-s[i] &amp;gt;= f[q[tt]-1] -s[q[tt]])
    		tt--;
    	q[++tt]=i;
	}
	
	LL res=-1e18;
	for(int i=n-k;i&amp;lt;=n;i++)
	    res=max(res,f[i]);
	cout&amp;lt;&amp;lt;res&amp;lt;&amp;lt;endl;
	return 0;
}

acwing1091
å…ˆç”¨æ»‘åŠ¨çª—å£+å•è°ƒé˜Ÿåˆ—æ±‚å‡ºæ¯ä¸€è¡Œé•¿åº¦ä¸ºkçš„è¿ç»­åºåˆ—ä¸­çš„æœ€å¤§å€¼ã€æœ€å°å€¼ï¼Œ
å­˜åˆ°rmin[i][j],rmax[i][j]ä¸¤ä¸ªæ•°ç»„é‡Œï¼Œ
å†ç”¨ç›¸åŒçš„æ–¹æ³•æ±‚è¿™ä¸¤ä¸ªæ•°ç»„ä¸­æ¯ä¸€åˆ—é•¿åº¦ä¸ºkçš„è¿ç»­åºåˆ—çš„æœ€å¤§å€¼ã€æœ€å°å€¼å­˜åˆ°cmin[i],cmax[i]ä¸­ã€‚
éå†cmin,cmaxå¾—å‡ºç­”æ¡ˆã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=1010,INF=0x3f3f3f3f;
int n,m,k;
int a[N][N];
int rmax[N][N],rmin[N][N];
int cmax[N],cmin[N];
int tmp[N];
int q[N];

void get(int a[],int b[],int len,int type)//0:æœ€å°å€¼ï¼Œ1ï¼šæœ€å¤§å€¼ 
{
    int hh=0,tt=-1;
    for(int i=1;i&amp;lt;=len;i++)
    {
        if(hh &amp;lt;= tt &amp;amp;&amp;amp; i-q[hh] &amp;gt;=k) hh++;
        while(hh &amp;lt;= tt &amp;amp;&amp;amp;(type?a[q[tt]]&amp;lt;=a[i]:a[q[tt]]&amp;gt;=a[i]))
            tt--;
        q[++tt]=i;
        b[i]=a[q[hh]];
    }
}

int main()
{
    scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;m,&amp;amp;k);

    for(int i=1;i&amp;lt;=n;i++)
        for(int j=1;j&amp;lt;=m;j++)
            scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i][j]);

    for(int i=1;i&amp;lt;=n;i++)
    {
        get(a[i],rmin[i],m,0);
        get(a[i],rmax[i],m,1);
    }

    int ans=INF;
    for(int i=k;i&amp;lt;=m;i++)
    {
        for(int j=1;j&amp;lt;=n;j++) tmp[j]=rmin[j][i];
        get(tmp,cmin,n,0);

        for(int j=1;j&amp;lt;=n;j++) tmp[j]=rmax[j][i];
        get(tmp,cmax,n,1);

        for(int j=k;j&amp;lt;=n;j++)
            ans=min(ans,cmax[j]-cmin[j]);
    }

    printf(&amp;quot;%d\n&amp;quot;,ans);

    return 0;   
}


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/dan-diao-dui-lie-you-hua-dp/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/shu-zhuang-shu-zu/">
                        æ ‘çŠ¶æ•°ç»„
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-27</time>
                    
                        <a href="https://caifxh.github.io/tag/DuNwWZ602/" class="post-tag i-tag
                            i-tag-info">
            #é«˜çº§æ•°æ®ç»“æ„
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            æ ‘çŠ¶æ•°ç»„




sum[9]=c[9]+c[8];












#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int maxn=10000;
int n,a[maxn],c[maxn],s[maxn];

int lowbit(int i)//c[i]çš„åŒºé—´é•¿åº¦ 
{
	return (-i)&amp;amp;i;
}

void add(int i,int z)//a[i]åŠ ä¸Šz
{
	for(;i&amp;lt;=n;i+=lowbit(i))//ç›´æ¥åç»§ï¼Œå³çˆ¶äº²i+=lowbit(i)
		c[i]+=z;	
} 

int sum(int i)//æ±‚å‰ç¼€å’Œa[1]..a[i] 
{
	int s=0;
	for(;i&amp;gt;0;i-=lowbit(i))//ç›´æ¥å‰é©± i-=lowbit(i);
		s+=c[i];
	return s; 
}

int sum(int i,int j)//æ±‚åŒºé—´å’Œa[i]..a[j] 
{
	return sum(j)-sum(i-1); 
}

int main()
{
	memset(c,0,sizeof(c));
	cin&amp;gt;&amp;gt;n;
	for(int i=1;i&amp;lt;=n;i++)
	{
		cin&amp;gt;&amp;gt;a[i];
		add(i,a[i]);//åŠ å…¥æ ‘çŠ¶æ•°ç»„ 
	} 
	int x1,x2;
	cin&amp;gt;&amp;gt;x1;
	cout&amp;lt;&amp;lt;sum(x1)&amp;lt;&amp;lt;endl;
	cin&amp;gt;&amp;gt;x1&amp;gt;&amp;gt;x2;
	cout&amp;lt;&amp;lt;sum(x1,x2)&amp;lt;&amp;lt;endl;
	return 0;
}






#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int maxn=10000;
int n,a[maxn][maxn],c[maxn][maxn];//äºŒç»´æ ‘çŠ¶æ•°ç»„ 

int lowbit(int i)//åŒºé—´é•¿åº¦ 
{
	return (-i)&amp;amp;i;
}

void add(int x,int y,int z)//a[x][y]åŠ ä¸Šz
{
	for(int i=x;i&amp;lt;=n;i+=lowbit(i))
		for(int j=y;j&amp;lt;=n;j+=lowbit(j))
			c[i][j]+=z;
} 

int sum(int x,int y)//æ±‚å·¦ä¸Šè§’(1,1)åˆ°å³ä¸‹è§’(x,y)çŸ©é˜µåŒºé—´å’Œ 
{
	int s=0;
	for(int i=x;i&amp;gt;0;i-=lowbit(i))
		for(int j=y;j&amp;gt;0;j-=lowbit(j))
			s+=c[i][j];
	return s; 
}

int sum(int x1,int y1,int x2,int y2)//æ±‚å·¦ä¸Šè§’(x1,y1)åˆ°å³ä¸‹è§’(x2,y2)å­çŸ©é˜µåŒºé—´å’Œ 
{
	return sum(x2,y2)-sum(x1-1,y2)-sum(x2,y1-1)+sum(x1-1,y1-1); 
}

int main()
{
	for(int i=1;i&amp;lt;=n;i++)
		memset(c[i],0,sizeof(c[i]));
	cin&amp;gt;&amp;gt;n;
	for(int i=1;i&amp;lt;=n;i++)
		for(int j=1;j&amp;lt;=n;j++)
		{
			cin&amp;gt;&amp;gt;a[i][j];
			add(i,j,a[i][j]);//åŠ å…¥æ ‘çŠ¶æ•°ç»„ 
		} 
	int x1,y1,x2,y2;
	cin&amp;gt;&amp;gt;x1&amp;gt;&amp;gt;y1;
	cout&amp;lt;&amp;lt;sum(x1,y1)&amp;lt;&amp;lt;endl;
	cin&amp;gt;&amp;gt;x1&amp;gt;&amp;gt;y1&amp;gt;&amp;gt;x2&amp;gt;&amp;gt;y2;
	cout&amp;lt;&amp;lt;sum(x1,y1,x2,y2)&amp;lt;&amp;lt;endl;
	return 0;
}

poj2352
ç»Ÿè®¡xå‰é¢æ¯”å®ƒå°çš„æ˜Ÿæ˜Ÿçš„ä¸ªæ•°ã€‚æ³¨æ„çš„æ˜¯ï¼šç»™çš„ç‚¹çš„åæ ‡æ˜¯ä»0å¼€å§‹çš„ï¼Œæ ‘çŠ¶æ•°ç»„ä¸‹æ ‡ä¸º0çš„ä½ç½®ä¸å¯ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨è¾“å…¥xåæ ‡æ—¶+1ã€‚
å› ä¸ºæœ¬é¢˜ç»™å‡ºçš„æ•°æ®å°±æ˜¯å·²ç»æŒ‰ç…§yä»å°åˆ°å¤§æ’å¥½åºçš„,ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“å‰è¯»åˆ°ä¸€ä¸ªç‚¹çš„æ—¶å€™ï¼Œå½“å‰ç‚¹çš„yåæ ‡è‚¯å®šæ¯”å·²ç»è¯»å…¥çš„å¤§ï¼Œæˆ–è€…ç­‰äºã€‚å°±ç®—æ˜¯ç­‰äºçš„è¯ï¼Œä¹Ÿæ˜¯xåæ ‡æ¯”æˆ‘å½“å‰ç‚¹çš„xåæ ‡å°ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯æ¬¡åªè¦ç®—xåæ ‡æ¯”æˆ‘ä»¬å°çš„å°±è¡Œäº† ã€‚


#include&amp;lt;cstdio&amp;gt;
using namespace std;
#define maxn 32010
int ans[maxn],tr[maxn];//ç­‰çº§ç»Ÿè®¡ï¼Œæ¯ä¸ªå€¼çš„æ•°é‡ 
int n;

int lowbit(int x)
{
	return x&amp;amp;-x;
}

void add(int x,int c)//å°†ç¬¬iä¸ªå…ƒç´ å¢åŠ valï¼Œå…¶åç»§ä¹Ÿè¦å¢åŠ 
{
	for(int i=x;i&amp;lt;=maxn;i+=lowbit(i))//æ˜¯xç‚¹çš„èŒƒå›´ï¼Œæ³¨æ„ä¸æ˜¯æ˜Ÿæ˜Ÿçš„ä¸ªæ•°n 
		tr[i]+=c;//içš„åç»§ï¼ˆçˆ¶ç»“ç‚¹ï¼‰ 
}

int sum(int x)//å‰ç¼€å’Œ 
{
	int res=0;
	for(int i=x;i;i-=lowbit(i))
		res+=tr[i];//içš„å‰é©±
	return res;
}

int main()
{
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    int x,y;
    for(int i=0;i&amp;lt;n;i++)
    {
        scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;x,&amp;amp;y);
        x++;
        ans[sum(x)]++;
        add(x,1);//xçš„æ•°é‡c[x]å¢1,è‹¥æ˜¯ç»Ÿè®¡å°äºç­‰äºxçš„æ•°é‡ï¼Œåˆ™å…ˆæ‰§è¡Œaddæ“ä½œå†æŸ¥è¯¢ 
    }
    for(int i=0;i&amp;lt;n;i++)
        printf(&amp;quot;%d\n&amp;quot;,ans[i]);
	return 0;
}

æ ‘çŠ¶æ•°ç»„æ±‚é€†åºå¯¹
1ï¼‰é€†åºæ•°é—®é¢˜å®šä¹‰
ç»™ä¸€ä¸ª1~nçš„æ’åˆ—ï¼Œæ±‚æ»¡è¶³i&amp;lt;jä¸”a[i]&amp;gt;a[j]çš„äºŒå…ƒç»„å¯¹æ•°ï¼Œæ¯”å¦‚[4,2,1,5,3]è¿™ä¸ªåºåˆ—ï¼Œæ»¡è¶³æ¡ä»¶çš„äºŒå…ƒç»„ä¸º{&amp;lt;4,2&amp;gt;, &amp;lt;4,1&amp;gt;, &amp;lt;4,3&amp;gt;, &amp;lt;2,1&amp;gt;, &amp;lt;5,3&amp;gt;}ï¼Œæ•…é€†åºæ•°æ˜¯5
2ï¼‰æ ‘çŠ¶æ•°ç»„æ±‚é€†åºæ•°çš„åŸç†
é¦–å…ˆæ˜ç¡®æ ‘çŠ¶æ•°ç»„åœ¨æ­¤é—®é¢˜ä¸­ç»´æŠ¤ä¿¡æ¯æ˜¯æŸä¸ªåŒºé—´ä¸­æ•°å­—å‡ºç°çš„ä¸ªæ•°ï¼Œsum(a[i])å¯æ±‚å¾—[1, a[i]]çš„åŒºé—´å’Œï¼Œè¿™æ°å¥½ä»£è¡¨ç¬¬iä¸ªæ•°å­—å‰å°äºå®ƒçš„ä¸ªæ•°ï¼Œï¼Œé‚£ä¹ˆå¤§äºå®ƒçš„æ˜¾ç„¶å°±æœ‰sum(n)-sum(a[i])ä¸ª,ç„¶åå°†æºæ•°æ®æŒ‰å…¶åŸæœ¬é¡ºåºæ’å…¥æ ‘çŠ¶æ•°ç»„ï¼Œç¬¬iä¸ªæ•°å­—æ’å…¥çš„æ–¹å¼ä¸ºå°†æ ‘çŠ¶æ•°ç»„çš„ç¬¬a[i]ä½è®¾ä¸º1ï¼ŒåŒæ—¶æ›´æ–°è¦†ç›–åˆ°å®ƒçš„çˆ¶åŒºé—´ã€‚
for (int i = 1; i &amp;lt;= n; i++) 
{
    ans += sum(n) - sum(a[i]);
    add(a[i], 1);
}

ç´¯åŠ æ¯æ­¥çš„ç»“æœåå¯å¾—é€†åºæ•°ä¸º5ï¼Œç”¨æ ‘çŠ¶æ•°ç»„çš„å¥½å¤„åœ¨äºaddæ“ä½œå’Œsumçš„æ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(logn)ï¼Œéå¸¸çš„å·§å¦™
poj3067
ç”±äºxæ˜¯ä»å°åˆ°å¤§æ’åºçš„ï¼Œå‡è®¾å½“å‰æˆ‘ä»¬åœ¨å¤„ç†ç¬¬kæ¡è¾¹ï¼Œé‚£ä¹ˆç¬¬1~k-1æ¡è¾¹çš„xå¿…ç„¶æ˜¯å°äºï¼ˆç­‰äºæ—¶å€™æš‚ä¸”ä¸è®¨è®ºï¼‰ç¬¬kæ¡è¾¹çš„ x çš„ï¼Œé‚£ä¹ˆå‰k-1æ¡è¾¹ä¸­ï¼Œä¸ç¬¬kæ¡è¾¹ç›¸äº¤çš„è¾¹çš„yå€¼å¿…ç„¶å¤§äºykçš„ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦æ±‚å‡ºåœ¨å‰k-1æ¡è¾¹ä¸­æœ‰å¤šå°‘æ¡è¾¹çš„yå€¼åœ¨åŒºé—´[yk, M]å³å¯,ä¹Ÿå°±æ˜¯æ±‚ykçš„é€†åºæ•°ï¼ŒMä¸ºè¥¿å²¸åŸå¸‚ä¸ªæ•°ï¼Œå³yçš„æœ€å¤§å€¼ã€‚
æ‰€ä»¥å°±å°†é—®é¢˜è½¬åŒ–æˆåŒºé—´æ±‚å’Œçš„é—®é¢˜ï¼Œæ ‘çŠ¶æ•°ç»„è§£å†³ã€‚å½“ä¸¤æ¡è¾¹çš„xç›¸åŒæ—¶ï¼Œæˆ‘ä»¬è®°è¿™ä¸¤æ¡è¾¹çš„yå€¼åˆ†åˆ«ä¸ºyaï¼Œybï¼ˆya&amp;lt;yb),æˆ‘ä»¬å…ˆå¤„ç†ï¼ˆxï¼Œyaï¼‰ï¼Œå†å¤„ç†ï¼ˆxï¼Œybï¼‰ï¼ŒåŸå› å¾ˆæ˜æ˜¾ï¼Œå› ä¸ºå½“xç›¸åŒæ—¶ï¼Œè¿™ä¸¤æ¡è¾¹æ˜¯è®¤ä¸ºæ²¡æœ‰äº¤ç‚¹çš„ï¼Œè‹¥å…ˆå¤„ç†ï¼ˆxï¼Œybï¼‰ï¼Œé‚£ä¹ˆä¸‹æ¬¡å¤„ç†ï¼ˆxï¼Œyaï¼‰æ—¶ï¼Œï¼ˆxï¼Œyaï¼‰å°±ä¼šç»™ï¼ˆxï¼Œybï¼‰å¢åŠ ä¸€ä¸ªé€†åºï¼Œä¹Ÿå°±æ˜¯å°†è¿™ä¸¤æ¡è¾¹åšç›¸äº¤å¤„ç†äº†ã€‚
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=1010,M=1000010;
int tr[N];
int n,m,k;
struct Edge 
{
    int x, y;
    bool operator&amp;lt; (const Edge &amp;amp;W) const 
    {
    	if(x == W.x)
    		return y&amp;lt;W.y;
    	else
    		return x&amp;lt;W.x;
	}
}e[M];
typedef long long LL;

int lowbit(int x)
{
	return x&amp;amp;-x;
}

void add(int x)//åŠ 1æ“ä½œï¼Œå‚æ•°çœç•¥
{
	for(int i=x;i&amp;lt;=m;i+=lowbit(i))//yç‚¹æœ‰mä¸ª
		tr[i]++;
}

int sum(int x)
{
    int res=0;
    for(int i=x;i;i-=lowbit(i))
    	res+=tr[i];
    return res;
}

int main()
{
    int T;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;T);
    for(int kase=1;kase&amp;lt;=T;kase++)
	{
		memset(tr,0,sizeof tr);
	    scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;m,&amp;amp;k);
	    for(int i=1;i&amp;lt;=k;i++)
			scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;e[i].x,&amp;amp;e[i].y);
	    sort(e+1,e+k+1);
	    LL ans=0;
	    for(int i=1;i&amp;lt;=k;i++)
		{
			ans+=sum(m)-sum(e[i].y);
			add(e[i].y);
	    }
	    printf(&amp;quot;Test case %d: %lld\n&amp;quot;,kase,ans);
	}
    return 0;
}

acwing241

#include &amp;lt;cstdio&amp;gt;
#include &amp;lt;cstring&amp;gt;
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
typedef long long LL;
const int N = 200010;
int n;
int a[N];
int tr[N];
int bigger[N], lower[N];

int lowbit(int x)
{
    return x &amp;amp; -x;
}

void add(int x, int c)
{
    for (int i = x; i &amp;lt;= n; i += lowbit(i)) tr[i] += c;
}

int sum(int x)
{
    int res = 0;
    for (int i = x; i; i -= lowbit(i)) res += tr[i];
    return res;
}

int main()
{
    scanf(&amp;quot;%d&amp;quot;, &amp;amp;n);

    for (int i = 1; i &amp;lt;= n; i ++ ) scanf(&amp;quot;%d&amp;quot;, &amp;amp;a[i]);

    for (int i = 1; i &amp;lt;= n; i ++ )//ä»å·¦å‘å³æ‰«
    {
        bigger[i] = sum(n) - sum(a[i]);//1~i-1æœ‰å¤šå°‘æ•°å¤§äºyï¼ˆy+1~nï¼‰
        lower[i] = sum(a[i]);//1~i-1æœ‰å¤šå°‘æ•°å°äºyï¼ˆ1~y-1ï¼‰
        add(a[i], 1);
    }

    memset(tr, 0, sizeof tr);
    LL res1 = 0, res2 = 0;
    for (int i = n; i; i -- )//ä»å³å‘å·¦æ‰«
    {
        res1 += bigger[i] * (LL)(sum(n) - sum(a[i]));//i+1~næœ‰å¤šå°‘æ•°å¤§äºy
        res2 += lower[i] * (LL)(sum(a[i]));//i+1~næœ‰å¤šå°‘æ•°å°äºy
        add(a[i], 1);
    }

    printf(&amp;quot;%lld %lld\n&amp;quot;, res1, res2);

    return 0;
}

æ‹“å±•åº”ç”¨
1.æ ‘çŠ¶æ•°ç»„åŸºæœ¬åº”ç”¨. å•ç‚¹ä¿®æ”¹ + åŒºé—´æŸ¥è¯¢
2.åŒºé—´ä¿®æ”¹ + å•ç‚¹æŸ¥è¯¢

acwing242
#include&amp;lt;iostream&amp;gt;
using namespace std;
const int N=100010;
int a[N];
int n,m;
int tr[N];
typedef long long LL;

int lowbit(int x)
{
	return x&amp;amp;-x;
}

void add(int x,int c)
{
	for(int i=x;i&amp;lt;=n;i+=lowbit(i))
		tr[i]+=c;
}

int sum(int x)
{
	int res=0;
	for(int i=x;i;i-=lowbit(i))
		res+=tr[i];
	return res;
}

int main()
{
	cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;m;
	
	for(int i=1;i&amp;lt;=n;i++)
	{
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);
		add(i,a[i]-a[i-1]);
	}
	
	while(m--)
	{
		char op[2];
		scanf(&amp;quot;%s&amp;quot;,op);
		if(*op == &#39;C&#39;)
		{
		    int l,r,d;
			scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;l,&amp;amp;r,&amp;amp;d);
			add(l,d);
			add(r+1,-d);
		}
		else
		{
		    int x;
		    scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
			printf(&amp;quot;%d\n&amp;quot;,sum(x));
		}
	}
	return 0;
 } 

3.åŒºé—´ä¿®æ”¹ + åŒºé—´æŸ¥è¯¢
acwing243


//åŒºé—´åŠ 
//åŒºé—´å’Œ
#include&amp;lt;iostream&amp;gt;
using namespace std;
typedef long long LL;
const int N=100010;
int n,m;
int a[N];
LL tr1[N];//ç»´æŠ¤b[i]çš„å‰ç¼€å’Œ
LL tr2[N];//ç»´æŠ¤b[i]*içš„å‰ç¼€å’Œ

int lowbit(int x)
{
    return x&amp;amp;-x;
}

void add(LL tr[],int x,LL c)
{
    for(int i=x;i&amp;lt;=n;i+=lowbit(i))
        tr[i]+=c;
}

LL sum(LL tr[],int x)
{
    LL res=0;
    for(int i=x;i;i-=lowbit(i))
        res+=tr[i];
    return res;
}

LL prefix_sum(int x)
{
    return sum(tr1,x)*(x+1)-sum(tr2,x);
}

int main()
{
    scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;n,&amp;amp;m);
    for(int i=1;i&amp;lt;=n;i++)
        scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);
    for(int i=1;i&amp;lt;=n;i++)
    {
        int b=a[i]-a[i-1];//æœ€å¤§ä¸º1e9
        add(tr1,i,b);
        add(tr2,i,(LL)i*b);
    }
    
    while(m--)
    {
        char op[2];
        int l,r,d;
        scanf(&amp;quot;%s%d%d&amp;quot;,op,&amp;amp;l,&amp;amp;r);
        if(*op == &#39;Q&#39;)
            printf(&amp;quot;%lld\n&amp;quot;,prefix_sum(r)-prefix_sum(l-1));
        else
        {
            scanf(&amp;quot;%d&amp;quot;,&amp;amp;d);
            add(tr1,l,d);
            add(tr1,r+1,-d);
            add(tr2,l,l*d);
            add(tr2,r+1,(r+1)*-d);
        }
    }
    return 0;
}

acwing244
æˆ‘ä»¬å‘ç°,å¦‚æœè¯´ç¬¬Kå¤´ç‰›çš„å‰é¢æœ‰Akå¤´ç‰›æ¯”å®ƒçŸ®,é‚£ä¹ˆå®ƒçš„èº«é«˜Hkå°±æ˜¯æ•°å€¼1 nä¸­ç¬¬Ak+1å°çš„æ²¡æœ‰åœ¨Hk+1,Hk+2,â€¦,HnH_{k+1},H_{k+2},â€¦,H_{n}Hk+1â€‹,Hk+2â€‹,â€¦,Hnâ€‹ä¸­å‡ºç°è¿‡çš„æ•°
æ‰€ä»¥è¯´,æˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ªé•¿åº¦ä¸ºnçš„01åºåˆ—b,åˆšå¼€å§‹éƒ½æ˜¯1,ç„¶ånåˆ°1å€’åºæ‰«ææ¯ä¸€ä¸ªAiA_iAiâ€‹,å¯¹äºæ¯ä¸ªAiA_iAiâ€‹
æ‰§è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹æ“ä½œ.
ä¹Ÿå°±æ˜¯è¯´è¿™é“é¢˜ç›®çš„é¢˜æ„å°±æ˜¯è®©æˆ‘ä»¬,åŠ¨æ€ç»´æŠ¤ä¸€ä¸ª01åºåˆ—,æ”¯æŒæŸ¥è¯¢ç¬¬kä¸ª1æ‰€åœ¨çš„ä½ç½®,ä»¥åŠä¿®æ”¹åºåˆ—ä¸­çš„ä¸€ä¸ªæ•°å€¼
#include&amp;lt;iostream&amp;gt;
using namespace std;
const int N=100010;
int h[N];
int n;
int tr[N];
int ans[N];

int lowbit(int x)
{
    return x&amp;amp;-x;
}

void add(int x,int c)
{
    for(int i=x;i&amp;lt;=n;i+=lowbit(i))
        tr[i]+=c;
}

int sum(int x)
{
    int res=0;
    for(int i=x;i;i-=lowbit(i))  
        res+=tr[i];
    return res;
}

int main()
{
    cin&amp;gt;&amp;gt;n;
    for(int i=2;i&amp;lt;=n;i++)
        cin&amp;gt;&amp;gt;h[i];
        
    for(int i=1;i&amp;lt;=n;i++)   
        tr[i]=lowbit(i);//ç›¸å½“äºadd(i,1);
    
    for(int i=n;i;i--)
    {
        int k=h[i]+1;
        int l=1,r=n;
        while(l&amp;lt;r)
        {
            int mid=l+r&amp;gt;&amp;gt;1;
            if(sum(mid) &amp;gt;= k)
                r=mid;
            else
                l=mid+1;
        }
        ans[i]=l;
        add(l,-1);
    }
    
    for(int i=1;i&amp;lt;=n;i++)
        cout&amp;lt;&amp;lt;ans[i]&amp;lt;&amp;lt;endl;
    return 0;
}

poj1195

#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#define maxn 1050
#define lowbit(x) (x)&amp;amp;(-x)
int c[maxn][maxn],n;

void add(int x,int y,int z)//å•ç‚¹æ›´æ–° 
{
    for(int i=x;i&amp;lt;=n;i+=lowbit(i))
        for(int j=y;j&amp;lt;=n;j+=lowbit(j))
            c[i][j]+=z;
}

int sum(int x,int y)//åŒºé—´å’Œï¼šå·¦ä¸Šè§’(1,1)åˆ°å³ä¸‹è§’(x,y)çŸ©é˜µåŒºé—´å’Œ 
{
    int s=0;
    for(int i=x;i&amp;gt;0;i-=lowbit(i))
        for(int j=y;j&amp;gt;0;j-=lowbit(j))
            s+=c[i][j];
    return s;
}

int sum(int x1,int y1,int x2,int y2)//æ±‚å·¦ä¸Šè§’(x1,y1)åˆ°å³ä¸‹è§’(x2,y2)å­çŸ©é˜µåŒºé—´å’Œ 
{
	return sum(x2,y2)-sum(x1-1,y2)-sum(x2,y1-1)+sum(x1-1,y1-1);
}

int main()
{
    int opt,x,y,a,l,b,r,t;
	while(scanf(&amp;quot;%d&amp;quot;,&amp;amp;opt)!=EOF)
	{
		if(opt==3) break;
		if(opt==0)
		{
			scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    		memset(c,0,sizeof(c));
		}
		else if(opt==1)
		{
            scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;x,&amp;amp;y,&amp;amp;a);
            ++x;++y;
            add(x,y,a);
        }
        else
		{
            scanf(&amp;quot;%d%d%d%d&amp;quot;,&amp;amp;l,&amp;amp;b,&amp;amp;r,&amp;amp;t);
            ++l,++b,++r,++t;
            printf(&amp;quot;%d\n&amp;quot;,sum(l,b,r,t));
        }
	}
    return 0;
}

poj3321




#include&amp;lt;stdio.h&amp;gt;
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cmath&amp;gt;
using namespace std;
const int maxn=1e5+10;
int n,q;
int c[maxn];
int a[maxn];
int L[maxn],R[maxn];
int head[maxn];
int cnt;
int dfn;
struct edge{
    int u,v;
    int next;
}E[2*maxn];

void adde(int u,int v)
{
    E[++cnt].u=u;
    E[cnt].v=v;
    E[cnt].next=head[u];
    head[u]=cnt;
}

int lowbit(int x)
{
    return x&amp;amp;(-x);
}

void add(int x,int v)
{
    for(int i=x;i&amp;lt;=n;i+=lowbit(i))
        c[i]+=v;
}

int sum(int x)
{
    int ans=0;
    for(int i=x;i;i-=lowbit(i))
    {
        ans+=c[i];
    }
    return ans;
}


void dfs(int u,int fa)
{
    L[u]=++dfn;
    for(int i=head[u];i;i=E[i].next)
    {
        int v=E[i].v;
        if(v==fa) continue;
        dfs(v,u);
    }
    R[u]=dfn;
}

int main()
{
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    int u,v;
    for(int i=1;i&amp;lt;=n;i++)
    {
        c[i]=lowbit(i);
        a[i]=1;
    }
    for(int i=1;i&amp;lt;n;i++)
    {
        scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;u,&amp;amp;v);
        adde(u,v);
    }
    dfs(1,-1);
//	for(int i=1;i&amp;lt;=n;i++)//æµ‹è¯•dfsåºåˆ— 
//    	printf(&amp;quot;--%d %d\n&amp;quot;,L[i],R[i]);
//  	printf(&amp;quot;\n&amp;quot;);	
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;q);
    char op[10];
    for(int i=1;i&amp;lt;=q;i++)
    {
        scanf(&amp;quot;%s%d&amp;quot;,op,&amp;amp;v);
        if(op[0]==&#39;C&#39;)
        {
        	int j=L[v];
            if(a[j])//ç”±äºæ¯ä¸ªèŠ‚ç‚¹çš„dfnç¼–å·å°±æ˜¯å®ƒçš„å·¦å€¼ï¼Œæ‰€ä»¥ç›´æ¥ä¿®æ”¹å·¦èŠ‚ç‚¹
                add(j,-1);
            else
                add(j,1);
            a[j]^=1;
        }
        else
        {
            int s1=sum(R[v]);
            int s2=sum(L[v]-1);
            printf(&amp;quot;%d\n&amp;quot;,s1-s2);
        }
    }
    return 0;
}


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/shu-zhuang-shu-zu/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/shu-lun/">
                        æ•°è®º
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-26</time>
                    
                        <a href="https://caifxh.github.io/tag/14SoYNkfD/" class="post-tag i-tag
                            i-tag-info">
            #æ•°å­¦
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            æ•°è®º
é™¤æ³•å’Œæ¨¡è¿ç®—
è®¡ç®—æœºä¸­æ•´æ•°å’Œæ•´æ•°çš„é™¤æ³•æ˜¯æ•´æ•°é™¤æ³•ï¼Œå³ a Ã· b = âŒŠ ab âŒ‹.
æ¨¡è¿ç®—å³æ˜¯ä¸¤æ•°ç›¸é™¤çš„ä½™æ•°ï¼Œåœ¨ c++ çš„ä»£ç ä¸­ç”¨ a%b æ¥è®¡ç®—è¿™
ä¸ªæ•°å­—ï¼Œé€šè¿‡ä¸€äº›å°å­¦çŸ¥è¯†æˆ‘ä»¬å®¹æ˜“å¾—åˆ°
a % b = a âˆ’ âŒŠa/bâŒ‹ Ã— b
æ•´é™¤æ€§å’Œçº¦æ•°
æ•´é™¤æ˜¯æ•°è®ºä¸­çš„ä¸€ä¸ªä¸­å¿ƒæ¦‚å¿µã€‚
å¦‚æœä¸¤ä¸ªæ•°å­— a, b, æ»¡è¶³ a % b = 0 , é‚£ä¹ˆæˆ‘ä»¬å°±è¯´ a æ˜¯ b çš„å€æ•°ï¼ŒåŒæ—¶ä¹Ÿè¯´ b æ˜¯ a çš„çº¦æ•°ï¼Œè®¡åš b | a ã€‚
åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªæ•°å­—çš„çº¦æ•°å’Œå€æ•°ï¼Œéƒ½åªè€ƒè™‘ä»–çš„æ­£çº¦æ•°å’Œæ­£å€æ•°ã€‚
â€¢ è®°å· d | a æ„å‘³ç€å¯¹æŸä¸ªæ•´æ•° kï¼Œæœ‰ a = kdã€‚
â€¢ 0 å¯è¢«ä»»ä½•æ•´æ•°æ•´é™¤ã€‚0=0*d,d|0
â€¢ å¦‚æœ d | a æˆ‘ä»¬ç§° a æ˜¯ d çš„å€æ•°ï¼Œd æ˜¯ a çš„çº¦æ•°ã€‚
â€¢ ä¸€ä¸ªæ•´æ•° a çš„çº¦æ•°æœ€å°ä¸º 1ï¼Œ æœ€å¤§ä¸º |a|ã€‚ â€¢ ä¾‹å¦‚ï¼š12 çš„çº¦æ•°æœ‰ 1, 2, 3, 4, 6, 12
æ±‚çº¦æ•°
å¦‚ä½•æ‰èƒ½æ±‚å‡ºä¸€ä¸ªæ•°å­— n çš„æ‰€æœ‰çº¦æ•°å‘¢ï¼Ÿ
ä¸€ä¸ªéå¸¸æœ´ç´ çš„æ–¹æ³•, ä» 1 åˆ° n æšä¸¾ï¼Œå¤æ‚åº¦ O(n)
æ³¨æ„åˆ°çº¦æ•°æ€»æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œå³å¦‚æœæœ‰ a Ã· b = c å°±ä¸€å®šä¼šæœ‰a Ã· c = b
æˆ‘ä»¬ä»¥ âŒŠâˆšnâŒ‹ ä½œä¸ºä¸€ä¸ªé™åº¦ï¼Œåªæšä¸¾åˆ° âˆšn(æ³¨æ„ n æ˜¯å®Œå…¨å¹³æ–¹æ•°çš„æƒ…å†µ)
vector&amp;lt;int&amp;gt; get_div(int x)
{
    vector&amp;lt;int&amp;gt; res;
    for (int i = 1; i &amp;lt;= x / i; i ++ )
        if (x % i == 0)
        {
            res.push_back(i);
            if (i != x / i) res.push_back(x / i);
        }
    sort(res.begin(), res.end());
    return res;
}

int main()
{
    int n;
    cin &amp;gt;&amp;gt; n;

    while (n -- )
    {
        int x;
        cin &amp;gt;&amp;gt; x;
        auto res = get_div(x);

        for (auto x : res) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &#39; &#39;;
        cout &amp;lt;&amp;lt; endl;
    }
    return 0;
}

æ±‚å€æ•°
ä¸€ä¸ªæ•°å­—çš„å€æ•°æœ‰æ— ç©·å¤šä¸ªï¼Œæ‰€ä»¥å¾ˆéš¾æ±‚å‡ºæ‰€æœ‰çš„å€æ•°ï¼Œæˆ‘ä»¬é€šå¸¸åªæ±‚å‡º n ä»¥å†… a çš„æ‰€æœ‰å€æ•°ã€‚
å’Œæ±‚çº¦æ•°ç›¸åŒï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥æƒ³åˆ°ä¸€ä¸ª O(n) çš„ç®€å•æ–¹æ³•ï¼Œå³æšä¸¾
å¯¹äºä¸€ä¸ªæ•°å­— a , ä»–çš„æ‰€æœ‰å€æ•°ä¸€å®šæ˜¯ a, 2a, 3a, 4a, . . . , âŒŠn/aâŒ‹a, æ¯ä¸ªå€æ•°éƒ½æ¯”å‰ä¸€ä¸ªå€æ•°å¤š a, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä» a å¼€å§‹æ¯æ¬¡åŠ  a æšä¸¾ä»–çš„ä¸‹ä¸€ä¸ªå€æ•°
å¤æ‚åº¦åˆ†æï¼šè€ƒè™‘ä¸€ç§æé™æƒ…å†µï¼Œa = 1 , æ­¤æ—¶æšä¸¾ç›¸å½“äºä» 1æšä¸¾åˆ° n , æ‰€ä»¥å¤æ‚åº¦å…¶å®è¿˜æ˜¯ O(n)
ç„¶è€Œæˆ‘ä»¬åé¢ä¼šçœ‹åˆ°ï¼Œå¦‚æœå¯¹äºæ¯ä¸ªæ•°å­—éƒ½æšä¸¾å€æ•°çš„è¯ï¼Œå¤æ‚åº¦ä¼šæœ‰æ‰€ä¸‹é™ã€‚
ç´ æ•°å’Œåˆæ•°
å¯¹äºæŸä¸ªæ•´æ•° a &amp;gt; 1ï¼Œå¦‚æœå®ƒä»…æœ‰çº¦æ•° 1 å’Œ aï¼Œåˆ™ç§° a ä¸ºç´ æ•°ï¼ˆæˆ–è´¨æ•°ï¼‰
å‰ 10 ä¸ªç´ æ•°: 2, 3, 5, 11, 13, 17, 19, 23, 29, 31
ä¸æ˜¯ç´ æ•°çš„æ•´æ•° a &amp;gt; 1 ç§°ä¸ºåˆæ•°ã€‚
ä¾‹å¦‚ï¼Œå› ä¸º 2 | 10ï¼Œæ‰€ä»¥ 10 æ˜¯åˆæ•°ã€‚
æ•´æ•° 1 æ—¢ä¸æ˜¯ç´ æ•°ä¹Ÿä¸æ˜¯åˆæ•°
å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯è´¨æ•°å‘¢ï¼Ÿå®šä¹‰åˆ¤æ–­å³å¯
bool is_prime(int x)
{
    if(x&amp;lt;2)
        return false;
    for(int i=2;i&amp;lt;=x/i;i++)
    {
        if(x%i==0)
            return false;
    }
    return true;
}

int main()
{
    int n;
    cin&amp;gt;&amp;gt;n;
    while(n--)
    {
        int x;
        scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
        if(is_prime(x))
            puts(&amp;quot;Yes&amp;quot;);
        else
            puts(&amp;quot;No&amp;quot;);
    }
    return 0;
}

åŸƒæ‹‰æ‰˜æ–¯ç‰¹å°¼ç­›æ³•
åŸƒæ°ç­›æ³•çš„åŸç†æ˜¯ï¼šæ¯ä¸ªåˆæ•°éƒ½æ˜¯å¤šä¸ªè´¨æ•°çš„ç§¯ï¼›é‚£ä¹ˆä»æœ€å°çš„è´¨æ•°2å¼€å§‹ï¼Œç”¨æ¯ä¸€ä¸ªè´¨æ•°å»ç­›æ¯”å®ƒå¤§çš„æ•°ï¼Œå°±èƒ½ç­›æ‰åˆæ•°ã€‚åŸƒæ°ç­›æ³•ä½æ•ˆçš„åŸå› æ˜¯ï¼Œä¸€ä¸ªåˆæ•°ä¼šè¢«å®ƒçš„å¤šä¸ªè´¨å› å­é‡å¤ç­›ã€‚
æˆ‘ä»¬è€ƒè™‘è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå¦‚æœä¸€ä¸ªæ•°å­—æ˜¯å¦å¤–ä¸€ä¸ªæ•°å­—çš„å€æ•°ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°å­—ä¸€å®šä¸æ˜¯ç´ æ•°ï¼Œæ—¢ç„¶è¿™æ ·æˆ‘ä»¬æ¯æšä¸¾åˆ°ä¸€ä¸ªæ•°å­— iï¼Œå°±å¯ä»¥æŠŠä»–æ‰€æœ‰çš„å€æ•°å…¨éƒ½è®¾ç½®æˆä¸æ˜¯è´¨æ•°ï¼Œè¿™æ ·ä»æ¥æ²¡è¢«æ ‡è®°è¿‡çš„æ•°å­—å°±æ˜¯è´¨æ•°äº†ã€‚
ç®—æ³•æ€æƒ³ï¼šæ¯ä¸ªè´¨æ•°éƒ½å¯ä»¥æŠŠå®ƒçš„å€æ•°ç­›æ‰
æ—¶é—´å¤æ‚åº¦ï¼šO(nloglogn)
int primes[N], cnt;
bool st[N];

void get_primes(int n)
{
    for (int i = 2; i &amp;lt;= n; i ++ )
    {
        if (st[i]) continue;
        primes[cnt ++ ] = i;
        for (int j = i + i; j &amp;lt;= n; j += i)
            st[j] = true;
    }
}

ä¾‹é¢˜
bzoj1607
é¢˜æ„ï¼šç»™å®š n ä¸ªæ•°ï¼Œå¯¹äºå…¶ä¸­çš„æ¯ä¸€ä¸ªæ•°å­—ï¼Œè¯¢é—®æœ‰å¤šå°‘ä¸ªæ•°æ˜¯ä»–çš„çº¦æ•°ã€‚

ä»£ç 
çº¿æ€§ç­›ï¼ˆæ¬§æ‹‰ç­›ï¼‰
å†æ¬¡æŠŠçœ¼å…‰æ”¾å›å¦‚ä½•åˆ¤æ–­ [1, n]ä¸­å“ªäº›æ•°å­—æ˜¯è´¨æ•°è¿™ä¸ªé—®é¢˜ä¸Šæ¥ã€‚è€ƒè™‘ä¹‹å‰çš„åšæ³•ä¸ºä»€ä¹ˆä¼šè¿è¡Œçš„æ¯”è¾ƒç¼“æ…¢å‘¢ï¼Ÿäº‹å®ä¸Šæˆ‘ä»¬åœ¨ç¡®è®¤ä¸€ä¸ªæ•°å­—ä¸æ˜¯è´¨æ•°çš„æ—¶å€™ï¼Œè¦ç”¨å¾ˆå¤šæ•°å­—æ¥ç­›é€‰ä»–æ‰å¯ä»¥ï¼Œæ¯”å¦‚æ•°å­— 6, æˆ‘ä»¬åœ¨æšä¸¾ 2çš„å€æ•°çš„æ—¶å€™ç­›äº†ä»–ä¸€æ¬¡ï¼Œåœ¨æšä¸¾ 3 çš„å€æ•°çš„æ—¶å€™ç­›äº†ä»–ä¸€æ¬¡ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿè®©ä»–åªè¢«ç­›é€‰ä¸€æ¬¡å‘¢ï¼Ÿ
è€ƒè™‘è¿™æ ·ä¸€ç§æƒ³æ³•ï¼Œå¦‚æœæ¯ä¸ªæ•°å­—éƒ½åªè¢«ä»–æœ€å°çš„è´¨çº¦æ•°ç­›ä¸€æ¬¡ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±å¯ä»¥è¾¾åˆ° O(n)ã€‚å¯æ˜¯å¦‚ä½•æ‰èƒ½å®ç°å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªç±»ä¼¼æ„é€ çš„æƒ³æ³•
$i=p_1^{k_1} * p_2^{k_2} * ... * p_s^{k_s} 
i * primes[j]=primes[j] * p_1^{k_1} * p_2^{k_2} * ... * p_s^{k_s}å½“iå½“i
å½“i%primes[j]ä¸ä¸º0æ—¶ï¼Œi*primes[j]çš„æœ€å°è´¨å› æ•°ä¸ºprimes[j];
å½“i%primes[j]ä¸º0ä¹‹åï¼Œi*primes[j]çš„æœ€å°è´¨å› æ•°ä¸ºå½“iå½“ip_1$è€Œä¸æ˜¯primes[j],æ­¤æ—¶ä¸èƒ½å†ç”¨primes[j]ç­›å»ï¼Œå¦åˆ™è¿èƒŒåªç”¨æœ€å°è´¨å› æ•°ç­›çš„æ–¹æ³•ã€‚

int primes[N], cnt;
bool st[N];

void get_primes(int n)
{
    for (int i = 2; i &amp;lt;= n; i ++ )
    {
        if (!st[i]) primes[cnt ++ ] = i;
        for (int j = 0; primes[j] &amp;lt;= n / i; j ++ )
        {
            st[primes[j] * i] = true;
            if (i % primes[j] == 0) break;
        }
    }
}

çº¿æ€§ç­›æ¬§æ‹‰å‡½æ•°
å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨æ±‚é€†å…ƒçš„æ—¶å€™ä»‹ç»äº†ä¸€ä¸ªå‡½æ•°ï¼Œæ¬§æ‹‰å‡½æ•°Ï†(n), å¹¶ä»‹ç»äº†ä¸€ç§ âˆšnæ±‚ä¸€ä¸ªæ¬§æ‹‰å‡½æ•°çš„æ–¹æ³•ï¼Œç°åœ¨æˆ‘ä»¬è€ƒè™‘èƒ½ä¸èƒ½ O(n) æ—¶é—´å†…æ±‚å‡º [1, n] æ¯ä¸ªæ•°å­—çš„æ¬§æ‹‰å‡½æ•°å‡½æ•°å€¼å‘¢ï¼Ÿ
è€ƒè™‘åœ¨çº¿æ€§ç­›çš„åŒæ—¶èƒ½ä¸èƒ½æŠŠæ¬§æ‹‰å‡½æ•°å€¼ä¹Ÿæ›´æ–°ä¸€ä¸‹ï¼Œæ³¨æ„åˆ°çº¿æ€§ç­›çš„æ—¶å€™æ¯ä¸ªæ•°å­—åªä¼šè¢«ç­›åˆ°ä¸€æ¬¡ï¼Œæˆ‘ä»¬èƒ½å¦åœ¨è¿™ä¸ªæ—¶å€™é¡ºä¾¿æ±‚å‡ºæ¬§æ‹‰å‡½æ•°çš„å‡½æ•°å€¼å‘¢ï¼Ÿ
è€ƒè™‘ä»–åœ¨è¢«ç­›çš„æ—¶å€™å‡½æ•°çš„å–å€¼åº”è¯¥æ˜¯å¤šå°‘
i. Iæ˜¯ä¸ªè´¨æ•°,phi(p)=p-1
2.å¦‚æœi % primes[j] = 0, é‚£ä¹ˆphi(i * primes[j])=primes[j] * phi(i)
åŸå› ï¼šiprimes[j]çš„è´¨å› æ•°æ„æˆå’Œiç›¸åŒï¼Œä½†primes[j]çš„æ¬¡æ•°å¤š1
3.å¦‚æœ i%prime[j] ä¸ä¸º 0ï¼Œå³primes[j]å°äºiçš„æœ€å°è´¨å› å­p1p_1p1â€‹,
phi(i * primes[j]) = phi(i) * primes[j](1-1/primes[j]) = phi(i)*(primes[j]-1)
ä¹Ÿå¯æ ¹æ®æ¬§æ‹‰å‡½æ•°çš„ç§¯æ€§ï¼Œ i mod primes[j] ä¸ä¸º0ä¸”primes[j]ä¸ºè´¨æ•°,æ‰€ä»¥iä¸primes[j]äº’è´¨,
phi(i * primes[j])=phi(i) * phi(primes[j]) å…¶ä¸­phi(primes[j])=primes[j]-1å³ç¬¬ä¸€æ¡æ€§è´¨
int primes[N],cnt;
int eulers[N];
bool st[N];

void get_eulers(int n)
{
    eulers[1]=1;
    for(int i=2;i&amp;lt;=n;i++)
    {
        if(!st[i])
        {
            primes[cnt++]=i;
            eulers[i]=i-1;
        }
        for(int j=0;primes[j]&amp;lt;=n/i;j++)
        {
            int t=i*primes[j];
            st[t]=true;
            if(i%primes[j]==0)
            {
                eulers[t]=eulers[i]*primes[j];
                break;
            }
            eulers[t]=eulers[i]*(primes[j]-1);
        }
    }
}

ç§¯æ€§å‡½æ•°éƒ½å¯ä»¥ç”¨æ¬§æ‹‰ç­›æ¥æ±‚
æ•´é™¤åˆ†å—ï¼ˆæ•°è®ºåˆ†å—ï¼‰



è¯æ˜ç»†èŠ‚è§ï¼š
https://blog.csdn.net/qq_41021816/article/details/84842956
#include&amp;lt;bits/stdc++.h&amp;gt;
using namespace std;
int main(){
    long long n,ans=0;
    cin &amp;gt;&amp;gt; n;
    for(long long l=1,r;l&amp;lt;=n;l=r+1){
        r = n/(n/l);            //è®¡ç®—rï¼Œè®©åˆ†å—å³ç§»
        ans += (r-l+1)*(n/l);   //æ±‚å’Œ
        cout &amp;lt;&amp;lt; l &amp;lt;&amp;lt;&amp;quot;&amp;quot;&amp;lt;&amp;lt; r &amp;lt;&amp;lt;&amp;quot;: &amp;quot;&amp;lt;&amp;lt; n/r &amp;lt;&amp;lt; endl;  //æ‰“å°åˆ†å—
    }
    cout &amp;lt;&amp;lt; ans;               //æ‰“å°å’Œ
}

ç§¯æ€§å‡½æ•°

å¸¸è§çš„ç§¯æ€§å‡½æ•°

ç§¯æ€§å‡½æ•°æ€§è´¨



pä¸ºè´¨æ•°
ç§¯æ€§å‡½æ•°çš„åŸºæœ¬é—®é¢˜

ç‹„åˆ©å…‹é›·å·ç§¯


çº¿æ€§ç­›æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°

int primes[N],cnt;
int miu[N];
bool st[N];

void get_eulers(int n)
{
	memset(st,0,sizeof st);
    miu[1]=1;
    for(int i=2;i&amp;lt;=n;i++)
    {
        if(!st[i])
        {
            primes[cnt++]=i;
            miu[i]=-1;
        }
        for(int j=0;i*primes[j]&amp;lt;=n;j++)
        {
            int t=i*primes[j];
            st[t]=true;
            if(i%primes[j]==0)
            {
                miu[t]=0;
                break;
            }
            miu[t]=-miu[i];//ç§¯æ€§å‡½æ•°æ€§è´¨ï¼Œmiu[i]*miu[primes[j]]
        }
    }
}

è«æ¯”ä¹Œæ–¯å‡½æ•°æ€§è´¨


è«æ¯”ä¹Œæ–¯å‡½æ•°çš„ç”±æ¥


æœæ•™ç­›


ç»å…¸çš„æœæ•™ç­›é¢˜ç›®ï¼Œä¾‹å¦‚æ´›è°·P4213ï¼Œæ±‚æ•°è®ºå‡½æ•°çš„å‰ç¼€å’Œã€‚


æœæ•™ç­›å…¬å¼æ¨å¯¼



å”¯ä¸€çš„å› å­åˆ†è§£

çº¦æ•°å€æ•°çš„ç‰¹å¾

æ±‚è´¨çº¦æ•°
æ³¨æ„åˆ°ä¸€ä¸ªæ•°å­— n æœ€å¤šåªæœ‰ä¸€ä¸ª &amp;gt; âˆšn çš„è´¨çº¦æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ç„¶åªéœ€è¦æšä¸¾åˆ° âˆšn
ä¸€ä¸ªéå¸¸æœ´ç´ çš„æ–¹æ³•æ˜¯æšä¸¾æ¯ä¸ªæ•°å­—ï¼Œåˆ¤æ–­æ˜¯å¦æ˜¯çº¦æ•°å¹¶åˆ¤æ–­æ˜¯å¦æ˜¯ç´ æ•°ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•çš„å¤æ‚åº¦æ¥è¿‘ O(n)ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªéå¸¸æ˜æ™ºçš„é€‰æ‹©

void divide(int x)
{
    for (int i = 2; i &amp;lt;= x / i; i ++ )
        if (x % i == 0)
        {
            int s = 0;
            while (x % i == 0) x /= i, s ++ ;
            cout &amp;lt;&amp;lt; i &amp;lt;&amp;lt; &#39; &#39; &amp;lt;&amp;lt; s &amp;lt;&amp;lt; endl;
        }
    if (x &amp;gt; 1) cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &#39; &#39; &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; endl;
    cout &amp;lt;&amp;lt; endl;
}

int main()
{
    int n;
    cin &amp;gt;&amp;gt; n;
    while (n -- )
    {
        int x;
        cin &amp;gt;&amp;gt; x;
        divide(x);
    }

    return 0;
}

å¿«é€Ÿåˆ†è§£è´¨å› æ•°
æˆ‘ä»¬æ¥è€ƒè™‘æ±‚å‡ºçš„ prime æ•°ç»„çš„ä¸€ä¸ªåº”ç”¨
å¦‚ä½•èƒ½å¤Ÿåœ¨çº¿æ€§ç­›ä¹‹åå¿«é€Ÿçš„åˆ†è§£ä¸€ä¸ªæ•°å­—çš„è´¨çº¦æ•°å‘¢ï¼Ÿè€ƒè™‘åœ¨ç­›æ‰ä¸€ä¸ªæ•°å­—çš„æ—¶å€™è®°å½•ä¸€ä¸‹ä»–æ˜¯è¢«å“ªä¸ªè´¨æ•°ç­›æ‰çš„ä¹Ÿå³ä»–çš„æœ€å°çš„è´¨çº¦æ•°æ˜¯è°ã€‚è¿™æ ·æˆ‘ä»¬åªè¦æ¯æ¬¡é™¤æ‰ä¸€ä¸ªæœ€å°çš„è´¨çº¦æ•°å°±å¯ä»¥äº†ã€‚
for(int j = 1; prime[j] * i &amp;lt;= Max; ++ j) {
	from[i*prime[j]] = prime[j];
	...
}

æŸ¥è¯¢æ—¶åªéœ€é€’å½’æŸ¥è¯¢from[x],from[x/from[x]]...,ä¸€æ¬¡æŸ¥è¯¢çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(logn)
çº¦æ•°ä¸ªæ•° çº¦æ•°å’Œ
å¯¹äºä¸€ä¸ªå¤§äº1æ­£æ•´æ•°nå¯ä»¥åˆ†è§£è´¨å› æ•°ï¼šn=p1a1*p2a2*p3a3*â€¦*pkak,
åˆ™ç”±çº¦æ•°ä¸ªæ•°å®šç†å¯çŸ¥nçš„æ­£çº¦æ•°æœ‰(aâ‚+1)(aâ‚‚+1)(aâ‚ƒ+1)â€¦(ak+1)ä¸ªï¼Œ
int main()
{
    int n;
    cin &amp;gt;&amp;gt; n;

    unordered_map&amp;lt;int, int&amp;gt; primes;

    while (n -- )
    {
        int x;
        cin &amp;gt;&amp;gt; x;

        for (int i = 2; i &amp;lt;= x / i; i ++ )
            while (x % i == 0)
            {
                x /= i;
                primes[i] ++ ;
            }

        if (x &amp;gt; 1) primes[x] ++ ;
    }

    LL res = 1;
    for (auto p : primes) res = res * (p.second + 1) % mod;

    cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; endl;

    return 0;
}

nçš„(aâ‚+1)(aâ‚‚+1)(aâ‚ƒ+1)â€¦(ak+1)ä¸ªæ­£çº¦æ•°çš„å’Œä¸º
f(n)=(p10+p11+p12+â€¦p1a1)(p20+p21+p22+â€¦p2a2)â€¦(pk0+pk1+pk2+â€¦pkakï¼‰
LL res = 1;
for (auto p : primes)
{
    LL a = p.first, b = p.second;
    LL t = 1;
    while (b -- ) t = (t * a + 1) % mod;
    res = res * t % mod;
}
cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; endl;

é™¤æ³•å®šç†
å¯¹ä»»æ„æ•´æ•° a å’Œä»»æ„æ­£æ•´æ•° nï¼Œ å­˜åœ¨å”¯ä¸€çš„æ•´æ•° q å’Œ rï¼Œ
æ»¡è¶³ 0 &amp;lt;= r &amp;lt; nï¼Œå¹¶ä¸” a = qn + r.
å€¼ q = a / nç§°ä¸ºé™¤æ³•çš„å•†
å€¼ r = a mod n ç§°ä¸ºé™¤æ³•çš„ä½™æ•°ã€‚
n | a å½“ä¸”ä»…å½“ a mod n = 0ã€‚
æ¨¡ n ç­‰ä»·ç±»
åŒ…å«æ•´æ•° a çš„æ¨¡ n ç­‰ä»·ç±»ä¸ºï¼š[ğ’‚]ğ’[ğ’‚]_ğ’[a]nâ€‹= {ğ’‚ + ğ’Œğ’: ğ’Œğğ’}
ä¾‹å¦‚ï¼Œ[ğŸ‘]ğŸ•[ğŸ‘]_ğŸ•[3]7â€‹= {â€¦ , âˆ’11, âˆ’ğŸ’, ğŸ‘, 10, 17, â€¦ }
ğ’ƒğ[ğ’‚]ğ’[ğ’‚]_ğ’[a]nâ€‹ ç­‰åŒäºb = a (mod n)
-1 = n â€“ 1 (mod n)
å…¬çº¦æ•°ä¸æœ€å¤§å…¬çº¦æ•°
å¦‚æœ d æ˜¯ a çš„çº¦æ•°å¹¶ä¸”ä¹Ÿæ˜¯ b çš„çº¦æ•°ï¼Œåˆ™ d æ˜¯ a ä¸ b çš„å…¬çº¦æ•°ã€‚
ä¾‹å¦‚ï¼Œ12 çš„çº¦æ•°æ˜¯ 1, 2, 3, 4, 6, 12ï¼Œå› æ­¤ 8 ä¸ 12 çš„å…¬çº¦æ•°ä¸º 1, 2, 4ã€‚ 1 æ˜¯ä»»æ„ä¸¤ä¸ªæ•´æ•°çš„å…¬çº¦æ•°ã€‚
å…¬çº¦æ•°çš„é‡è¦æ€§è´¨ä¸ºï¼š
d | a ä¸” d | b è•´å«ç€ d | (a + b) ä¸” d | (aâ€“b)
æ›´ä¸€èˆ¬çš„ï¼Œå¯¹ä»»æ„æ•´æ•° x å’Œ yï¼Œæœ‰
d | a ä¸” d | b è•´å«ç€ d | (ax + by)
ä¸¤ä¸ªä¸åŒæ—¶ä¸º 0 çš„æ•´æ•° a ä¸ b çš„æœ€å¤§å…¬çº¦æ•°è¡¨ç¤ºæˆgcd(a, b)ã€‚
ä¾‹å¦‚ gcd(12, 8) = 4ï¼Œgcd(5, 9) = 1, gcd(0, 4) = 4.
å®šä¹‰ gcd(0, 0) = 0
gcd å‡½æ•°çš„åŸºæœ¬æ€§è´¨ï¼š
â€¢ gcd(a, b) = gcd(b, a)
â€¢ gcd(a, b) = gcd(-a, b)
â€¢ gcd(a, b) = gcd(|a|, |b|)
â€¢ gcd(a, 0) = |a|
â€¢ gcd(a, ka) = |a|
gcd çš„å…¶ä»–æ€§è´¨
å¦‚æœ a å’Œ b æ˜¯ä¸éƒ½ä¸º 0 çš„ä»»æ„æ•´æ•°ï¼Œåˆ™ gcd(a, b) æ˜¯a ä¸ b çš„çº¿æ€§ç»„åˆé›†åˆ {ax + by: x, y âˆˆ Z}ä¸­çš„æœ€å°æ­£å…ƒç´ ã€‚

è£´èœ€å®šç†
å¯¹ä»»ä½•æ•´æ•°aã€bå’Œå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°dï¼Œå…³äºæœªçŸ¥æ•°xå’Œyçš„çº¿æ€§ä¸å®šæ–¹ç¨‹ï¼ˆç§°ä¸ºè£´èœ€ç­‰å¼ï¼‰ï¼šè‹¥a,bæ˜¯æ•´æ•°,ä¸”gcd(a,b)=dï¼Œé‚£ä¹ˆå¯¹äºä»»æ„çš„æ•´æ•°x,y,ax+byéƒ½ä¸€å®šæ˜¯dçš„å€æ•°ï¼Œç‰¹åˆ«åœ°ï¼Œä¸€å®šå­˜åœ¨æ•´æ•°x,yï¼Œä½¿ax+by=dæˆç«‹ã€‚
å®ƒçš„ä¸€ä¸ªé‡è¦æ¨è®ºæ˜¯ï¼ša,bäº’è´¨çš„å……è¦æ¡ä»¶æ˜¯å­˜åœ¨æ•´æ•°x,yä½¿ax+by=1.
ä¸Šè¿°è£´èœ€å®šç†é’ˆå¯¹çš„æ˜¯ä¸¤ä¸ªå˜é‡ã€‚é‚£ä¹ˆæˆ‘ä»¬å¾ˆè‡ªç„¶çš„å°±æƒ³åˆ°è¿™æ ·çš„å®šç†èƒ½å¦æ¨å¹¿åˆ°å¤šä¸ªå˜é‡å‘¢ï¼Ÿæ˜¾ç„¶å¯ä»¥ï¼Œè¯æ˜æ–¹æ³•åŒä¸Š
æ¨¡æ¿é¢˜
æˆ‘ä»¬åªéœ€è¦å¯¹è¿™æ‰€æœ‰çš„æ•°å­—æ±‚ä¸€ä¸ªgcdï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ä¸è¦å¿˜è®°æ•°æ®ä¸­æœ‰è´Ÿæ•°ï¼Œè¦å°†å…¶å˜ä¸ºæ­£æ•°å†æ±‚gcd,å› ä¸ºç³»æ•°çš„æœ€ç»ˆç­”æ¡ˆæ²¡æœ‰å½±å“ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
int n;

int gcd(int a,int b)
{
	return b?gcd(b,a%b) : a;
}

int main()
{
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	int ans=0;
	for(int i=0;i&amp;lt;n;i++)
	{
		int x;
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
		if(x&amp;lt;0)	
			x=-x;
		ans=gcd(ans,x);
	}
	printf(&amp;quot;%d\n&amp;quot;,ans);
	return 0;
}

gcd çš„å…¶ä»–æ€§è´¨
â€¢ å¯¹äºä»»æ„æ•´æ•° a å’Œ bï¼Œå¦‚æœ d | a å¹¶ä¸” d | bï¼Œåˆ™d | gcd(a, b)
è¯æ˜ï¼šgcd(a,b)|a,gcd(a,b)|b,åˆ™gcdä¸ºæœ€å¤§çš„çº¦æ•°ï¼Œåˆ™d | gcd(a, b)
â€¢ å¯¹æ‰€æœ‰æ­£æ•´æ•° n, a å’Œ bï¼Œå¦‚æœ n | ab ä¸” gcd(a, n)=1ï¼Œåˆ™ n | b
äº’è´¨æ•°
å¦‚æœä¸¤ä¸ªæ•´æ•° a å’Œ b ä»…æœ‰å…¬å› æ•° 1ï¼Œå³å¦‚æœ gcd(a, b) = 1ï¼Œåˆ™ a ä¸ b ç§°ä¸ºäº’è´¨æ•°ã€‚
ä¾‹å¦‚ï¼Œ5 å’Œ 9 æ˜¯äº’è´¨æ•°ã€‚
å¯¹ä»»æ„æ•´æ•° p, a å’Œ bï¼Œå¦‚æœ gcd(a, p) = gcd(b, p) = 1ï¼Œ åˆ™ gcd(ab, p) = 1
è¯æ˜ï¼šç”±çº¿æ€§ç»„åˆçš„å®šç†å¯çŸ¥ï¼Œå­˜åœ¨æ•´æ•°x,y,xâ€™ ï¼Œyâ€™, æ»¡è¶³ax+py=1,bxâ€™+pyâ€™=1
æŠŠä¸Šé¢ä¸¤ä¸ªç­‰å¼ä¸¤è¾¹ç›¸ä¹˜ï¼Œæ•´ç†å¾—
ab(x xâ€™)+p(ybxâ€™+yâ€™ax+pyyâ€™)=1
å› ä¸º1æ˜¯abä¸pçš„ä¸€ä¸ªæ­£çº¿æ€§ç»„åˆï¼Œæ‰€ä»¥å¯ä»¥è¯æ˜æ‰€éœ€ç»“è®º
æ¬§å‡ é‡Œå¾—ç®—æ³•
æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚æœ€å¤§å…¬çº¦æ•°
åˆ©ç”¨æ€§è´¨ï¼šgcd(a, b) = gcd(b, a % b)
int gcd(int a, int b)
{
    return b?gcd(b,a%b):a;
}

å› ä¸ºæ¯æ¬¡å–æ¨¡ï¼Œa è‡³å°‘ä¼šå˜æˆåŸæ¥çš„äºŒåˆ†ä¹‹ä¸€ã€‚
æ•´ä¸ªç®—æ³•æ˜¯ O(log n) çš„ã€‚
æ±‚å‡ºäº† gcdï¼Œå°±å¯ä»¥æ±‚å‡º lcmã€‚
int lcm(int a, int b)
{
    return a / gcd(a, b) * b;
}


ä¾‹é¢˜
hdu2503
ç»™å®š a, b, c, d (0 &amp;lt; a,b,c,d &amp;lt; 1000)ã€‚ æ±‚ a/b + c/d çš„æœ€ç®€å½¢å¼ e/fã€‚

æ ·ä¾‹è¾“å…¥ï¼š
1 2 1 3
æ ·ä¾‹è¾“å‡ºï¼š
5 6
å…ˆé€šåˆ†ï¼Œæ±‚bå’Œdçš„æœ€å°å…¬å€æ•°ã€‚
åˆ†å­ç›¸åŠ åï¼Œå†çº¦æ‰åˆ†å­å’Œåˆ†æ¯çš„æœ€å¤§å…¬çº¦æ•°å°±æ˜¯ç­”æ¡ˆã€‚
ä»£ç 
æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹çš„æ•´æ•°è§£
ç»™å‡ºæ•´æ•°a,b,n,é—®æ–¹ç¨‹ax+by=nä»€ä¹ˆæ—¶å€™æœ‰æ•´æ•°è§£ï¼Ÿå¦‚ä½•æ±‚å‡ºæ‰€æœ‰çš„æ•´æ•°è§£?
æœ‰è§£çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯gcd(a,b)å¯ä»¥æ•´é™¤n
è¯æ˜ï¼šä»¤a=gcd(a,b)a&#39;,b=gcd(a,b)b&#39;,æœ‰ax+by=gcd(a,b)(a&#39;x+b&#39;y)=n;å¦‚æœx,y,a&#39;,b&#39;éƒ½æ˜¯æ•´æ•°ï¼Œé‚£ä¹ˆnå¿…é¡»æ˜¯gcd(a,b)çš„å€æ•°æ‰æœ‰è§£.
ä¾‹å¦‚ï¼Œ4x+6y=8,2x+3y=4æœ‰æ•´æ•°è§£ï¼Œ4x+6y=7æ²¡æœ‰æ•´æ•°è§£ã€‚
å¦‚æœæœ‰è§£ï¼Œä¸€ç§è§£é¢˜æ–¹æ³•æ˜¯å…ˆæ‰¾åˆ°ä¸€ä¸ªè§£ï¼ˆx0,y0ï¼‰,é‚£ä¹ˆé€šè§£å…¬å¼å¦‚ä¸‹ï¼š
x=x0+bt,y=y0-at,tæ˜¯ä»»æ„æ•´æ•°ã€‚
æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•èƒ½è®¡ç®—å‡ºæ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„æ•´ç³»æ•° x å’Œ yï¼šgcd(a, b) = ax + by
æˆ‘ä»¬æ¥ç›´æ¥æ¨å€’ä¸€ä¸‹ï¼š
ax + by = gcd(a, b)
æ³¨æ„åˆ°ç”±æ¬§å‡ é‡Œå¾—ç®—æ³•å¾—ï¼š
gcd(a, b) = gcd(b, a % b)
å› æ­¤ï¼š
ax + by = bx&#39; + (a % b)y&#39;
= bx&#39; + (a - int(a / b)b)y&#39;
= ay&#39; + b(x - int(a / b)y&#39;)
ax + by = ay&#39; + b(x&#39; - int(a / b)y&#39;)
æ¯æ¬¡æ±‚gcdçš„é€’å½’è¿‡ç¨‹ä¸­åŒæ—¶å°†ç³»æ•°xï¼Œyè®¡ç®—å‡ºæ¥ï¼Œä»¤x=y&#39;,y=x&#39;-a/b*y&#39;
ä¾‹ï¼šæ±‚ 9x + 7y = 1 çš„ä¸€ç»„æ•´æ•°è§£

int exgcd(int a, int b, int &amp;amp;x, int &amp;amp;y) {
	if (!b) {
		x = 1, y = 0;
		return a;
	}
	int d = exgcd(b, a % b, x, y);
	int t = x;
	x = y;
	y = t - a / b * y;
	return d;
}

æ‹“å±•æ¬§å‡ é‡Œå¾—ç®—æ³•çš„åº”ç”¨
æ›´ä¸€èˆ¬çš„ï¼Œæ±‚è§£ ax + by = c
åªè¦ gcd(a, b) | c å°±æœ‰æ— æ•°è§£ï¼Œå¦åˆ™æ— è§£

é€†å…ƒ
ä¹˜æ³•é€†å…ƒï¼šå¯¹äºä¸€ä¸ªæ•°å­— a, åœ¨æ¨¡ p æ„ä¹‰ä¸‹å¦‚æœå­˜åœ¨ä¸€ä¸ªæ•°å­— b,
æ»¡è¶³ a Ã— b â‰¡ 1 (mod p), æˆ‘ä»¬å°±ç§° b æ˜¯æ¨¡ p æ„ä¹‰ä¸‹ a çš„ä¹˜æ³•é€†å…ƒï¼Œè®°åš aâˆ’1a^{-1}aâˆ’1 ã€‚
å®¹æ˜“å‘ç°

ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹åˆ†å­åˆ†æ¯å–æ¨¡äº†ï¼æ‰€ä»¥è¿›è¡Œæ¨¡è¿ç®—çš„é‡ç‚¹å˜æˆäº†æ±‚é€†å…ƒã€‚
æ¬§æ‹‰å‡½æ•°
æ¬§æ‹‰å‡½æ•° Ï†(n), å®šä¹‰ä¸º 1 åˆ° n ä¸­ä¸ n äº’è´¨çš„æ•°å­—çš„ä¸ªæ•°ã€‚

é€šè¿‡å®šä¹‰å®¹æ˜“å¾—åˆ°æ¬§æ‹‰å‡½æ•°çš„å‰å‡ é¡¹ 1, 1, 2, 2, 4, 2, 6, Â· Â· Â·
é€šè¿‡å®šä¹‰æˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å¾—åˆ°ä¸€ä¸ªè´¨æ•° p çš„æ¬§æ‹‰å‡½æ•° Ï†(p) = p-1
æˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“å†™å‡ºä¸€ä¸ªæ±‚æ¬§æ‹‰å‡½æ•°çš„ç®€æ˜“åšæ³•ï¼Œæšä¸¾

æ³¨æ„ç›¸åŒçš„è´¨çº¦æ•°éƒ½æ˜¯ç›¸åŒçš„ pi
æœ‰äº†è¿™ä¸ªå…¬å¼æˆ‘ä»¬å°±å¯ä»¥å¿«é€Ÿçš„æ±‚å‡ºä¸€ä¸ªæ•°å­— n çš„æ¬§æ‹‰å‡½æ•°Ï†(n) äº†ã€‚
æ‰€ä»¥ï¼Œæ¬§æ‹‰å‡½æ•°Ï•(n)çš„æ±‚è§£ï¼Œå½’ç»“åˆ°äº†åˆ†è§£è´¨å› å­è¿™ä¸ªé—®é¢˜ã€‚è¯•é™¤æ³•ï¼šæ±‚nçš„è´¨å› å­æ—¶ï¼Œé€ä¸ªæ£€æŸ¥ä»2åˆ°âˆšnçš„æ‰€æœ‰è´¨æ•°ï¼Œå¦‚æœå®ƒèƒ½æ•´é™¤nï¼Œå°±æ˜¯ä¸€ä¸ªå› å­ã€‚è¯•é™¤æ³•çš„å¤æ‚åº¦æ˜¯O(âˆšn)
#include&amp;lt;iostream&amp;gt;
using namespace std;

int phi(int x)
{
    int res=x;
    for(int i=2;i&amp;lt;=x/i;i++)
    {
        if(x%i==0)
            res=res/i*(i-1);
        while(x%i==0)
            x/=i;
    }
    if(x&amp;gt;1)
        res=res/x*(x-1);
    return res;
}

int main()
{
    int n;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    while(n--)
    {
        int x;
        scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
        cout&amp;lt;&amp;lt;phi(x)&amp;lt;&amp;lt;endl;
    }
    return 0;
}

æ•°è®ºä¸­çš„æ¬§æ‹‰å®šç†
å¦‚æœ gcd(a, p) = 1 , å³ a, p äº’è´¨åˆ™æœ‰ aÏ†(p)a^{Ï†(p)}aÏ†(p) â‰¡ 1 (mod p)
æ³¨æ„è¿™ä¸ªå®šç†çš„å¼ºåˆ¶æ€§è¦æ±‚æ˜¯ a, p äº’è´¨ï¼Œå¦‚æœ a, p ä¸äº’è´¨ç›´æ¥ç”¨è¿™ä¸ªåšæ³•æ˜¯åšä¸äº†çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ‹“å±•æ¬§æ‹‰å®šç†æ‰èƒ½å¤„ç†è¿™ä¸ªé—®é¢˜
ç”±æ­¤å¯ä»¥å¾—åˆ°æ±‚ a æ¨¡ m çš„é€†çš„æ–¹æ³•ã€‚
aÏ†(m)a^{Ï†(m)}aÏ†(m)â‰¡ 1 (mod m)
aâˆ—aÏ†(m)âˆ’1a * a^{Ï†(m)-1}aâˆ—aÏ†(m)âˆ’1 â‰¡ 1 (mod m)
aÏ†(m)âˆ’1a^{Ï†(m)-1}aÏ†(m)âˆ’1 å°±æ˜¯ a æ¨¡ m çš„é€†ã€‚
æ¬§æ‹‰å®šç†æ±‚é€†å…ƒ
æœ‰äº†è¿™ä¸ªå®šç†æˆ‘ä»¬è¦æ€ä¹ˆæ±‚é€†å…ƒå‘¢ï¼Ÿè€ƒè™‘é€†å…ƒçš„å®šä¹‰ï¼Œå¯¹äºä¸€ä¸ªæ•°å­— a , æˆ‘æ‰€è¦å¯»æ‰¾çš„ aâˆ’1a^{âˆ’1}aâˆ’1 éœ€è¦æ»¡è¶³ a Ã— aâˆ’1a^{âˆ’1}aâˆ’1 â‰¡ 1 (mod p), è€Œ aÏ†(p)a^{Ï†(p)}aÏ†(p) â‰¡ 1 (mod p), è¿™å¯¹äºæˆ‘ä»¬æ˜¯å¦æœ‰ä¸€äº›å¯ç¤ºå‘¢ï¼Ÿ
æˆ‘ä»¬å°† aÏ†(p)a^{Ï†(p)}aÏ†(p)å†™æˆ a Ã— aÏ†(p)âˆ’1a^{Ï†(p)-1}aÏ†(p)âˆ’1 æˆ‘ä»¬æƒŠå–œçš„å‘ç°åŸæ¥ aâˆ’1a^{âˆ’1}aâˆ’1 å¯ç¤ºå°±æ˜¯ aÏ†(p)âˆ’1a^{Ï†(p)-1}aÏ†(p)âˆ’1 !
æ‰€ä»¥åœ¨æ±‚å‡ºæ¬§æ‹‰å‡½æ•°ä¹‹åæˆ‘ä»¬åªéœ€è¦å¿«é€Ÿå¹‚å°±èƒ½å¾—åˆ°ä¸€ä¸ªæ•°å­—çš„é€†å…ƒäº†ã€‚
int get_inv(int a) {
    return Pow(a,phi(p)-1);
}

æœ‰å¾ˆå¤šé¢˜ç›®ä¸­ç»™å®šçš„ p æ˜¯ä¸ªè´¨æ•°ï¼Œå°±æ˜¯è´¹é©¬å°å®šç†ã€‚
å¦‚æœ a, p ä¸äº’è´¨æ€ä¹ˆæ±‚é€†å…ƒå‘¢ï¼Ÿäº‹å®ä¸Šåœ¨åé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œa, p ä¸äº’è´¨çš„æƒ…å†µä¸‹æ˜¯ä¸å­˜åœ¨æ¨¡ p æ„ä¹‰ä¸‹ açš„é€†å…ƒçš„ã€‚
æ¬§æ‹‰å®šç†æ±‚åŒä½™æ–¹ç¨‹
å¯¹äºåŒä½™æ–¹ç¨‹ ax â‰¡ b (mod m)
ä¸¤è¾¹åŒä¹˜ a çš„é€† aÏ†(m)âˆ’1a^{Ï†(m)-1}aÏ†(m)âˆ’1 ax â‰¡ aÏ†(m)âˆ’1a^{Ï†(m)-1}aÏ†(m)âˆ’1 b (mod m)
å°±å¯ä»¥å¾—åˆ° x â‰¡ aÏ†(m)âˆ’1a^{Ï†(m)-1}aÏ†(m)âˆ’1 b (mod m)
æ¯”å¦‚ï¼šç”±Ï†(10) = 4ï¼Œå¯¹äºåŒä½™æ–¹ç¨‹ 3x â‰¡ 7 (mod 10)
è§£ä¸º x â‰¡ aÏ†(m)âˆ’1a^{Ï†(m)-1}aÏ†(m)âˆ’1 b â‰¡ 333^333 * 7 â‰¡ 9 (mod 10)
æ‰©å±•æ¬§æ‹‰å®šç†



æ¨¡æ¿é¢˜
ä»£ç 
æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨



Ï†(36)=Ï†(4)Ï†(9)
ç¬¬äºŒè¡Œå’Œç¬¬å››è¡Œï¼Œæ¯ä¸ªå…ƒç´ éƒ½ä¸å’Œ 4 äº’ç´ ã€‚
å‰©ä¸‹çš„ä¸¤è¡Œï¼Œæ¯ä¸ªå…ƒç´ éƒ½å’Œ 4 äº’ç´ ï¼Œä½†å„æœ‰ 6 ä¸ªæ•°å’Œ 9 äº’ç´ 


åŒä½™
ä¸€ä¸ªä¾¿äºç†è§£çš„å®šä¹‰ï¼šå¦‚æœå¯¹äºä¸¤ä¸ªæ•°å­— a, b , å¯¹äºä¸€ä¸ªæ•°å­— mçš„ä½™æ•°ç›¸ç­‰ï¼Œæˆ‘ä»¬è®¤ä¸ºä»–ä»¬å¯¹äº m åŒä½™
åœ¨æ•°å­¦ä¸Šçš„æ ‡å‡†å®šä¹‰ï¼šè®¾ m æ˜¯ç»™å®šçš„ä¸€ä¸ªæ­£æ•´æ•°ï¼Œa, b æ˜¯æ•´æ•°ï¼Œ
è‹¥æ»¡è¶³ m|(a - b) , åˆ™ç§° a ä¸ b å¯¹æ¨¡ m åŒä½™ï¼Œè®°åš a â‰¡ b (mod m)

(a + b)%c æ˜¯å¦ç­‰äº ((a%c) + (b%c))%c
a âˆ— b%c æ˜¯å¦ç­‰äº ((a%c) âˆ— (b%c))%c
a/b%c æ˜¯å¦ç­‰äº (a%c)/(b%c)
å¯¹äº 1ï¼Œ2 ä¸¤ä¸ªå¼å­æ¥è¯´ï¼Œæ˜¯æ­£ç¡®çš„ï¼Œè€Œå¯¹äºç¬¬ä¸‰ä¸ªå¼å­æ¥è¯´ï¼Œæ˜¯é”™è¯¯çš„

çº¿æ€§åŒä½™æ–¹ç¨‹
è®¾ x æ˜¯æœªçŸ¥æ•´æ•°ï¼Œå½¢å¦‚ax â‰¡ b (mod m)çš„åŒä½™å¼æˆä¸ºä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹
ax â‰¡ b (mod m)ï¼Œå³axé™¤ä»¥m,bé™¤ä»¥m,ä¸¤è€…ä½™æ•°ç›¸åŒï¼Œè¿™é‡Œa,b,méƒ½æ˜¯æ•´æ•°ï¼Œæ±‚è§£xçš„å€¼ã€‚
æ–¹ç¨‹ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ï¼Œax-bæ˜¯mçš„æ•´æ•°å€ã€‚è®¾yæ˜¯å€æ•°ï¼Œé‚£ä¹ˆax-b=my,ç§»é¡¹å¾—åˆ°ax-my=b.å› ä¸ºyå¯ä»¥æ˜¯è´Ÿæ•°ï¼Œæ”¹å†™ä¸ºax+my=bï¼Œè¿™å°±æ˜¯åœ¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ä¸­æåˆ°çš„äºŒå…ƒä¸€æ¬¡ä¸å®šæ–¹ç¨‹ã€‚
å½“ä¸”ä»…å½“gcd(a,m)èƒ½æ•´é™¤bæ—¶æœ‰æ•´æ•°è§£ã€‚
ax â‰¡ 1 (mod m) çš„è§£ç§°ä¸º a æ¨¡ m çš„é€†ã€‚
å¦‚ 7x â‰¡ 1 (mod 31) çš„è§£æ»¡è¶³ x â‰¡ 9 (mod 31)
è®¾a æ¨¡ m çš„ä¸€ä¸ªé€†ä¸º kï¼Œå³ ak â‰¡ 1 (mod m)
å¯¹äº ax â‰¡ b (mod m)ï¼Œä¸¤è¾¹åŒä¹˜ä»¥ kï¼Œå¾—åˆ° akx â‰¡ bk(mod m)
ä¹Ÿå³ x â‰¡ bk (mod m)
å®šç†ï¼šè®¾ p æ˜¯ç´ æ•°ï¼Œæ­£æ•´æ•° a æ˜¯å…¶è‡ªèº«æ¨¡ p çš„é€†ï¼Œå½“ä¸”ä»…å½“ a â‰¡ 1 (mod p) æˆ– a â‰¡ -1 (mod p)
è¯æ˜ï¼šè‹¥a â‰¡ 1 (mod p) æˆ– a â‰¡ -1 (mod p),åˆ™aÂ² â‰¡ 1 (mod p) ,æ‰€ä»¥aå…¶è‡ªèº«æ¨¡pçš„é€†ã€‚åè¿‡æ¥ï¼Œè‹¥aæ˜¯å…¶è‡ªèº«æ¨¡p
çš„é€†ï¼Œåˆ™aÂ²=aÂ·a â‰¡ 1 (mod p) ã€‚å› æ­¤ï¼Œp |(aÂ² -1)ã€‚åˆå› ä¸ºaÂ² -1=ï¼ˆa-1ï¼‰ï¼ˆa+1ï¼‰ï¼Œæ‰€ä»¥p |ï¼ˆa-1ï¼‰æˆ–p |ï¼ˆa+1ï¼‰ã€‚
å› æ­¤ï¼Œæˆ–è€…a â‰¡ 1 (mod p) ï¼Œæˆ–è€…a â‰¡ -1 (mod p)
#include&amp;lt;iostream&amp;gt;
using namespace std;

int exgcd(int a,int b,int &amp;amp;x,int &amp;amp;y)
{
    if(!b)
    {
        x=1,y=0;
        return a;
    }
    
    int d=exgcd(b,a%b,x,y);
    int t=x;
    x=y;
    y=t-a/b*y;
    return d;
}

int main()
{
    int n;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    while(n--)
    {
        int a,b,m;
        scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;a,&amp;amp;b,&amp;amp;m);
        int x,y;
        int d=exgcd(a,m,x,y);
        if(b%d)
            puts(&amp;quot;impossible&amp;quot;);
        else
            printf(&amp;quot;%d\n&amp;quot;,((long long)b/d*x%m+m)%m);
    }
    return 0;
}

æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚ä¹˜æ³•é€†å…ƒ
ax = 1 (mod m)
ax + my = 1
ä¹Ÿå°±æ˜¯ a, m æ˜¯å·²çŸ¥æ•°ï¼Œç°åœ¨è¦æ±‚å‡ºä¸€ç»„ x, y , ä½¿å¾—ä¸Šé¢çš„å¼å­æˆç«‹ã€‚
è¿™ä¹Ÿå°±å°è¯äº†ä¸Šé¢æ¬§æ‹‰å®šç†ä¸­çš„ä¸€å¥è¯ï¼Œå¦‚æœæƒ³è¦å­˜åœ¨ a å¯¹ m çš„é€†å…ƒï¼Œå¿…é¡»è¦ gcd(a, m) = 1 (1%gcd(a,m) = 0)æ‰å¯ä»¥
å½“ç„¶å¦‚æœ gcd(a, m) != 1ï¼Œå°±æ— è§£
æ³¨æ„åˆ° x çš„è§£æ˜¯ x0 + km ï¼ˆkæ˜¯ä»»æ„æ•´æ•°ï¼‰
æˆ‘ä»¬åªè¦æ±‚å‡ºä¸€ä¸ª k ä½¿å¾— x0 + km æ˜¯æœ€å°çš„æ­£æ•´æ•°å³å¯ã€‚
å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬æ±‚å‡ºçš„ x æœ‰å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥è®© x åŠ ä¸Šè‹¥ä¸ªä¸ª p, è¿™æ ·æ˜¾ç„¶æ˜¯ä¸ä¼šå½±å“æ–¹ç¨‹çš„ï¼Œä¾‹å¦‚æˆ‘åœ¨ x ä¸ŠåŠ äº†ä¸€ä¸ª p, é‚£ä¹ˆåœ¨ y ä¸Šå‡å» a å°±èƒ½ä¿è¯æ–¹ç¨‹ä¾ç„¶æˆç«‹ã€‚

è´¹é©¬å°å®šç†
å‡å¦‚ p æ˜¯è´¨æ•°ï¼Œä¸” (a, p)=1ï¼Œé‚£ä¹ˆapâˆ’1a^{p-1}apâˆ’1 â‰¡ 1 (mod p)
å› æ­¤å¯ä»¥å¾—åˆ°ï¼Œaâˆ—apâˆ’2a * a^{p-2}aâˆ—apâˆ’2 â‰¡ 1 (mod p)
æ‰€ä»¥ apâˆ’2a^{p-2}apâˆ’2 æ˜¯ a æ¨¡ p çš„ä¸€ä¸ªé€†ã€‚
å¯ä»¥ç”¨å¿«é€Ÿå¹‚åŠ é€Ÿè®¡ç®—ã€‚
#include&amp;lt;iostream&amp;gt;
using namespace std;
typedef long long LL;
int qml(int a,int b,int p)
{
    int res=1;
    while(b)
    {
        if(b&amp;amp;1)
            res=(LL)res*a%p;
        a=(LL)a*a%p;
        b&amp;gt;&amp;gt;=1;
    }
    return res;
}

int main()
{
    int n;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    while(n--)
    {
        int b,p;
        scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;b,&amp;amp;p);
        if(b%p==0)
            puts(&amp;quot;impossible&amp;quot;);
        else
            printf(&amp;quot;%d\n&amp;quot;,qml(b,p-2,p));
    }
    return 0;
}

çº¿æ€§æ±‚é€†å…ƒ
ç»™å®š n, p æ±‚ [1, n] ä¸­æ‰€æœ‰æ•´æ•°åœ¨æ¨¡ p æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œn â‰¤ 2 Ã— 1e6, p â‰¤ 2 Ã— 1e7ã€‚
æˆ‘ä»¬è€ƒè™‘ä» 1 åˆ° n ä¾æ­¤æ±‚å‡ºæ¯ä¸ªæ•°å­—çš„é€†å…ƒï¼Œæšä¸¾å˜é‡ i, 1 â†’ n,
é»˜è®¤ [1, i - 1] æ¯ä¸ªæ•°å­—å¯¹äº p çš„é€†å…ƒéƒ½å·²ç»æ±‚å®Œ,ç°åœ¨æˆ‘ä»¬è€ƒè™‘ i å¯¹ p çš„é€†å…ƒè¦æ€ä¹ˆæ±‚ã€‚
ä¸å¦¨æŠŠ p å†™æˆ ki + b çš„å½¢å¼ä¹Ÿå³


æ¨¡æ¿é¢˜
#include&amp;lt;cstdio&amp;gt;
using namespace std;
typedef long long LL;
const int N=3e6+10;
int inv[N];
int main()
{
    int n,p;
    scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;n,&amp;amp;p);
    inv[1]=1;
    for(int i=2;i&amp;lt;=n;i++)
        inv[i]=(LL)(p-p/i)*inv[p%i]%p;
    for(int i=1;i&amp;lt;=n;i++)
    	printf(&amp;quot;%d\n&amp;quot;,inv[i]);
    return 0;
}

é˜¶ä¹˜çš„é€†å…ƒ
è¿™é‡Œç‰¹åˆ«åˆ—å‡ºé˜¶ä¹˜çš„é€†å…ƒï¼Œå› ä¸ºåé¢æœ‰ç»„åˆæ•°å­¦å’Œç»„åˆæ•°å–æ¨¡ç›¸å…³çš„é—®é¢˜ï¼Œæ‰€ä»¥è¿™é‡Œç‰¹åˆ«åˆ—å‡ºäº†é˜¶ä¹˜å¦‚ä½•æ±‚é€†å…ƒã€‚
æœ‰å¾ˆå¤šåŒå­¦ä¼šè®¤ä¸ºå…ˆæ±‚å‡º [1, n] æ¯ä¸ªæ•°å­—å¯¹pçš„é€†å…ƒå°±å¯ä»¥äº†ã€‚è¿™æ ·å¤„ç†ç¡®å®å¯ä»¥ï¼Œä½†æ˜¯è¿‡äºç¹çï¼Œæˆ‘ä»¬è€ƒè™‘ä¸€å…±æ›´ç®€å•çš„åšæ³•ã€‚

int ifac[N], fac = 1, mod;
for(int i = 2; i &amp;lt;= n; ++ i) 
	fac = (long long) fac * i % mod;
ifac[n] = get_inv(fac, mod);
for(int i = n - 1; i &amp;gt;= 0; -- i) 
	ifac[i] = (long long)ifac[i + 1] * (i + 1) % mod;

çº¿æ€§åŒä½™æ–¹ç¨‹ç»„
ç¬¬ä¸€ç§ï¼šæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„ä¸åŒæ¨¡çš„ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹ï¼›
ç¬¬äºŒç§ï¼šå˜å…ƒæ•°å¤§äº 1ï¼Œæ–¹ç¨‹æ•°å¤§äº 1ï¼Œä½†æ˜¯æ–¹ç¨‹çš„æ¨¡ç›¸åŒ
ä¸­å›½å‰©ä½™å®šç†
ä¸‹é¢å–è‡ªæˆä¹¦äºå…¬å…ƒ 3 ä¸–çºªæ™šæœŸçš„ã€Šå­™å­ç®—ç»ã€‹çš„é—®é¢˜ã€‚
æ±‚ä¸€ä¸ªæ•°ï¼Œå®ƒè¢« 3 é™¤ä½™ 1ï¼Œè¢« 5 é™¤ä½™ 2ï¼Œè¢« 7 é™¤ä½™ 3ã€‚
è¿™ä¹Ÿå°±ç­‰ä»·äºå¦‚ä¸‹æ–¹ç¨‹ç»„ï¼š
x â‰¡ 1 (mod 3)
x â‰¡ 2 (mod 5)
x â‰¡ 3 (mod 7)


æ­£ç¡®æ€§æ˜¾ç„¶ï¼Œä»£å…¥å³å¯ã€‚è¿˜éœ€è¦è¯æ˜å”¯ä¸€æ€§ã€‚

x â‰¡ 1 (mod 3)
x â‰¡ 2 (mod 5)
x â‰¡ 3 (mod 7)
ç°åœ¨å›åˆ°å¼€å¤´çš„é‚£ä¸ªæ–¹ç¨‹ç»„ï¼Œé¦–å…ˆæœ‰ M = 105
M1 = 35ï¼ŒM2 = 21ï¼ŒM3 = 15
y1 = 2, y2 = 1, y3 = 1
å› æ­¤ x â‰¡ 1 * 35 * 2 + 2 * 21 * 1 + 3 * 15 * 1 â‰¡ 157â‰¡ 52 (mod 105)
ä¸­å›½å‰©ä½™å®šç†ç»™å‡ºäº†æ¨¡æ•°ä¸¤ä¸¤äº’è´¨çš„çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„ä¸€ä¸ªç‰¹æ®Šè§£ã€‚æ–¹ç¨‹ç»„çš„é€šè§£å¯ä»¥è¡¨ç¤ºä¸ºx+kMï¼ˆkâˆˆZï¼‰ã€‚æœ‰äº›é¢˜ç›®è¦æ±‚æˆ‘ä»¬æ±‚å‡ºæœ€å°çš„éè´Ÿæ•´æ•°è§£ï¼Œåªéœ€æŠŠxå¯¹Må–æ¨¡ï¼Œå¹¶è®©xè½åœ¨0~M-1çš„èŒƒå›´å†…å³å¯ã€‚
æ¨¡æ¿é¢˜
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
typedef long long LL;
const int N=15;
int n;
int a[N],b[N];

void exgcd(LL a,LL b,LL &amp;amp;x,LL &amp;amp;y)
{
	if(!b)
	{
		x=1,y=0;
		return;
	}
	exgcd(b,a%b,x,y);
	LL t=x;
	x=y;
	y=t-a/b*y;
}

LL crt()
{
	LL M=1,res=0;
	for(int i=1;i&amp;lt;=n;i++)
		M*=a[i];
	for(int i=1;i&amp;lt;=n;i++)
	{
		LL m,x,y;
		m=M/a[i];
		exgcd(m,a[i],x,y);
		res=(res+m*x*b[i])%M;
	}
	return (res%M+M)%M;
}

int main()
{
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	for(int i=1;i&amp;lt;=n;i++)
		scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;a[i],&amp;amp;b[i]);
	printf(&amp;quot;%lld\n&amp;quot;,crt());
	return 0;
}

æ‰©å±•ä¸­å›½å‰©ä½™å®šç†

è¯æ˜ï¼š




æ¨¡æ¿é¢˜
code

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/shu-lun/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/kuai-su-mi-andju-zhen-kuai-su-mi/">
                        å¿«é€Ÿå¹‚&amp;çŸ©é˜µå¿«é€Ÿå¹‚
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-26</time>
                    
                        <a href="https://caifxh.github.io/tag/14SoYNkfD/" class="post-tag i-tag
                            i-tag-other_1">
            #æ•°å­¦
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            å¿«é€Ÿå¹‚
ç»™å‡º aï¼Œb, cï¼Œæ±‚å‡º aba^bab mod c.a, b, c &amp;lt;= 1e9
æšä¸¾ bï¼Œè¿ç»­ä¹˜ b æ¬¡ aï¼Œæ¯ä¹˜ä¸€æ¬¡å¯¹ c å–æ¨¡ä¸€æ¬¡ã€‚
æ—¶é—´å¤æ‚åº¦å…³äº b çº¿æ€§ã€‚
æ¯æ¬¡éƒ½ä¹˜çš„æ˜¯ aï¼Œé‡å¤è¿ç®—å¤ªå¤šï¼Œè€ƒè™‘åˆ†æ²»
æ¯”å¦‚è®¡ç®—å‡º a,a2,a4,a8,a16a, a^2, a^4, a^8, a^{16}a,a2,a4,a8,a16, â€¦
å¯¹ b è¿›è¡ŒäºŒè¿›åˆ¶è½¬æ¢ï¼Œæ¯”å¦‚ b = 11 = 8 + 2 + 1
æ•… ab=a11=a8âˆ—a2âˆ—aa^b = a^{11} = a^8 * a^2 * aab=a11=a8âˆ—a2âˆ—a
å› æ­¤ï¼Œåªè¦é¢„å¤„ç†å‡º log2109log_2 10^9log2â€‹109 ä¸ª a çš„å¹‚æ¬¡
è®¡ç®—çš„æ—¶å€™åˆ†è§£æˆ log2 b ä¸ªä¹˜ç§¯å³å¯
æ¨¡æ¿é¢˜
int qmi(int a,int b,int p)
{
    int res=1%p;
    while(b)
    {
        if(b&amp;amp;1)
            res=(long long)res*a%p;
        a=(long long)a*a%p;
        b&amp;gt;&amp;gt;=1;
    }
    return res;
}

å¿«é€Ÿä¹˜
ç»™å‡º aï¼Œb, cï¼Œæ±‚å‡º aâˆ—ba * baâˆ—b mod c.a, b, c &amp;lt;= 1e18
æ²¿ç”¨ä¹‹å‰çš„åšæ³•ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œçš„æ¨¡æ•°æ˜¯ 1e18ã€‚å¦‚æœä¸¤ä¸ªå°äº 1e18 çš„æ•°ç›¸ä¹˜ï¼Œlong longä¹Ÿå­˜ä¸ä¸‹ã€‚
è€ƒè™‘åˆ°å¹‚æ¬¡å¯ä»¥è½¬åŒ–ä¸ºè¿ä¹˜ï¼Œä¹˜æ³•ä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºè¿åŠ ã€‚
åŒæ ·çš„æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªâ€œå¿«é€Ÿâ€ä¹˜
æ¯”å¦‚è®¡ç®—å‡º a, 2a, 4a, 8a, 16a, â€¦
å¯¹ b è¿›è¡ŒäºŒè¿›åˆ¶è½¬æ¢ï¼Œæ¯”å¦‚ b = 11 = 8 + 2 + 1
æ•… ba = 11a = 8a + 2a + a
å› æ­¤ï¼Œåªè¦é¢„å¤„ç†å‡º log21018log_2 10^{18}log2â€‹1018 ä¸ª a çš„ä¹˜ç§¯
è®¡ç®—çš„æ—¶å€™åˆ†è§£æˆ log2 b ä¸ªåŠ æ³•å³å¯ã€‚
å› ä¸ºæ¯æ¬¡ä¸¤ä¸ªå°äº 1e18 çš„æ•°ç›¸åŠ ï¼Œlong longæ˜¯å¯ä»¥å­˜çš„ã€‚
æ¨¡æ¿é¢˜
long long mul(long long a, long long b, long long c)
{
    long long ans = 0;
    while (b) 
    {
        if (b &amp;amp; 1) ans = (ans + a) % c;
        b &amp;gt;&amp;gt;= 1;
        a = (a + a) % c;
    }
    return ans; 
}

ä¾‹é¢˜
luoguP1965
ç­”æ¡ˆæ˜¾ç„¶å°±æ˜¯ (x + m * 10^k) % n
æ ¹æ®æ¨¡è¿ç®—çš„çš„åˆ†é…ç‡å¯ä»¥å¾—åˆ° (x%n+m%n*10k%n)%n,åªéœ€ç”¨å¿«é€Ÿå¹‚æ±‚å‡º10kå°±å¯ä»¥äº†
ä»£ç 
çŸ©é˜µä¹˜æ³•
ç»™å®šä¸€ä¸ªå¤§å°ä¸º n Ã— m çš„çŸ©é˜µ A[n][m]
å’Œä¸€ä¸ªå¤§å°ä¸º m Ã— r çš„çŸ©é˜µ B[m][r]
    for (int i = 1;i &amp;lt;= n;i ++)
        for (int j = 1;j &amp;lt;= r;j ++)
            for (int k = 1;k &amp;lt;= m;k ++)
                C[i][j] += A[i][k] * B[k][j];
æ—¶é—´å¤æ‚åº¦: O(n^3)

çŸ©é˜µå¿«é€Ÿå¹‚
poj3233
ç»™å®šä¸€ä¸ª n Ã— n çš„çŸ©é˜µ Aï¼Œå’Œä¸€ä¸ªæ­£æ•´æ•° kã€‚ æ±‚ S=A+A2+â€¦+AkS = A + A^2 + â€¦ + A^kS=A+A2+â€¦+Akï¼Œå¯¹ m å–æ¨¡,n â‰¤ 30ï¼Œk â‰¤ 1e9

æ ·ä¾‹è¾“å…¥ï¼š
2 2 4
0 1
1 1
æ ·ä¾‹è¾“å‡ºï¼š
1 2
2 3
æ³¨æ„åˆ°ï¼ŒçŸ©é˜µä¹˜æ³•ä¹Ÿæ˜¯å…·æœ‰ç»“åˆå¾‹å’Œä¹˜æ³•åˆ†é…å¾‹çš„ã€‚
å› æ­¤ï¼š(Iä¸ºå•ä½é˜µ)
A+A2=A(I+A)A + A^2 = A(I + A)A+A2=A(I+A)
A+A2+A3+A4=(A+A2)(I+A2)A + A^2 + A^3 + A^4 = (A + A^2)(I + A^2)A+A2+A3+A4=(A+A2)(I+A2)
æˆ‘ä»¬è®° sum(n)=A+A2+â€¦+Ansum(n) = A + A^2 + â€¦ + A^nsum(n)=A+A2+â€¦+An
å¦‚æœ n æ˜¯å¶æ•°:
sum(n)=sum(n/2)(I+An/2)sum(n) = sum(n / 2)(I + A^{n/2})sum(n)=sum(n/2)(I+An/2)
å¦‚æœ n æ˜¯å¥‡æ•°ï¼š
sum(n)=sum(nâˆ’1)+An=sum((nâˆ’1)/2)(I+A(nâˆ’1)/2ï¼‰+Ansum(n) = sum(n - 1) + A^n = sum((n - 1) / 2)(I + A^{(n-1)/2}ï¼‰+ A^nsum(n)=sum(nâˆ’1)+An=sum((nâˆ’1)/2)(I+A(nâˆ’1)/2ï¼‰+An
åªéœ€è¦è§£å†³å¦‚ä½•å¿«é€Ÿæ±‚ A^n
å¯¹äºæ•´æ•°çš„å¹‚æ¬¡ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¿«é€Ÿå¹‚æ¥æ±‚ã€‚
å¯¹äºçŸ©é˜µçš„å¹‚æ¬¡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å¿«é€Ÿå¹‚æ¥æ±‚ã€‚
æ³¨æ„çš„æ˜¯ï¼Œåˆå§‹å€¼è¦è®¾ç½®ä¸ºå•ä½çŸ©é˜µ Iã€‚ä¹Ÿå°±æ˜¯ A0A^0A0.
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=35;
struct matrix
{
	int m[N][N];
	matrix()
	{
		memset(m,0,sizeof m);
	}
}a;
int n,k,mod;

matrix add(matrix a,matrix b)
{
	matrix res;
	for(int i=1;i&amp;lt;=n;i++)
		for(int j=1;j&amp;lt;=n;j++)
			res.m[i][j]=(a.m[i][j]+b.m[i][j])%mod;
	return res;
}

matrix mul(matrix a,matrix b)
{
	matrix c;
	for(int i=1;i&amp;lt;=n;i++)
		for(int j=1;j&amp;lt;=n;j++)
			for(int k=1;k&amp;lt;=n;k++)
				c.m[i][j]=(c.m[i][j]+a.m[i][k]*b.m[k][j])%mod;
	return c;
}

matrix qmi(matrix a,int k)
{
	matrix c;
	for(int i=1;i&amp;lt;=n;i++)
		c.m[i][i]=1;
	while(k)
	{
		if(k &amp;amp; 1)
			c=mul(c,a);
		a=mul(a,a);
		k&amp;gt;&amp;gt;=1;
	}
	return c;
}

matrix get_sum(matrix a,int k)
{
	if(k == 1)
		return a;
	matrix c;
	for(int i=1;i&amp;lt;=n;i++)
		c.m[i][i]=1;
	
	c=add(c,qmi(a,k&amp;gt;&amp;gt;1));
	c=mul(c,get_sum(a,k&amp;gt;&amp;gt;1));
	if(k &amp;amp; 1)
		c=add(c,qmi(a,k));
	return c;
 } 

int main()
{
	scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;k,&amp;amp;mod);
	
	for(int i=1;i&amp;lt;=n;i++)
		for(int j=1;j&amp;lt;=n;j++)
			scanf(&amp;quot;%d&amp;quot;,&amp;amp;a.m[i][j]);
	
	a=get_sum(a,k);
	
	for(int i=1;i&amp;lt;=n;i++)
	{
		for(int j=1;j&amp;lt;=n;j++)
			printf(&amp;quot;%d &amp;quot;,a.m[i][j]);
		puts(&amp;quot;&amp;quot;);
	}
		
	return 0;
}

çŸ©é˜µä¹˜æ³•ä¼˜åŒ–é€’æ¨
poj3070


#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
typedef long long LL;
const int N=2,mod=10000;
int n;
struct matrix
{
    int m[N][N];
    matrix()
    {
    	memset(m,0,sizeof m);
	}
    matrix(int a[][N])
    {
        memcpy(m,a,sizeof m);
    }
};

matrix mul(matrix a,matrix b)
{
	matrix res;
	for(int i=0;i&amp;lt;2;i++)
		for(int j=0;j&amp;lt;2;j++)
			for(int k=0;k&amp;lt;2;k++)
				res.m[i][j]=(res.m[i][j]+(LL)a.m[i][k]*b.m[k][j])%mod;
	return res;
}

matrix qmi(matrix a,int k)
{
	matrix res;
	for(int i=0;i&amp;lt;2;i++)
		res.m[i][i]=1;
	
	while(k)
	{
		if(k &amp;amp; 1)
			res=mul(res,a);
		a=mul(a,a);
		k&amp;gt;&amp;gt;=1;
	}
	return res;
}

int main()
{
	while(scanf(&amp;quot;%d&amp;quot;,&amp;amp;n) &amp;amp;&amp;amp; ~n)
	{
		int f[N][N]={{1,0}};
		int c[N][N]={{1,1},{1,0}};
		matrix a=c;
		matrix b=f;
		if(n)
		{
			a=qmi(a,n-1);
			b=mul(b,a);
			printf(&amp;quot;%d\n&amp;quot;,b.m[0][0]);
		}
		else 
			printf(&amp;quot;0\n&amp;quot;);	
	}
}


acwing1303

ä»£ç 

æ•°åˆ—f[n]=f[n-1]+f[n-2]+1,f[1]=f[2]=1çš„ç¬¬né¡¹çš„å¿«é€Ÿæ±‚æ³•ï¼ˆä¸è€ƒè™‘é«˜ç²¾åº¦ï¼‰
ä»¿ç…§å‰ä¾‹ï¼Œè€ƒè™‘1Ã—3çš„çŸ©é˜µ[f[n-2],f[n-1],1]ï¼Œå¸Œæœ›æ±‚å¾—æŸ3Ã—3çš„çŸ©é˜µAï¼Œä½¿å¾—æ­¤1Ã—3çš„çŸ©é˜µä¹˜ä»¥Aå¾—åˆ°çŸ©é˜µï¼š
[f[n-1],f[n],1]
å³ï¼š[]f[n-2],f[n-1],1]* A ï¼[f[n-1],f[n],1] =[f[n-1],f[n-1]+f[n-2]+1,1]
å®¹æ˜“æ„é€ å‡ºè¿™ä¸ª3Ã—3çš„çŸ©é˜µAï¼Œå³ï¼š
ï¼ ï¼‘ ï¼
ï¼‘ ï¼‘ ï¼
ï¼ ï¼‘ ï¼‘

æ•°åˆ—f[n]=f[n-1]+f[n-2]+n+1,f[1]=f[2]=1çš„ç¬¬né¡¹çš„å¿«é€Ÿæ±‚æ³•ï¼ˆä¸è€ƒè™‘é«˜ç²¾åº¦ï¼‰.
è§£æ³•ï¼š
ä»¿ç…§å‰ä¾‹ï¼Œè€ƒè™‘1Ã—4çš„çŸ©é˜µ[f[n-2],f[n-1],n,1]ï¼Œå¸Œæœ›æ±‚å¾—æŸ4Ã—4çš„çŸ©é˜µAï¼Œä½¿å¾—æ­¤1Ã—4çš„çŸ©é˜µä¹˜ä»¥Aå¾—åˆ°çŸ©é˜µï¼š[f[n-1],f[n],n+1,1]
å³ï¼š[f[n-2],f[n-1],n,1]* A  = [f[n-1],f[n],n+1,1]ï¼[f[n-1],f[n-1]+f[n-2]+n+1,n+1,1]
å®¹æ˜“æ„é€ å‡ºè¿™ä¸ª4Ã—4çš„çŸ©é˜µAï¼Œå³ï¼š
ï¼ ï¼‘ ï¼ ï¼
ï¼‘ ï¼‘ ï¼ ï¼
ï¼ ï¼‘ ï¼‘ ï¼
ï¼ ï¼‘ ï¼‘ ï¼‘

ä¾‹é¢˜
poj3735
æœ‰ n åªå°çŒ«ï¼Œè¦æ‰§è¡Œä¸€äº›æ“ä½œåºåˆ—ã€‚
g iï¼šç»™ç¬¬ i åªå°çŒ«ä¸€æ£µèŠ±ç”Ÿ
e iï¼šè®©ç¬¬ i åªå°çŒ«åƒæ‰å®ƒçš„æ‰€æœ‰èŠ±ç”Ÿ
s i jï¼šè®©ç¬¬ i åªå°çŒ«å’Œç¬¬ j åªå°çŒ«äº¤æ¢ä»–ä»¬æ‰‹é‡Œçš„èŠ±ç”Ÿã€‚
ç°åœ¨ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º k çš„åºåˆ—ï¼Œè®©ä½ åå¤æ‰§è¡Œè¿™ä¸ªåºåˆ— m
æ¬¡ã€‚é—®æœ€åæ¯åªå°çŒ«æ‰‹é‡Œçš„èŠ±ç”Ÿæ•°ã€‚nâ‰¤100ï¼Œkâ‰¤100ï¼Œmâ‰¤1e9
è”ç³»çŸ©é˜µä¼˜åŒ–é€’æ¨ã€‚
å¦‚æœæˆ‘ä»¬ä¹Ÿèƒ½æ±‚å‡ºä¸€ä¸ªåºåˆ—å¯¹åº”çš„çŸ©é˜µã€‚
åªè¦æ±‚çŸ©é˜µçš„ m æ¬¡å¹‚å³å¯ã€‚
å…ˆè€ƒè™‘å¦‚ä½•è®¾è®¡çŠ¶æ€ï¼š
æŠŠåˆšæ‰é‚£3åªçŒ«çœ‹åšä¸€ä¸ªçŸ©é˜µ{a,b,c},åˆ†åˆ«ä»£è¡¨ä»–ä»¬æœ‰çš„èŠ±ç”Ÿä¸ªæ•°ï¼Œæ˜¾ç„¶åˆå§‹æ˜¯{0,0,0}
å½“è¿›è¡Œsæ“ä½œçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†åˆå§‹çŸ©é˜µä¹˜ä¸Šä¸€ä¸ªçŸ©é˜µï¼Œå¾—åˆ°çš„é‚£ä¸ªçŸ©é˜µæœ€å¥½ä¹Ÿæ˜¯1è¡Œ3åˆ—çš„ã€‚
é‚£è‚¯å®šæˆ‘ä»¬è¦æ„é€ çš„é‚£ä¸ªçŸ©é˜µæ˜¯3*3çš„çŸ©é˜µ
s 1 2äº¤æ¢æ“ä½œå°±æ˜¯{a,b,c}*x={b,a,c}
x=  0 1 0
    1 0 0
    0 0 1

Sæ“ä½œæ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆå°†Xçœ‹åšä¸€ä¸ªå•ä½çŸ©é˜µï¼Œè¦äº¤æ¢å“ªä¸¤ä¸ªï¼Œåªéœ€è¦äº¤æ¢ä»–ä»¬çš„åˆ—å°±å¯ä»¥äº†
å¯¹äºeæ“ä½œè¿‘ä¼¼äºsæ“ä½œï¼Œå°†e 2ä¸¾ä¾‹ï¼š{a,b,c}*x={a,0,c}
x=  1 0 0
    0 0 0
    0 0 1

å³å°†æŸåˆ—ç½®äº0
ç°åœ¨é—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆæ„é€ gæ“ä½œçš„çŸ©é˜µã€‚ä½¿ä¸‹é¢è¿™ä¸ªç­‰å¼æˆç«‹
g 1æ“ä½œ  {a,b,c}*X={a+1,b,c}
g 2æ“ä½œ  {a,b,c}*X={a,b+1,c}
g 3æ“ä½œ  {a,b,c}*X={a,b,c+1}
æˆ‘ä»¬ä¸å¦¨å†{a,b,c}çŸ©é˜µå¤šåŠ ä¸€ä¸ª1ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å®ç°æˆ‘ä»¬çš„+1æ“ä½œäº†
è¦ä½¿g 1æ“ä½œå®ç°{a,b,c,1}*x={a+1,b,c,1}
é‚£ä¹ˆ
x=  1 0 0 0
    0 1 0 0
    0 0 1 0
    1 0 0 1

å½“ç„¶è¿™æ ·æ„é€ çŸ©é˜µï¼Œè¿™æ ·å¹¶ä¸å½±å“æˆ‘ä»¬å‰é¢çš„sä¸eæ“ä½œ
è¿™æ ·ä¸€ç³»åˆ—æ“ä½œä¹‹åï¼š

å¾—åˆ°è¿™ä¸ªçŸ©é˜µåï¼Œæ±‚å®ƒçš„ m æ¬¡å¹‚ï¼Œç„¶åä¹˜ä¸Šåˆå§‹çŠ¶æ€å¯¹åº”
çš„å‘é‡ï¼Œå¾—åˆ°çš„å°±æ˜¯ç­”æ¡ˆã€‚
æ—¶é—´å¤æ‚åº¦: O(n^3log m)
ä»£ç 
poj3150
æœ‰ n ä¸ªæ•°æ’æˆä¸€ä¸ªç¯ã€‚å®šä¹‰ä¸€æ¬¡å˜æ¢ä¸ºï¼šæŠŠè¿™ä¸ªæ•°å˜æˆè·ç¦»å®ƒä¸è¶…è¿‡ d çš„ä½ç½®ä¸Šçš„æ•°ä¹‹å’Œå¯¹ m å–æ¨¡çš„å€¼ã€‚
é—®è¿™æ ·å˜æ¢ k æ¬¡åï¼Œæ¯ä¸ªä½ç½®ä¸Šçš„æ•°æ˜¯å¤šå°‘ã€‚
n &amp;lt;= 500, m &amp;lt;= 109, k &amp;lt;= 1e9
å¯¹äºæ¯ä¸€æ¬¡å˜æ¢ï¼Œå…¶å®å¯ä»¥å†™æˆä¸€ä¸ªçŸ©é˜µï¼š
æ¯”å¦‚é¢˜ä¸­ d = 2



å› æ­¤ä¸€ä¸ªçŸ©é˜µåªè¦å­˜ä¸‹ç¬¬ä¸€è¡Œå°±å¯ä»¥å¾—åˆ°æ•´ä¸ªçŸ©é˜µã€‚
è®¡ç®—çŸ©é˜µä¹˜æ³•çš„æ—¶å€™ï¼Œåªè¦æšä¸¾ n^2 æ¬¡ã€‚
æ—¶é—´å¤æ‚åº¦å˜æˆäº† O(n^2 log k)
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
typedef long long LL;
const int N=510;
int n,mod,d,k;
struct matrix 
{
	int m[N];
	matrix()
	{
		for(int i=0;i&amp;lt;N;i++)
			m[i]=0;
	}
	matrix(int a[])
	{
		memcpy(m,a,sizeof m);
	}
};

matrix mul(matrix a,matrix b)
{
	matrix res;
	
	for(int i=0;i&amp;lt;n;i++)//åªè®¡ç®—resçš„ç¬¬ä¸€è¡Œ 
		for(int k=0;k&amp;lt;n;k++)
			res.m[i]=(res.m[i]+(LL)a.m[k]*b.m[(i-k+n)%n])%mod;
	return res;
}

matrix qmi(matrix a,int k)
{
	matrix res;
	res.m[0]=1;
		
	while(k)
	{
		if(k&amp;amp;1) res=mul(res,a);
		a=mul(a,a);
		k&amp;gt;&amp;gt;=1;
	}
	return res;
}

int main()
{
	scanf(&amp;quot;%d%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;mod,&amp;amp;d,&amp;amp;k);
	matrix b;
	for(int i=0;i&amp;lt;n;i++)
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;b.m[i]);
	matrix a;
	for(int i=0;i&amp;lt;n;i++)
		if(i&amp;lt;=d || (i+d)%n == 0)
			a.m[i]=1;
	a=qmi(a,k);	
//	for(int i=0;i&amp;lt;n;i++)
//		printf(&amp;quot;%d &amp;quot;,a.m[i]);
	b=mul(b,a);
	for(int i=0;i&amp;lt;n;i++)
		printf(&amp;quot;%d &amp;quot;,b.m[i]);
	return 0;
}


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/kuai-su-mi-andju-zhen-kuai-su-mi/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/xian-xing-dp/">
                        çº¿æ€§dp
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-26</time>
                    
                        <a href="https://caifxh.github.io/tag/hLQFdtGuD/" class="post-tag i-tag
                            i-tag-error">
            #DP
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
å¤šé˜¶æ®µå†³ç­–é—®é¢˜
æœ‰ä¸€ç±»æ´»åŠ¨çš„è¿‡ç¨‹ï¼Œå¯ä»¥åˆ†æˆè‹¥å¹²ä¸ªäº’ç›¸è”ç³»çš„é˜¶æ®µï¼Œåœ¨å®ƒçš„æ¯ä¸€é˜¶æ®µéƒ½éœ€è¦ä½œå‡ºå†³ç­–ï¼Œä»è€Œä½¿æ•´ä¸ªè¿‡ç¨‹è¾¾åˆ°æœ€å¥½çš„æ´»åŠ¨æ•ˆã€‚
å½“ç„¶ï¼Œå„ä¸ªé˜¶æ®µçš„å†³ç­–çš„é€‰å–ä¸æ˜¯ä»»æ„ç¡®å®šçš„ï¼Œå®ƒä¾èµ–äºå½“å‰çš„çŠ¶æ€ï¼Œåˆä¼šå½±å“ä»¥åçš„å‘å±•ã€‚
å½“å„ä¸ªé˜¶æ®µå†³ç­–å†³å®šåï¼Œå°±ç»„æˆä¸€ä¸ªå†³ç­–åºåˆ—ï¼Œå› è€Œä¹Ÿå°±ç¡®å®šäº†æ•´ä¸ªè¿‡ç¨‹çš„ä¸€æ¡æ´»åŠ¨è·¯çº¿ã€‚
è¿™ç§æŠŠä¸€ä¸ªé—®é¢˜çœ‹åšæ˜¯ä¸€ä¸ªå‰åå…³è”ã€å…·æœ‰é“¾çŠ¶ç»“æ„çš„å¤šé˜¶æ®µè¿‡ç¨‹å°±ç§°ä¸ºå¤šé˜¶æ®µå†³ç­–è¿‡ç¨‹ï¼Œè¿™ç§é—®é¢˜å°±ç§°ä¸ºå¤šé˜¶æ®µå†³ç­–é—®é¢˜ã€‚
å„ä¸ªé˜¶æ®µé‡‡å–çš„å†³ç­–ï¼Œ ä¸€èˆ¬æ¥è¯´æ˜¯ä¸é˜¶æ®µæœ‰å…³çš„ã€‚
å†³ç­–ä¾èµ–äºå½“å‰çš„çŠ¶æ€ï¼Œåˆéšå³å¼•èµ·çŠ¶æ€çš„è½¬ç§»ã€‚
ä¸€ä¸ªå†³ç­–åºåˆ—å°±æ˜¯åœ¨å˜åŒ–çš„çŠ¶æ€ä¸­äº§ç”Ÿå‡ºæ¥çš„ã€‚
ç§°è¿™ç§è§£å†³å¤šé˜¶æ®µå†³ç­–æœ€ä¼˜åŒ–çš„è¿‡ç¨‹ä¸ºåŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰ã€‚
åŠ¨æ€è§„åˆ’ï¼ˆDynamic Programmingï¼‰ç¨‹åºè®¾è®¡æ˜¯å¯¹è§£æœ€ä¼˜åŒ–é—®é¢˜çš„ä¸€ç§é€”å¾„ã€ä¸€ç§æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä¸€ç§ç‰¹æ®Šç®—æ³•ã€‚
ç”±äºå„ç§é—®é¢˜çš„æ€§è´¨ä¸åŒï¼Œç¡®å®šæœ€ä¼˜è§£çš„æ¡ä»¶ä¹Ÿäº’ä¸ç›¸åŒï¼Œå› æ­¤ä¸å­˜åœ¨ä¸€ç§ä¸‡èƒ½çš„åŠ¨æ€è§„åˆ’ç®—æ³•å¯ä»¥è§£å†³å„ç±»æœ€ä¼˜åŒ–é—®é¢˜ã€‚
å¸¸è§çš„ DP ç±»å‹æœ‰ï¼š
çº¿æ€§æ¨¡å‹
åŒºé—´ DP
èƒŒåŒ… DP
æ•°ä½ DP
çŠ¶æ€å‹ç¼© DP
æ ‘çŠ¶ DP
å¸¸è§çš„ DP ä¼˜åŒ–æ–¹æ³•æœ‰ï¼š
æ»šåŠ¨æ•°ç»„ä¼˜åŒ–
çŸ©é˜µä¹˜æ³•ä¼˜åŒ–
æ–œç‡ä¼˜åŒ–
å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–
å†³ç­–å•è°ƒæ€§ä¼˜åŒ–
æ•°æ®ç»“æ„ä¼˜åŒ–
åŠ¨æ€è§„åˆ’çš„åŸºæœ¬æ¦‚å¿µ
1.é˜¶æ®µå’Œé˜¶æ®µå˜é‡
å°†é—®é¢˜çš„å…¨è¿‡ç¨‹æ°å½“åœ°åˆ†æˆè‹¥å¹²ä¸ªç›¸äº’è”ç³»çš„é˜¶æ®µã€‚
é˜¶æ®µçš„åˆ’åˆ†ä¸€èˆ¬æ ¹æ®æ—¶é—´å’Œç©ºé—´çš„è‡ªç„¶ç‰¹å¾å»åˆ’åˆ†ã€‚
é˜¶æ®µçš„åˆ’åˆ†è¦ä¾¿äºæŠŠé—®é¢˜è½¬åŒ–æˆå¤šé˜¶æ®µå†³ç­–é—®é¢˜ã€‚
2.çŠ¶æ€å’ŒçŠ¶æ€å˜é‡
é€šå¸¸ä¸€ä¸ªé˜¶æ®µåŒ…å«è‹¥å¹²çŠ¶æ€ã€‚
çŠ¶æ€å¯ç”±å˜é‡æ¥æè¿°ã€‚
3.å†³ç­–ã€å†³ç­–å˜é‡å’Œå†³ç­–å…è®¸é›†åˆã€‚
åœ¨å¯¹é—®é¢˜çš„å¤„ç†ä¸­ä½œå‡ºçš„æ¯ç§é€‰æ‹©æ€§çš„è¡ŒåŠ¨å°±æ˜¯å†³ç­–ã€‚
å³ä»è¯¥é˜¶æ®µçš„æ¯ä¸€ä¸ªçŠ¶æ€å‡ºå‘ï¼Œ é€šè¿‡ä¸€æ¬¡é€‰æ‹©æ€§çš„è¡ŒåŠ¨è½¬ç§»è‡³ä¸‹ä¸€é˜¶æ®µçš„ç›¸åº”çŠ¶æ€ã€‚
ä¸€ä¸ªå®é™…é—®é¢˜å¯èƒ½éœ€è¦æœ‰å¤šæ¬¡å†³ç­–å’Œå¤šä¸ªå†³ç­–ç‚¹ï¼Œåœ¨æ¯ä¸€ä¸ªé˜¶æ®µçš„æ¯ä¸€ä¸ªçŠ¶æ€ä¸­éƒ½éœ€è¦æœ‰ä¸€æ¬¡å†³ç­–ï¼Œ
å†³ç­–ä¹Ÿå¯ä»¥ç”¨å˜é‡æ¥æè¿°ï¼Œç§°è¿™ç§å˜é‡ä¸ºå†³ç­–å˜é‡ã€‚
åœ¨å®é™…é—®é¢˜ä¸­ï¼Œå†³ç­–å˜é‡çš„å–å€¼å¾€å¾€é™åˆ¶åœ¨æŸä¸€ä¸ªèŒƒå›´ä¹‹å†…ï¼Œæ­¤èŒƒå›´å°±ç§°ä¸ºå†³ç­–å…è®¸é›†åˆã€‚
4.ç­–ç•¥å’Œæœ€ä¼˜ç­–ç•¥
æ‰€æœ‰é˜¶æ®µä¸€æ¬¡æ’åˆ—æ„æˆé—®é¢˜çš„å…¨è¿‡ç¨‹ã€‚
å…¨è¿‡ç¨‹ä¸­å„é˜¶æ®µå†³ç­–å˜é‡æ‰€ç»„æˆçš„æœ‰åºæ€»ä½“ç§°ä¸ºç­–ç•¥ã€‚
åœ¨å®é™…é—®é¢˜ä¸­ï¼Œä»å†³ç­–å…è®¸é›†åˆä¸­æ‰¾å‡ºæœ€ä¼˜æ•ˆæœçš„ç­–ç•¥ç§°ä¸ºæœ€ä¼˜ç­–ç•¥ã€‚
5.çŠ¶æ€è½¬ç§»æ–¹ç¨‹
å‰ä¸€é˜¶æ®µçš„ç»ˆç‚¹å°±æ˜¯åä¸€é˜¶æ®µçš„èµ·ç‚¹ï¼Œå¯¹å‰ä¸€é˜¶æ®µçš„çŠ¶æ€åšå‡ºæŸç§å†³ç­–ï¼Œäº§ç”Ÿåä¸€ç§é˜¶æ®µçš„çŠ¶æ€ï¼Œè¿™ç§å…³ç³»æè¿°äº†ä» i
é˜¶æ®µåˆ° i+1 é˜¶æ®µçŠ¶æ€çš„æ¼”å˜è§„å¾‹ï¼Œç§°ä¸ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚
ä» n ä¸ªæ•°ä¸­å–å‡º k ä¸ªæ•°ï¼Œä½¿å¾—ä»–ä»¬çš„å’Œæœ€å¤§ã€‚
f[i][j] è¡¨ç¤ºç°åœ¨è€ƒè™‘åˆ°äº†ç¬¬ i ä¸ªæ•°ï¼Œå·²ç»é€‰å‡ºäº† j ä¸ªæ•°ã€‚
é˜¶æ®µï¼šæšä¸¾åˆ°ç¬¬iä¸ªæ•°
çŠ¶æ€ï¼šå·²ç»é€‰å‡ºäº† j ä¸ªæ•°ã€‚
å†³ç­–ï¼šç¬¬iä¸ªæ•°é€‰æˆ–ä¸é€‰
ç­–ç•¥ï¼šå’Œæœ€å¤§
çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼šf[i][j]=max(f[i-1][j],f[i-1][j-1]+a[i])
åŠ¨æ€è§„åˆ’çš„æ€§è´¨
ä»€ä¹ˆæ ·çš„â€œå¤šé˜¶æ®µå†³ç­–é—®é¢˜â€æ‰å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’çš„æ–¹æ³•æ¥æ±‚è§£å‘¢ï¼Ÿ


å¯¹äºä¸èƒ½åˆ’åˆ†é˜¶æ®µçš„é¢˜ï¼Œä¸èƒ½ç”¨åŠ¨æ€è§„åˆ’æ¥è§£ã€‚
ä¸ç¬¦åˆæœ€ä¼˜åŒ–åŸç†ï¼Œä¸èƒ½ç”¨åŠ¨æ€è§„åˆ’æ¥è§£ã€‚
ä¸å…·å¤‡æ— åæ•ˆæ€§åŸåˆ™çš„ï¼Œä¸èƒ½ç”¨åŠ¨æ€è§„åˆ’æ¥è§£ã€‚
è¯¯ç”¨åŠ¨æ€è§„åˆ’è§£å†³é—®é¢˜ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœ
åŠ¨æ€è§„åˆ’è®¾è®¡æ–¹æ³•
æ­£æ¨ï¼šä»åˆå§‹çŠ¶æ€å¼€å§‹ï¼Œé€šè¿‡å¯¹ä¸­é—´é˜¶æ®µçš„å†³ç­–çš„é€‰æ‹©ï¼Œè¾¾åˆ°ç»“æŸçŠ¶æ€ã€‚æˆ‘ä»¬ä¹Ÿç§°é€’æ¨ã€‚
å€’æ¨ï¼šä»ç»“æŸçŠ¶æ€å¼€å§‹ï¼Œé€šè¿‡å¯¹ä¸­é—´é˜¶æ®µçš„å†³ç­–çš„é€‰æ‹©ï¼Œè¾¾åˆ°å¼€å§‹çŠ¶æ€ã€‚æˆ‘ä»¬å¯ä»¥æŠŠè¿™ç§æ–¹æ³•çœ‹æˆè®°å¿†åŒ–æœç´¢ã€‚
åŠ¨æ€è§„åˆ’è®¾è®¡æ–¹æ³•çš„ä¸€èˆ¬æ¨¡å¼

åˆ’åˆ†é˜¶æ®µ
ç¡®å®šçŠ¶æ€å’ŒçŠ¶æ€å˜é‡
ç¡®å®šå†³ç­–å¹¶å†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹
å¯»æ‰¾è¾¹ç•Œæ¡ä»¶
è®¾è®¡å¹¶å®ç°ç¨‹åº

åŠ¨æ€è§„åˆ’ä¸è®°å¿†åŒ–æœç´¢
å®ç°ä¸€ä¸ªå‡½æ•°ï¼Œç”¨â€œæœç´¢â€çš„æ–¹æ³•å®ç° DP çš„æ›´æ–°ã€‚
é€šå¸¸ç”¨äºè§£å†³è½¬ç§»é¡ºåºä¸æ–¹ä¾¿äººä¸ºç¡®å®šçš„ DPã€‚
æ•°å­—ä¸‰è§’å½¢
5
7
3 8
8 1 0
2 7 4 4
4 5 2 6 5
è®¾ f[i][j] è¡¨ç¤ºèµ°åˆ°äº†ç¬¬ i è¡Œç¬¬ j åˆ—çš„æœ€å¤§å€¼ã€‚
æ­£å¸¸ DPï¼š
f[i][j] = max(f[i â€“ 1][j], f[i â€“ 1][j â€“ 1]) + a[i][j]
æœç´¢ï¼š
int dp(int i, int j)
{
if (i == 0) return 0;
    return a[i][j] + max(dp(i - 1, j), dp(i - 1, j - 1));
}

è¿™æ ·æœ‰å¾ˆå¤šçŠ¶æ€å…¶å®ä¼šé‡å¤è®¡ç®—ã€‚
å¯¹äºè®¡ç®—è¿‡çš„ dp(i, j)ï¼Œæˆ‘ä»¬ç”¨ f[i][j] æ¥å­˜ã€‚
f åˆå§‹åŒ–ä¸º -1
è®°å¿†åŒ–æœç´¢ï¼š
int dp(int i, int j){
    if (i == 0) return 0;
    if (f[i][j] &amp;gt;= 0) return f[i][j];
    f[i][j] = a[i][j] + max(dp(i - 1, j), dp(i - 1, j - 1));
    return f[i][j];
}

acwing901
ä¸€ä¸ªäººå¯ä»¥ä»æŸä¸ªç‚¹æ»‘å‘ä¸Šä¸‹å·¦å³ç›¸é‚»å››ä¸ªç‚¹ä¹‹ä¸€ï¼Œå½“ä¸”ä»…å½“é«˜åº¦å‡å°ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=310;
int h[N][N];
int f[N][N];
int n,m;
int dx[4]={-1,0,1,0},dy[4]={0,-1,0,1};

int dp(int x,int y)
{
    if(f[x][y]!=-1)
        return f[x][y];
    
    f[x][y]=1;
    for(int i=0;i&amp;lt;4;i++)
    {
        int a=x+dx[i],b=y+dy[i];
        if(a&amp;gt;=1 &amp;amp;&amp;amp; a&amp;lt;=n &amp;amp;&amp;amp; b&amp;gt;=1 &amp;amp;&amp;amp; b&amp;lt;=m &amp;amp;&amp;amp; h[x][y]&amp;gt;h[a][b])
            f[x][y]=max(f[x][y],dp(a,b)+1);
    }
    return f[x][y];
}

int main()
{
    scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;n,&amp;amp;m);
    for(int i=1;i&amp;lt;=n;i++)
        for(int j=1;j&amp;lt;=m;j++)
            scanf(&amp;quot;%d&amp;quot;,&amp;amp;h[i][j]);
    memset(f,-1,sizeof f);
    
    int res=0;    
    for(int i=1;i&amp;lt;=n;i++)
        for(int j=1;j&amp;lt;=m;j++)
            res=max(res,dp(i,j));
    printf(&amp;quot;%d\n&amp;quot;,res);
    return 0;
}

çº¿æ€§æ¨¡å‹
è¿™é‡Œçš„çº¿æ€§æŒ‡çš„æ˜¯çŠ¶æ€çš„æ’å¸ƒæ˜¯å‘ˆçº¿æ€§çš„ã€‚

æœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜ã€‚
f[i] è¡¨ç¤ºä»¥ a[i] ç»“å°¾çš„æœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜ã€‚
è®¡ç®— f[i] çš„æ—¶å€™ï¼Œåªéœ€è¦å»è€ƒè™‘ f[1], f[2], â€¦, f[i-1] çœ‹æ˜¯å¦èƒ½å¤Ÿè½¬ç§»å³å¯ã€‚
f[i] = max{ f[j] + 1 | 1â‰¤j&amp;lt;i, a[j]&amp;lt;a[i] }

è´ªå¿ƒæ€æƒ³ï¼Œæ•°è¶Šå°å½¢æˆçš„æœ€é•¿ä¸Šå‡å­åºåˆ—é•¿åº¦å¯èƒ½è¶Šå¤§ã€‚
#include&amp;lt;cstdio&amp;gt;//æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼Œä¼˜åŒ–ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(nlogn)
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int maxn=100010;
int d[maxn];//d[]è¡¨ç¤ºä»æœ€é•¿ä¸Šå‡åºåˆ—çš„å…ƒç´ 
int a[maxn];

int main()
{
    int n;
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	for(int i=1;i&amp;lt;=n;i++)
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);
    int len=1;
    d[1]=a[1];
    for(int i=2;i&amp;lt;=n;i++)
	{
		if(a[i] &amp;gt; d[len])
            d[++len]=a[i];
        else//a[i]è¦†ç›–d[]ä¸­ç¬¬ä¸€ä¸ªå¤§äºa[i]çš„æ•° 
        	*lower_bound(d+1,d+len+1,a[i])=a[i];
    }
    printf(&amp;quot;%d\n&amp;quot;,len);
    return 0;
}

å¦‚æœé¢˜ç›®è¦æ±‚ä¸¥æ ¼é€’å¢ï¼Œåˆ™å¿…é¡»ç”¨lower_boundï¼Œå› ä¸ºè¦æ›¿æ¢æ‰ç›¸åŒçš„å…ƒç´ è€Œä¸æ˜¯å¢é•¿åºåˆ—ã€‚
å¦‚æœé¢˜ç›®è¦æ±‚æœ€é•¿ä¸ä¸‹é™å­åºåˆ—ï¼Œåˆ™å¿…é¡»ç”¨ upper_boundã€‚
poj3486
ä½ æƒ³ä¿è¯ n å¹´ä¸­ä½ éƒ½æœ‰ä¸€å°ç”µè„‘ï¼Œä¸€å¼€å§‹ä½ æœ‰ä¸€å°ã€‚
å¦‚æœä½ åœ¨ç¬¬ y (1â‰¤yâ‰¤n) å¹´è´­ä¹°äº†ä¸€å°ç”µè„‘ï¼Œé‚£ä¹ˆä½ éœ€è¦èŠ±è´¹ cçš„ä»£ä»·ã€‚
å¦‚æœä½ è¿™å°ç”µè„‘ä¸€ç›´ç”¨åˆ°äº†ç¬¬ z å¹´ï¼Œåœ¨ç¬¬ z å¹´åˆä¹°äº†ä¸€å°æ–°çš„ï¼Œæ‚¨éœ€è¦åœ¨æ‚¨æ‹¥æœ‰è¯¥è®¡ç®—æœºçš„æ¯ä¸€å¹´ä¸­æ”¯ä»˜ç»´æŠ¤æˆæœ¬mï¼ˆyï¼Œzï¼‰
ç»™å®š nï¼Œcï¼Œæ•°ç»„ mã€‚æ±‚æœ€å°èŠ±è´¹
é¦–å…ˆåˆ’åˆ†é˜¶æ®µã€‚
æ¯ä¸€å¹´å¯ä»¥åˆ’åˆ†ä¸ºä¸€ä¸ªé˜¶æ®µã€‚
f[i] è¡¨ç¤ºç›´åˆ°ç¬¬ i å¹´f[0], f[1],â€¦,f[i-1]ä½ æ‰‹é‡Œéƒ½æœ‰ä¸€å°ç”µè„‘çš„æœ€å°èŠ±è´¹ã€‚
f[i] éœ€è¦ä» è½¬ç§»è¿‡æ¥ã€‚
å¦‚ä½•è½¬ç§»ï¼Ÿ
æšä¸¾ä¸Šä¸€æ¬¡ä¹°ç”µè„‘æ˜¯å“ªä¸€å¹´
å‡è®¾ä¸Šä¸€æ¬¡ä¹°ç”µè„‘æ˜¯ç¬¬ j å¹´ã€‚
é‚£ä¹ˆ1~j-1å¹´å°±æ˜¯ä¸€ä¸ªå­é—®é¢˜ï¼Œæˆ‘ä»¬å·²ç»ç®—å‡ºäº† f[j-1] æ˜¯æ»¡è¶³
è¿™ä¸ªå­é—®é¢˜çš„æœ€ä¼˜è§£ï¼Œåé¢æˆ‘ä»¬å°±ä¸ç”¨è€ƒè™‘å‰ j-1å¹´çš„æƒ…å†µï¼Œ
ä¸”å®ƒä¹Ÿä¸ä¼šå½±å“æˆ‘ä»¬åé¢çš„å†³ç­–ã€‚
ç¬¬ j å¹´åˆ°ç¬¬ i å¹´çš„ç»´ä¿®è´¹ç”¨æ˜¯ m(j, i)ï¼ŒèŠ±è´¹æ˜¯ c
å› æ­¤å¯ä»¥ç”¨ f[j-1]+m(j,i)+c æ¥æ›´æ–° f[i]
f[i] = min{ f[j-1]+m(j,i) + c | 1â‰¤jâ‰¤i }
è¾¹ç•Œæ¡ä»¶ï¼š
f[0] = 0
f[1], f[2], â€¦, f[n] ä¸€å¼€å§‹éƒ½åº”è¯¥åˆå§‹åŒ–ä¸º +âˆ
code
acwing278

hdu1003

#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int maxn=100005;
int a[maxn],dp[maxn];//dp[i]è¡¨ç¤ºä»startå¼€å§‹åˆ°ç¬¬iä¸ªå…ƒç´ çš„æœ€å¤§å­æ®µå’Œ 
int main()
{
	int t,n,cas=0;
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;t);
	while(t--)
	{
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
		for(int i=1;i&amp;lt;=n;i++)
			scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);//ä¹Ÿå¯ä»¥çœç•¥åŸæ•°ç»„ï¼Œç›´æ¥ç”¨dp[] 
		int l=1,r=1;//è®°å½•åŒºé—´
		int start=1;//è®°å½•èµ·ç‚¹
		dp[1]=a[1];
		
		int ans=dp[1];
		for(int i=2;i&amp;lt;=n;i++)
		{
            if(dp[i-1]&amp;gt;=0)//dp[i-1]å¤§äºç­‰äº0ï¼Œåˆ™ç´¯åŠ ï¼Œå¦åˆ™é‡æ–°å¼€å§‹ 
                dp[i]=dp[i-1]+a[i];
            else
            {
            	dp[i]=a[i];
            	start=i;//é‡æ–°å¼€å§‹
			}	
            if(dp[i]&amp;gt;ans)//æ›´æ–°æœ€å€¼
            {
            	ans=dp[i];
				l=start;
         	    r=i;
            }
		}
		if(cas)
			printf(&amp;quot;\n&amp;quot;);
		printf(&amp;quot;Case %d:\n&amp;quot;,++cas);
		printf(&amp;quot;%d %d %d\n&amp;quot;,ans,l,r);
	}
	return 0;
}

poj2479




å› ä¸ºæˆ‘ä»¬ä¼šä»å·¦åˆ°å³æšä¸¾æ¯ä¸€ä¸ªlt[i],å½“ç„¶æ›´æ–°ä¸€élt[i]ä¹Ÿæ²¡æœ‰é”™ã€‚
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int maxn=50010;
const int inf=0x3f3f3f3f;
int lt[maxn],rt[maxn];//lt[i]è¡¨ç¤ºä»å·¦ç«¯å¼€å§‹ï¼Œä»¥iç»“å°¾çš„å­æ®µå’Œæœ€å¤§å€¼ 
int a[maxn];
 
int main()
{
	int t,n;
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;t);
	while(t--)
	{
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
		for(int i=1;i&amp;lt;=n;i++)
			scanf(&amp;quot;%d&amp;quot;,&amp;amp;a[i]);
		lt[1]=a[1];
		for(int i=2;i&amp;lt;=n;i++)//ä»å·¦å‘å³ 
			lt[i]=max(a[i],lt[i-1]+a[i]);
		rt[n]=a[n];
		for(int i=n-1;i&amp;gt;=1;i--)//ä»å³å‘å·¦
			rt[i]=max(a[i],rt[i+1]+a[i]); 
		for(int i=n-1;i&amp;gt;=1;i--)//æ›´æ–°ä¸ºä»å³ç«¯å¼€å§‹n..iä¸ªå…ƒç´ ä¹‹ä¸­æœ€å¤§è¿ç»­å­æ®µå’Œ 
			rt[i]=max(rt[i+1],rt[i]);
		int ans=-inf;
		for(int i=2;i&amp;lt;=n;i++)
			ans=max(ans,lt[i-1]+rt[i]);
		printf(&amp;quot;%d\n&amp;quot;,ans);
	}
	return 0;
}

poj2250

code

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/xian-xing-dp/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/zi-fu-chuan-fu-xi-yi/">
                        å­—ç¬¦ä¸²å¤ä¹ ï¼ˆä¸€ï¼‰
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-26</time>
                    
                        <a href="https://caifxh.github.io/tag/yImqvC-Dp/" class="post-tag i-tag
                            i-tag-error">
            #å­—ç¬¦ä¸²
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            å“ˆå¸Œè¡¨
å¦‚æœè¦å‚¨å­˜å’Œä½¿ç”¨çº¿æ€§è¡¨ï¼ˆ1ï¼Œ75ï¼Œ324ï¼Œ43ï¼Œ1353ï¼Œ90ï¼Œ46ï¼‰ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ä¸€ä¸ªæ•°ç»„ A[1..7] æ¥é¡ºåºå­˜å‚¨è¿™äº›æ•°ã€‚
ä½†æ˜¯è¿™æ ·çš„å­˜å‚¨ç»“æ„ä¼šç»™æŸ¥è¯¢ç®—æ³•å¸¦æ¥ O(n) çš„æ—¶é—´å¼€é”€ã€‚
å¯¹ A æ’åºï¼Œä½¿ç”¨äºŒåˆ†æŸ¥è¯¢æ³•ï¼Œæ—¶é—´å¤æ‚åº¦å˜ä¸º O(log n)ä¹Ÿå¯ä»¥ç”¨ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ï¼Œç”¨æ•°ç»„ A[1..1353] æ¥è¡¨ç¤ºæ¯ä¸ªæ•°æ˜¯å¦å‡ºç°ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦å˜ä¸º O(1)ï¼Œä½†æ˜¯ç©ºé—´ä¸Šçš„å¼€é”€å˜å¾—å·¨å¤§ã€‚
ä¼˜åŒ–ä¸Šä¸€ç§åšæ³•ï¼Œå»ºç«‹ä¸€ä¸ªå“ˆå¸Œå‡½æ•° h(key) = key % 23.(1, 75, 324, 43, 1353, 90) -&amp;gt; (1, 6, 2, 20, 19, 21, 0)
æˆ‘ä»¬åªè¦ç”¨ä¸€ä¸ª A[0..22] æ•°ç»„å°±å¯ä»¥å¿«é€Ÿçš„æŸ¥è¯¢æ¯ä¸ªæ•°æ˜¯å¦å‡ºç°ã€‚
è¿™ç§çº¿æ€§è¡¨çš„ç»“æ„å°±ç§°ä¸ºå“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰ã€‚
å¯ä»¥çœ‹å‡ºï¼Œå“ˆå¸Œè¡¨çš„åŸºæœ¬åŸç†æ˜¯ç”¨ä¸€ä¸ªä¸‹æ ‡èŒƒå›´æ¯”è¾ƒå¤§çš„æ•°ç»„ A æ¥å­˜å‚¨å…ƒç´ ã€‚
è®¾è®¡ä¸€ä¸ªå‡½æ•° hï¼Œå¯¹äºè¦å­˜å‚¨çš„çº¿æ€§è¡¨çš„æ¯ä¸ªå…ƒç´  nodeï¼Œå–ä¸€ä¸ªå…³é”®å­— keyï¼Œç®—å‡ºå‡½æ•°å€¼ h(key) ç„¶åæŠŠè¿™ä¸ªå€¼ä½œä¸ºä¸‹æ ‡ï¼Œç”¨ A[h(key)] æ¥å­˜å‚¨ nodeã€‚
æœ€å¸¸è§çš„ h å°±æ˜¯æ¨¡å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é€‰å®šä¸€ä¸ª mï¼Œä»¤ h(key) =key % m.
ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯èƒ½å­˜åœ¨ä¸¤ä¸ª key: k1, k2 ä½¿å¾—h(k1)=h(k2)ï¼Œè¿™æ—¶ä¹Ÿç§°äº§ç”Ÿäº†â€œå†²çªâ€ã€‚
è§£å†³å†²çªæœ‰å¾ˆå¤šç§åŠæ³•ï¼š
1.å¼€æ”¾å¯»å€æ³•
2.æ‹‰é“¾æ³•ï¼šå¯ä»¥è®© A çš„æ¯ä¸ªå…ƒç´ éƒ½å­˜ä¸€ä¸ªé“¾è¡¨ï¼Œå¯¹äº
h(k1)=h(k2)ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸¤ä¸ª node éƒ½æ¥åœ¨ A[h(k1)]
çš„é“¾è¡¨ä¸Š
å‡è®¾æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•è§£å†³å†²çªã€‚
å¯¹äºæ’å…¥å…ƒç´ (node, key)ï¼š

è®¡ç®— h(key)ï¼ŒæŠŠ node æ’å…¥ A[h(key)] é“¾è¡¨ã€‚

å¯¹äºæŸ¥è¯¢å…ƒç´ (node, key)ï¼š

è®¡ç®— h(key)ï¼Œå¦‚æœ A[h(key)] ä¸ºç©ºï¼Œè¯´æ˜ node ä¸å­˜åœ¨ã€‚
å¦åˆ™éå† A[h(key)] é“¾è¡¨ï¼Œå¯»æ‰¾ nodeã€‚

æ¨¡æ¿é¢˜
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=100003;
int h[N],e[N],ne[N],idx;

void insert(int x)
{
    int k=(x%N+N)%N;
    e[idx]=x;
    ne[idx]=h[k];
    h[k]=idx++;
}

bool find(int x)
{
    int k=(x%N+N)%N;
    for(int i=h[k];i!=-1;i=ne[i])
    {
        if(e[i]==x)
            return true;
    }
    return false;
}

int main()
{
    int n;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    memset(h,-1,sizeof(h));
    while(n--)
    {
        char op[2];
        int x;
        scanf(&amp;quot;%s%d&amp;quot;,op,&amp;amp;x);

        if(*op==&#39;I&#39;)
            insert(x);
        else
        {
            if(find(x))
                puts(&amp;quot;Yes&amp;quot;);
            else
                puts(&amp;quot;No&amp;quot;);
        }
    }
    return 0;
}

ä¾‹é¢˜
å·²çŸ¥ X[1..4] æ˜¯ [-T, T] ä¸­çš„æ•´æ•°ï¼Œæ±‚å‡ºæ»¡è¶³æ–¹ç¨‹AX[1]+BX[2]+CX[3]+DX[4] = Pçš„è§£æœ‰å¤šå°‘ç»„ï¼Ÿ
|P|â‰¤1e9ï¼Œ|A|,|B|,|C|,|D|â‰¤1e4ï¼ŒTâ‰¤500
æœ€ç›´è§‚çš„æ–¹æ³•æšä¸¾ X[1..4], æ—¶é—´å¤æ‚åº¦ O(n4n^4n4)
é€‚å½“ä¼˜åŒ–ï¼Œæšä¸¾äº†X[1..3] ä¹‹åï¼Œå®é™…ä¸Š X[4] å·²ç»ç¡®å®šäº†ï¼Œæ—¶é—´å¤æ‚åº¦ O(n3n^3n3)
ç»§ç»­ä¼˜åŒ–ï¼Œé‡‡ç”¨ meet in the middle ç­–ç•¥ï¼š
ä¸€è¾¹æšä¸¾ X[1], X[2]
ä¸€è¾¹æšä¸¾ X[4], X[3]
ç„¶åçœ‹æœ‰å“ªäº›æ–¹æ¡ˆå¯ä»¥ç»„æˆæ–¹ç¨‹çš„è§£
æšä¸¾ X[1], X[2], ç„¶åç®—å‡º P-AX[1]-BX[2],æŠŠè¿™ä¸ªå€¼å­˜å…¥ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œæ³¨æ„è¦ç»Ÿè®¡æ¬¡æ•°ã€‚
è¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ O(n2n^2n2)
ç„¶åæšä¸¾ X[3], X[4], ç®—å‡º CX[3]+DX[4],å»å“ˆå¸Œè¡¨é‡ŒæŸ¥æ‰¾è¿™ä¸ªå€¼å‡ºç°äº†å‡ æ¬¡ã€‚
æŠŠæ¬¡æ•°åŠ è¿›ç­”æ¡ˆï¼Œè¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ O(n2n^2n2)
å› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n2n^2n2)
å­—ç¬¦ä¸²å“ˆå¸Œ
å‡è®¾æœ‰ n ä¸ªé•¿åº¦ä¸º L çš„å­—ç¬¦ä¸²ï¼Œé—®å…¶ä¸­æœ€å¤šæœ‰å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ç›¸ç­‰çš„ã€‚
ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªé•¿åº¦ä¸º L çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰æ—¶é—´å¤æ‚åº¦æ˜¯O(L) çš„ã€‚
å› æ­¤éœ€è¦æšä¸¾ O(n2) å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œæ—¶é—´å¤æ‚åº¦ O(n2Ln^2Ln2L)
å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸ªå­—ç¬¦ä¸²éƒ½ç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°æ˜ å°„æˆä¸€ä¸ªæ•´æ•°ã€‚
é—®é¢˜å°±å˜æˆäº†æŸ¥æ‰¾ä¸€ä¸ªåºåˆ—çš„ä¼—æ•°ã€‚
æ—¶é—´å¤æ‚åº¦å˜ä¸ºäº† O(nL)
ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„å­—ç¬¦ä¸²å“ˆå¸Œå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬å…ˆç”¨ O(L) çš„æ—¶é—´å¤æ‚åº¦é¢„å¤„ç†ï¼Œä¹‹åæ¯æ¬¡è·å–è¿™ä¸ªå­—ç¬¦ä¸²çš„ä¸€ä¸ªå­ä¸²çš„å“ˆå¸Œå€¼éƒ½åªè¦ O(1) çš„æ—¶é—´ã€‚
BKDRHash çš„åŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å½“åšä¸€ä¸ª k è¿›åˆ¶æ•°æ¥å¤„ç†
å‡è®¾å­—ç¬¦ä¸² s çš„ä¸‹æ ‡ä» 1 å¼€å§‹ï¼Œé•¿åº¦ä¸º n
ha[0] = 0;
    for (int i = 1;i &amp;lt;= n;i ++)
        ha[i] = (ha[i - 1] * P + str[i]) % M;

æˆ‘ä»¬çŸ¥é“ ha[i] å°±æ˜¯ s[1..i] çš„ BKDRHash
é‚£ä¹ˆç°åœ¨è¯¢é—® s[x..y] çš„ BKDRHash ï¼Œ

å› æ­¤æˆ‘ä»¬é¢„å¤„ç†å‡º ha æ•°ç»„å’Œ k çš„å¹‚æ¬¡ï¼Œæ¯æ¬¡è¯¢é—® s[x..y]çš„å“ˆå¸Œå€¼ï¼Œåªè¦ O(1) çš„æ—¶é—´ã€‚
ç»éªŒå€¼ï¼Œk=131ï¼ŒM=2642^{64}264
æ¨¡æ¿é¢˜
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
typedef unsigned long long ULL;
const int N = 100010, P = 131;
int n, m;
char str[N];
ULL h[N], p[N];

ULL get(int l, int r)
{
    return h[r] - h[l - 1] * p[r - l + 1];
}

int main()
{
    scanf(&amp;quot;%d%d&amp;quot;, &amp;amp;n, &amp;amp;m);
    scanf(&amp;quot;%s&amp;quot;, str + 1);

    p[0] = 1;
    for (int i = 1; i &amp;lt;= n; i ++ )
    {
        h[i] = h[i - 1] * P + str[i];
        p[i] = p[i - 1] * P;
    }

    while (m -- )
    {
        int l1, r1, l2, r2;
        scanf(&amp;quot;%d%d%d%d&amp;quot;, &amp;amp;l1, &amp;amp;r1, &amp;amp;l2, &amp;amp;r2);

        if (get(l1, r1) == get(l2, r2)) puts(&amp;quot;Yes&amp;quot;);
        else puts(&amp;quot;No&amp;quot;);
    }

    return 0;
}

ä¾‹é¢˜
acwing160
æ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š
ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² Aï¼ŒBã€‚æ±‚å‡º A çš„æ¯ä¸ªåç¼€å­ä¸²å’Œ B çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚
æ ‡å‡†åšæ³•æ˜¯æ‰©å±• KMPï¼Œæ—¶é—´å¤æ‚åº¦çº¿æ€§ã€‚
æˆ‘ä»¬æ¥ç”¨ Hash è¯•è¯•çœ‹
å‰é¢å·²ç»æåˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ O(n)é¢„å¤„ç† O(1)å¤„ç†å‡ºä¸€ä¸ªå­ä¸²çš„å“ˆå¸Œå€¼ã€‚
æ±‚å­—ç¬¦ä¸² A[i..n] ä¸å­—ç¬¦ä¸² B[1..m] çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Ÿ
äºŒåˆ†é•¿åº¦ mid
è®¡ç®—å‡º A[i..i+mid-1] å’Œ B[1..mid] çš„å“ˆå¸Œå€¼ï¼Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚
å› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlog n) çš„
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
typedef unsigned long long ULL;
const int N = 200010, P = 131;
int n, m,q;
char a[N];
char b[N];
ULL ha[N],hb[N],p[N];
int cnt[N];

ULL get(ULL h[],int l, int r)
{
    return h[r] - h[l - 1] * p[r - l + 1];
}

int main()
{
    scanf(&amp;quot;%d%d%d&amp;quot;, &amp;amp;n, &amp;amp;m,&amp;amp;q);
    scanf(&amp;quot;%s&amp;quot;, a + 1);
    scanf(&amp;quot;%s&amp;quot;,b+1);

    p[0] = 1;
    for(int i=1;i&amp;lt;=max(n,m);i++)
        p[i]=p[i-1]*P;
    for(int i=1;i&amp;lt;=n;i++)
        ha[i]=ha[i-1]*P+a[i];
    for(int i=1;i&amp;lt;=m;i++)
        hb[i]=hb[i-1]*P+b[i];
    
    for(int i=1;i&amp;lt;=n;i++)
    {
        int l=0,r=min(m,n-i+1);

        while(l&amp;lt;r)
        {
            int mid=l+r+1&amp;gt;&amp;gt;1;
            if(get(ha,i,i+mid-1) == get(hb,1,mid))
                l=mid;
            else
                r=mid-1;
        }
        cnt[l]++;
    }
    while(q--)
    {
        int x;
        scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
        printf(&amp;quot;%d\n&amp;quot;,cnt[x]);
    }

    return 0;
}

poj2774
ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tï¼Œæ±‚å®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²ã€‚|S|, |T| â‰¤ 1e5
æ€è·¯
åŸå§‹çš„ DP åšæ³•ï¼ˆæœ€é•¿å…¬å…±å­åºåˆ—ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)
æˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆ lenã€‚ç„¶åè®¡ç®— S å’Œ T ä¸­æ‰€æœ‰é•¿åº¦ä¸º len çš„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚
è¿™ä¸€æ­¥æ˜¯ O(n) çš„ã€‚
ç„¶åæ¯”è¾ƒ S çš„å“ˆå¸Œå€¼é›†åˆä¸­å’Œ T çš„å“ˆå¸Œå€¼é›†åˆä¸­æœ‰æ²¡æœ‰ç›¸åŒçš„å…ƒç´ ã€‚
å¯ä»¥å†é€šè¿‡ä¸€æ­¥å“ˆå¸Œæ‰¾ç›¸åŒçš„å€¼ã€‚è¿™æ ·æ€»å…±ä»ç„¶æ˜¯ O(n)ã€‚
æ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n log n)
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;vector&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=100010,P=131;
char a[N],b[N];
typedef unsigned long long ULL;
ULL ha[N],hb[N],p[N];
vector&amp;lt;ULL&amp;gt; v;
int la,lb;

ULL get(ULL h[],int l,int r)
{
	return h[r]-h[l-1]*p[r-l+1];
}

bool check(int mid)
{
	v.clear();
	for(int i=mid;i&amp;lt;=la;i++)
		v.push_back(get(ha,i-mid+1,i));
	
	sort(v.begin(),v.end());
	for(int i=mid;i&amp;lt;=lb;i++)
	{
		ULL t=get(hb,i-mid+1,i);
		if(binary_search(v.begin(),v.end(),t))
			return true;
	}
	return false;
}

int main()
{
	scanf(&amp;quot;%s%s&amp;quot;,a+1,b+1);
	la=strlen(a+1);
	lb=strlen(b+1);
	
	p[0]=1;
	for(int i=1;i&amp;lt;=max(la,lb);i++)
		p[i]=p[i-1]*P;
	for(int i=1;i&amp;lt;=la;i++)
		ha[i]=ha[i-1]*P+a[i];
	for(int i=1;i&amp;lt;=lb;i++)
		hb[i]=hb[i-1]*P+b[i];
		
	int l=0,r=1e5;
	while(l&amp;lt;r)
	{
		int mid=l+r+1&amp;gt;&amp;gt;1;
		if(check(mid))
			l=mid;
		else
			r=mid-1;
	}
	printf(&amp;quot;%d\n&amp;quot;,l);
	return 0;
}

ä¹Ÿå¯æ‰‹å†™å“ˆå¸Œè¡¨ï¼šä»£ç 
Codeforces 580E
ç»™å‡ºä¸€ä¸ªæ•°å­—ä¸²ï¼Œç°åœ¨æœ‰ä¸¤ç§æ“ä½œï¼š
1: l r d: å°†[l,r] ä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ”¹ä¸º d
2: l r dï¼šè¯¢é—®[l,r]è¿™ä¸ªå­ä¸²çš„å‘¨æœŸæ˜¯å¦ä¸º dã€‚ 1 &amp;lt;= n &amp;lt;= 1e5
é¦–å…ˆæ€è€ƒå¯¹äºä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œå¦‚ä½•åˆ¤æ–­å®ƒçš„å‘¨æœŸæ˜¯ä¸æ˜¯ dï¼Ÿ
æ¯”å¦‚ä¸² ababab çš„å‘¨æœŸæ˜¯ 2 ä¸² abcabc çš„å‘¨æœŸæ˜¯ 3 ä¸² abcde çš„å‘¨æœŸæ˜¯ 5
å‡è®¾ S çš„é•¿åº¦ä¸º nã€‚
åªè¦åˆ¤æ–­ S[1..n-d+1] å’Œ S[d+1..n]æ˜¯å¦ç›¸ç­‰å³å¯ã€‚


#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
#define lc u&amp;lt;&amp;lt;1
#define rc u&amp;lt;&amp;lt;1|1
int n,m,k;
const int N=100010,P=131,mod=1e9+7;
char s[N];
typedef long long LL;
struct Node
{
	int l,r;
	int tag;
	LL key;
}tr[N&amp;lt;&amp;lt;2];
LL h[N],p[N];//p[i]è¡¨ç¤ºpçš„iæ¬¡æ–¹ï¼Œh[i]è¡¨ç¤ºè¿ç»­iä¸ª1çš„å­—ç¬¦ä¸²çš„hashå€¼

void pushup(int u,int k)
{
	tr[u].key=((tr[lc].key*p[k])%mod+tr[rc].key)%mod;
}

void pushdown(int u)
{
	if(tr[u].tag)
	{
		int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1,l=tr[u].l,r=tr[u].r;
		tr[lc].key=(tr[u].tag*h[mid-l+1])%mod;
		tr[lc].tag=tr[u].tag;
		tr[rc].key=(tr[u].tag*h[r-mid])%mod;
		tr[rc].tag=tr[u].tag;
		tr[u].tag=0;
	}
}

void build(int u,int l,int r)
{
	if(l == r)
	{
		tr[u]={l,r,0,s[l]-&#39;0&#39;+1};
		return;
	}
	tr[u]={l,r};
	int mid=l+r&amp;gt;&amp;gt;1;
	build(lc,l,mid);
	build(rc,mid+1,r);
	pushup(u,r-mid);
}

void modify(int u,int l,int r,int d)
{
	if(l &amp;lt;= tr[u].l &amp;amp;&amp;amp; tr[u].r &amp;lt;= r)
	{
		tr[u].key=(d*h[tr[u].r-tr[u].l+1])%mod;
		//cout&amp;lt;&amp;lt;&amp;quot;-----&amp;quot;&amp;lt;&amp;lt;u&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].key&amp;lt;&amp;lt;endl;
		tr[u].tag=d;
		return;
	}
	pushdown(u);
	int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1;
	if(l &amp;lt;= mid)
		modify(lc,l,r,d);
	if(r &amp;gt; mid)
		modify(rc,l,r,d);
	pushup(u,tr[u].r-mid);
}

int query(int u,int l,int r)
{
	if(tr[u].l == l &amp;amp;&amp;amp; tr[u].r == r)
		return tr[u].key;
	pushdown(u);
	int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1;
	if(r&amp;lt;=mid)
		return query(lc,l,r);
	else if(l&amp;gt;mid)
		return query(rc,l,r);
	else 
		return (query(lc,l,mid)*p[r-mid]%mod+query(rc,mid+1,r))%mod;
}

void print(int u)
{
	if(tr[u].key)
	{
		cout&amp;lt;&amp;lt;&amp;quot;--&amp;quot;&amp;lt;&amp;lt;u&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].l&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].r&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].key&amp;lt;&amp;lt;endl;
		print(lc);
		print(rc);
	}
}

int main()
{
	scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;m,&amp;amp;k);
	scanf(&amp;quot;%s&amp;quot;,s+1);
	
	p[0]=1;
	for(int i=1;i&amp;lt;=n;i++)
	{
		h[i]=(h[i-1]*P%mod+1)%mod;
		p[i]=p[i-1]*P%mod;
	}

	build(1,1,n);
	
	m+=k;
	while(m--)
	{
		int t,l,r,d;
		scanf(&amp;quot;%d%d%d%d&amp;quot;,&amp;amp;t,&amp;amp;l,&amp;amp;r,&amp;amp;d);
		if(t == 1)
			modify(1,l,r,d+1);//åŠ ä¸€å¤„ç†ï¼Œé˜²æ­¢dä¸º0
		else
		{
			if(d == r - l + 1)
			{
                printf(&amp;quot;YES\n&amp;quot;);
                continue;
            }
			if(query(1,l,r-d) == query(1,l+d,r))
				puts(&amp;quot;YES&amp;quot;);
			else
				puts(&amp;quot;NO&amp;quot;);
		}
		//print(1);
	}
	return 0;
}

å‘ï¼šç¬¬75ç»„æ•°ç»„å¡æ— ç¬¦å·64ä½è‡ªåŠ¨æº¢å‡ºçš„hash,é˜²ullæº¢å‡ºçš„è§£å†³æ–¹æ³•æ˜¯å–æ¨¡
Codeforces 955D
ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tã€‚ä½ éœ€è¦åœ¨ S ä¸­é€‰å‡ºä¸¤ä¸ªä¸ç›¸äº¤çš„é•¿åº¦ä¸º k çš„å­ä¸²ï¼Œä½¿å¾—ä»–ä»¬æ‹¼èµ·æ¥ä¹‹ååŒ…å« Tã€‚
|T| â‰¤ 2k â‰¤ |S| â‰¤ 5Â·1e5

æ ·ä¾‹ï¼š ï¼ˆç­”æ¡ˆï¼šYes 1 5ï¼‰
7 4 3
baabaab
aaaa
KMP


æˆ‘ä»¬ç”¨å½¢å¼åŒ–çš„è¯­è¨€æ¥è¿›è¡Œæè¿°ã€‚
å‡è®¾ç°åœ¨ T[s+1..s+k] å’Œ P[1..k] åŒ¹é…ä¸Šäº†ã€‚
æ­¤æ—¶ T[s+k+1] != P[k+1]ã€‚
æœ´ç´ çš„åšæ³•æ˜¯ï¼šå›åˆ° T[s + 2] å’Œ P[1] é‡æ–°å¼€å§‹æ¯”è¾ƒã€‚
KMPç®—æ³•ï¼šæ‰¾åˆ°ä¸€ä¸ªæœ€å¤§çš„ xï¼Œä½¿å¾— T[s+1..s+k] çš„å xä¸ªå­—ç¬¦ï¼Œå’Œ P çš„å‰ x ä¸ªå­—ç¬¦ç›¸åŒã€‚
è¿™éƒ¨åˆ†å°±æ˜¯èƒ½åŒ¹é…ä¸Šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨é€ä¸ªåˆ¤æ–­ã€‚
åˆæ³¨æ„åˆ° T[s+1..s+k] = P[1..k]
é‚£ä¹ˆæˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯ä¸€ä¸ªæœ€å¤§çš„ xï¼Œæ»¡è¶³ P[1..k] çš„å‰ xä¸ªå­—ç¬¦ç­‰äºå®ƒçš„å x ä¸ªå­—ç¬¦ã€‚å½“ç„¶ x è¦å°äº kã€‚
è¿™ä¸ª x è®°ä¸º next[k]
å¯¹äº P = ababaca
æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºnextæ•°ç»„ï¼š

æœ‰äº† next æ•°ç»„ï¼Œç°åœ¨å¦‚ä½•åŒ¹é…ä¸¤ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿ
for (int i = 1, j = 0; i &amp;lt;= m; i ++ )
{
    while (j &amp;amp;&amp;amp; s[i] != p[j + 1]) j = ne[j];
    if (s[i] == p[j + 1]) j ++ ;
    if (j == n)
    {
        printf(&amp;quot;%d &amp;quot;, i - n);
        j = ne[j];
    }
}


è®²è¿‡å¦‚ä½•åŒ¹é…ä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦ä¼šé«˜æ•ˆè®¡ç®— next æ•°ç»„ã€‚
è®¡ç®— next æ•°ç»„çš„è¿‡ç¨‹å°±æ˜¯æ‹¿ P å’Œ P è‡ªå·±åŒ¹é…çš„è¿‡ç¨‹ã€‚
åªä¸è¿‡è¦åœ¨åŒ¹é…çš„è¿‡ç¨‹ä¸­ï¼Œè®°å½•æ¯ä¸ªä½ç½®ä¸‹æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ï¼Œä½œä¸º next æ•°ç»„ã€‚
for (int i = 2, j = 0; i &amp;lt;= n; i ++ )
{
    while (j &amp;amp;&amp;amp; p[i] != p[j + 1]) j = ne[j];
    if (p[i] == p[j + 1]) j ++ ;
    ne[i] = j;
}

KMPç®—æ³•å¤æ‚åº¦
æ—¶é—´å¤æ‚åº¦ï¼šO(n)
ç©ºé—´å¤æ‚åº¦ï¼šO(n)
ä¾‹é¢˜
poj2406
ç»™ä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œæ±‚ S çš„ä¸€ä¸ªæœ€çŸ­çš„å¾ªç¯èŠ‚ eï¼Œä½¿å¾— S å¯ä»¥å†™æˆ eeeâ€¦eee ï¼ˆå…±|S|/|e|ä¸ª eï¼‰
è¾“å‡º |S|/|e| çš„æœ€å¤§å€¼ã€‚|S| â‰¤ 1e6

æ ·ä¾‹ï¼š
abcd ï¼ˆç­”æ¡ˆï¼š1ï¼‰
aaaa ï¼ˆç­”æ¡ˆï¼š4ï¼‰
ababab ï¼ˆç­”æ¡ˆï¼š3ï¼‰
å‡è®¾è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸º len
å¦‚æœ len å¯ä»¥è¢« len-next[len] æ•´é™¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¯´len-next[len] æ˜¯é‚£ä¸ªå¾ªç¯èŠ‚çš„é•¿åº¦ã€‚
å› ä¸º next[len] å°±è¡¨ç¤º: S[1..next[len]] = S[next[len] + 1..len]
å¯ä»¥è¯æ˜æ»¡è¶³è¿™ä¸€æ¡æ€§è´¨çš„å­—ç¬¦ä¸²å…·æœ‰é•¿åº¦ä¸º len-next[len] çš„å¾ªç¯å‘¨æœŸ
å¦åˆ™ç­”æ¡ˆå°±æ˜¯ 1 äº†ã€‚
å› ä¸ºå¦‚æœå­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸º d çš„å¾ªç¯èŠ‚ï¼Œé‚£ä¸€å®šæ»¡è¶³ï¼š
S[1..len-d+1] == S[d + 1 .. len]
ä½†æ˜¯ç°åœ¨å¾ªç¯èŠ‚çš„é•¿åº¦åªèƒ½æ˜¯ len-next[len],å¦‚æœå®ƒä¸æ˜¯ len çš„å› å­ï¼Œé‚£å°±æ²¡æœ‰å¯èƒ½äº†ã€‚
æ—¶é—´å¤æ‚åº¦ O(n)

å®šç†ï¼šå‡è®¾Sçš„é•¿åº¦ä¸ºlenï¼Œåˆ™Så­˜åœ¨æœ€å°å¾ªç¯èŠ‚ï¼Œå¾ªç¯èŠ‚çš„é•¿åº¦Lä¸ºlen-next[len]ï¼Œå­ä¸²ä¸ºS[0â€¦len-next[len]-1]ã€‚
ï¼ˆ1ï¼‰å¦‚æœlenå¯ä»¥è¢«len - next[len]æ•´é™¤ï¼Œåˆ™è¡¨æ˜å­—ç¬¦ä¸²Så¯ä»¥å®Œå…¨ç”±å¾ªç¯èŠ‚å¾ªç¯ç»„æˆï¼Œå¾ªç¯å‘¨æœŸT=len/Lã€‚
ï¼ˆ2ï¼‰å¦‚æœä¸èƒ½ï¼Œè¯´æ˜è¿˜éœ€è¦å†æ·»åŠ å‡ ä¸ªå­—æ¯æ‰èƒ½è¡¥å…¨ã€‚éœ€è¦è¡¥çš„ä¸ªæ•°æ˜¯å¾ªç¯ä¸ªæ•°L-len%L=L-(len-L)%L=L-next[len]%Lï¼ŒL=len-next[len]ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=1e6+10;
char s[N];
int ne[N];
int n;

int main()
{
	while(scanf(&amp;quot;%s&amp;quot;,s+1))
	{
		if(s[1] == &#39;.&#39;)
			break;
		
		n=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
		
		int t=n-ne[n];
		if(n%t == 0)
			cout&amp;lt;&amp;lt;n/t&amp;lt;&amp;lt;endl;
		else
			cout&amp;lt;&amp;lt;1&amp;lt;&amp;lt;endl;
	}
	return 0;
}

poj2752
ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œæ±‚å‡º S ä¸­æ‰€æœ‰çš„æ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€çš„å­ä¸²ã€‚è¾“å‡º i ä»£è¡¨ S[1..i]|S| â‰¤ 400000

æ ·ä¾‹ï¼š
ababcababababcababï¼ˆç­”æ¡ˆï¼š2 4 9 18ï¼‰
aaaaaï¼ˆç­”æ¡ˆï¼š1 2 3 4 5ï¼‰
æ±‚å‡º next æ•°ç»„ã€‚
ç­”æ¡ˆå°±æ˜¯ len, next[len], next[next[len]], â€¦

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=4e5+10;
char s[N];
int ne[N];
int ans[N];

int main()
{
	while(~scanf(&amp;quot;%s&amp;quot;,s+1))
	{
		int n=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
	
		int t=ne[n],cnt=0;
		while(t)
		{
			ans[cnt++]=t;
			t=ne[t];
		}
		
		for(int i=cnt-1;i&amp;gt;=0;i--)
			printf(&amp;quot;%d &amp;quot;,ans[i]);
		printf(&amp;quot;%d\n&amp;quot;,n);

	}
	return 0;
}

hdu2594
æ±‚å‡ºæœ€é•¿çš„æ—¢æ˜¯ s1 çš„å‰ç¼€åˆæ˜¯ s2 çš„åç¼€çš„å­ä¸²ã€‚

æ ·ä¾‹ï¼š
riemann
marjorie
ç­”æ¡ˆï¼šrie
åªè¦æŠŠä¸¤ä¸ªä¸²æ‹¼èµ·æ¥ï¼Œä¸­é—´ç”¨ä¸€ä¸ªåˆ†éš”ç¬¦,s1,s1,s1s2,ä»¤len=strlen(s1$s2),åˆ™next[len]å³ä¸ºç­”æ¡ˆ
ä¹Ÿå¯ä¸åŠ åˆ†éš”ç¬¦ï¼Œæšä¸¾ len, next[len], next[next[len]] ......æ‰¾åˆ°å°äº min(|s1|, |s2|) çš„æœ€å¤§å€¼å³å¯ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=50010*2;//æ•°ç»„å¼€ä¸¤å€!
char s1[N],s2[N];
int ne[N];

int main()
{
	while(~scanf(&amp;quot;%s%s&amp;quot;,s1+1,s2+1))
	{
		strcat(s1+1,&amp;quot;$&amp;quot;);
		strcat(s1+1,s2+1);
		int n=strlen(s1+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s1[i] != s1[j+1])
				j=ne[j];
			if(s1[i] == s1[j+1])
				j++;
			ne[i]=j;
		}
		
		int ans=ne[n];
		s1[ans+1]=&#39;\0&#39;;
		if(ans == 0)
			printf(&amp;quot;0\n&amp;quot;);
		else 
			printf(&amp;quot;%s %d\n&amp;quot;,s1+1,ans);
	}
}

Codeforces 526D
ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œåˆ¤æ–­å…¶æ¯ä¸ªå‰ç¼€æ˜¯å¦å¯ä»¥è¡¨ç¤ºæˆABABâ€¦ABA çš„å½¢å¼ï¼ˆA å’Œ B éƒ½å¯ä»¥ä¸ºç©ºï¼Œ ä½†æ˜¯å¿…é¡»æ»¡è¶³ A æœ‰ k+1 ä¸ªï¼ŒB æœ‰ k ä¸ªï¼‰
|s|, k â‰¤ 1e6

è¾“å…¥
7 2
bcabcab
è¾“å‡º
0000011
é•¿åº¦ä¸º 6 çš„å‰ç¼€ï¼Œå¯ä»¥å– A=â€œâ€,B=â€œbcaâ€
é•¿åº¦ä¸º 7 çš„å‰ç¼€ï¼Œå¯ä»¥å– A=â€œbâ€, B=â€œcaâ€
å¯¹äºå‰ç¼€ Pï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ P æ‹†æˆ SSSSâ€¦STï¼Œå…¶ä¸­ T æ˜¯ Sçš„å‰ç¼€ã€‚
è¿™æ ·å°±å¯ä»¥ç”¨ KMP æ¥åšäº†ã€‚
é¦–å…ˆ i-next[i] å°±æ˜¯S[1..i] è¿™ä¸€æ®µçš„æœ€å°å¾ªç¯èŠ‚çš„é•¿åº¦ï¼Œ
è®°ä¸º eã€‚
å¯ä»¥å‘ç° e çš„å€æ•° je ä¹Ÿæ˜¯å¾ªç¯èŠ‚ã€‚

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cmath&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=1e6+10;
char s[N];
int n,k;
int ne[N];

bool check(int i,int cir)
{
	int up=i/k/cir;
	int down=ceil((i/(k+1)+1)/(1.0*cir));
	return up&amp;gt;=down || (i % (k+1) == 0 &amp;amp;&amp;amp; (i / (k+1)) % cir == 0);
}

int main()
{
	while(~scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;n,&amp;amp;k))
	{
		scanf(&amp;quot;%s&amp;quot;,s+1);
		
		int len=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=len;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
		
		for(int i=1;i&amp;lt;=n;i++)
		{
			int cir=i-ne[i];
			printf(&amp;quot;%d&amp;quot;,check(i,cir));
		}
	}
}

acwing
é¦–å…ˆæˆ‘ä»¬ç”¨KMPæ±‚å‡º T çš„ nextæ•°ç»„ã€‚
åˆ©ç”¨ nextæ•°ç»„åœ¨é•¿æ–‡æœ¬ä¸­åŒ¹é…æ¨¡æ¿ä¸² Tçš„è¿‡ç¨‹ï¼šå¦‚æœä¸‹ä¸€ä¸ªå­—æ¯ä¸åŒ¹é…ï¼Œéœ€è¦ä¸€ç›´æ²¿ç€nextæŒ‡é’ˆæ‰¾ï¼šj = next[j]ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦åŒ¹é…æˆ–è€…nextæŒ‡é’ˆæŒ‡å‘å¼€å¤´ä¸ºæ­¢ã€‚
ç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»åŒ¹é…å®Œé•¿æ–‡æœ¬çš„å‰ä¸ªå­—æ¯ï¼Œåˆ™å‰©ä¸‹éƒ¨åˆ†çš„åŒ¹é…è¿‡ç¨‹ï¼Œåªè·ŸnextæŒ‡é’ˆçš„ä½ç½®æœ‰å…³ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨äºŒç»´æ•°ç»„æ¥è¡¨ç¤ºå½“å‰çŠ¶æ€çš„æ–¹æ¡ˆæ•°ï¼š
f[i][j]è¡¨ç¤ºåŒ¹é…å®Œå‰ i ä¸ªå­—æ¯æ—¶ï¼ŒnextæŒ‡é’ˆåœ¨ j æ—¶çš„æ–¹æ¡ˆæ€»æ•°ã€‚
çŠ¶æ€è½¬ç§»ï¼šå¯¹äºæ¯ä¸ªçŠ¶æ€f[i][j]ï¼Œæˆ‘ä»¬ä»&#39;a&#39;-&#39;z&#39;æšä¸¾ä¸‹ä¸€ä¸ªå­—æ¯ï¼Œç„¶åæ±‚å‡ºå¯¹åº”çš„nextæŒ‡é’ˆï¼Œå‡è®¾æ˜¯ï¼Œåˆ™å°†f[i][j]çš„æ–¹æ¡ˆæ€»æ•°ç´¯åŠ åˆ°f[i+1][u]ã€‚
è½¬ç§»è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ï¼Œå› ä¸ºå¯†ç ä¸­ä¸èƒ½å­˜åœ¨ Tï¼Œæ‰€ä»¥nextæŒ‡é’ˆè¦é¿å…è½¬ç§»åˆ° Tçš„æœ€åä¸€ä¸ªå­—æ¯ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt; 
using namespace std;
const int N=55,mod=1e9+7;
int f[N][N];
int edge[N][26];
char p[N];
int ne[N];
int n;


int main()
{
    cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;p+1;
    int m=strlen(p+1);
    
    for(int i=2,j=0;i&amp;lt;=m;i++)
    {
        while(j &amp;amp;&amp;amp; p[i] != p[j+1])
            j=ne[j];
        if(p[i] == p[j+1])
            j++;
        ne[i]=j;
    }
    
    for(int i=0;i&amp;lt;m;i++)
        for(char k=&#39;a&#39;;k&amp;lt;=&#39;z&#39;;k++)
        {
            int j=i;//å·²åŒ¹é…äº†å‰iä¸ªå­—æ¯
            while(j &amp;amp;&amp;amp; p[j+1] != k)
                j=ne[j];
            if(p[j+1] == k)
                j++;
            edge[i][k-&#39;a&#39;]=j;
        }
        
    f[0][0]=1;
    for(int i=0;i&amp;lt;n;i++)
        for(int j=0;j&amp;lt;m;j++)
            for(char k=&#39;a&#39;;k&amp;lt;=&#39;z&#39;;k++)
            {
                int u=edge[j][k-&#39;a&#39;];
                f[i+1][u]=(f[i+1][u]+f[i][j])%mod;
            }
            
    int res = 0;
    for (int i = 0; i &amp;lt; m; i ++ ) res = (res + f[n][i]) % mod;

    cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; endl;

    return 0;
}

luoguP3193
è®¾f(i,j)è¡¨ç¤ºä»¥å‡†è€ƒè¯å·ä¸ºåŸºå‡†é€’æ¨ï¼Œå‡†è€ƒè¯å·åŒ¹é…åˆ°ç¬¬iä½ï¼Œä¸å‰åˆ©æ•°å­—åŒ¹é…åˆ°ç¬¬jä½æ—¶ï¼ˆå³å‡†è€ƒè¯çš„åjä½ç­‰äºä¸å‰åˆ©æ•°å­—çš„å‰jä½ï¼‰ï¼Œä¸å‡ºç°ä¸å‰åˆ©æ•°å­—çš„å­—ç¬¦ä¸²æ•°é‡ã€‚ã€‚
é‚£æ€ä¹ˆè½¬ç§»ï¼Ÿ
æ—¢ç„¶è¦ä»¥è€ƒå·ä¸ºåŸºå‡†é€’æ¨ï¼Œå°±è¦è€ƒè™‘ä¸€ä½è€ƒå·å¯¹ä¸‹ä¸€ä½çš„å½±å“ã€‚
è€Œè€ƒå·æ˜¯å¯ä»¥éšä¾¿å†™çš„ï¼Œé‚£æˆ‘ä»¬å°±è¦è€ƒè™‘10ç§æ•°å­—äº†ã€‚
å¯¹äºä¸€ä¸ªæ–°æ•°å­—newï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š
1.new
ä¸ä¸å‰åˆ©æ•°å­—çš„j+1ä½åŒ¹é…ï¼Œdp(i+1,j+1)çš„ç­”æ¡ˆæ•°+dp(i,j)
2.ä¸Šè¿°ä¸¤è€…ä¸åŒ¹é…ã€‚
ä¸åŒ¹é…æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªä¸åŒ¹é…çš„newä¸€å®šæ²¡æœ‰è´¡çŒ®äº†ï¼Ÿ
å½“ç„¶ä¸ä¸€å®šã€‚
æ€ä¹ˆè®²å‘¢ï¼Œä¸¾ä¸ªä¾‹å­å§ï¼Œä¸å‰åˆ©æ•°å­—æ˜¯12212112ã€‚ç„¶åä½ çš„å‡†è€ƒè¯å·æšä¸¾åˆ°ç¬¬9ä½æ—¶ï¼Œå‰é¢8ä½å·²ç»æšä¸¾æˆäº†11112212ã€‚å¯ä»¥å‘ç°å·²ç»åŒ¹é…äº†ä¸å‰åˆ©æ•°å­—çš„å‰5ä½ï¼Œç°åœ¨è¦åŒ¹é…ç¬¬6ä½ã€‚
å¦‚æœç¬¬9ä½æšä¸¾1ï¼Œé‚£å®ƒå°±åŒ¹é…äº†ï¼Œdp(9,6)+=dp(8,5)ã€‚å¦‚æœç¬¬9ä½æšä¸¾2ï¼Œé‚£å®ƒå°±ä¸åŒ¹é…ã€‚ä½†æ˜¯ä¼šå‘ç°ï¼Œå­˜åœ¨ ä¸å½“å‰å·²åŒ¹é…çš„ä¸å‰åˆ©æ•°å­—çš„åç¼€ç›¸åŒ çš„å‰ç¼€ï¼Œå¯ä»¥åŒ¹é…ä¸Šè¿™ä¸ª2ï¼
ä¸Šä¸€ä¸ªä½ç½®å°±æ˜¯ä¸å‰åˆ©æ•°å­—çš„ç¬¬2ä½ã€‚
å®ƒçš„ä¸‹ä¸€ä½ï¼Œç¬¬3ä½2ï¼Œåˆšå¥½å¯ä»¥åŒ¹é…æšä¸¾çš„ç¬¬9ä½ï¼
æ‰€ä»¥æ­¤æ—¶æœ€å¤šèƒ½åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰3ä½ï¼Œæœ‰è½¬ç§»dp(9,3)+=dp(8,5)ã€‚
æˆ‘ä»¬åªéœ€è¦æ²¿ç€ä¸å‰åˆ©æ•°å­—çš„å¤±é…æŒ‡é’ˆå¾€å‰èµ°ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸‹ä¸€ä½ä¸newåŒ¹é…çš„ä½ç½®å°±å¯ä»¥äº†ã€‚
ä¸ºä»€ä¹ˆä¸ç”¨è€ƒè™‘å†å¾€å‰çš„ä¸‹ä¸€ä½å¯ä»¥åŒ¹é…newçš„ä½ç½®ï¼Ÿ
å› ä¸ºè¿™æ˜¯é€’æ¨ï¼Œä»å‰å¾€åæ¯ä¸€ç§çŠ¶æ€éƒ½ä¼šè¢«è€ƒè™‘ï¼Œæ‰€ä»¥åœ¨è€ƒè™‘åŒ¹é…åé¢çš„ä½ä¹‹å‰ï¼Œå‰é¢çš„ä½å·²ç»åŒ¹é…å¥½æ›´å‰é¢çš„æƒ…å†µäº†ã€‚
æ¯”å¦‚ä¸å‰åˆ©æ•°å­—1221221211ã€‚ä½ ç›®å‰æšä¸¾çš„å‡†è€ƒè¯å·å‰8ä½æ˜¯12212212ï¼Œç°åœ¨ä½ è¦æšä¸¾ç¬¬9
ä½ã€‚å¾ˆæ˜æ˜¾å½“æšä¸¾2æ—¶ï¼Œé€šè¿‡æ‰¾ä¸å‰åˆ©æ•°å­—ä¸­ åç¼€ç›¸åŒçš„å‰ç¼€ï¼Œå¯çŸ¥dp(8,8)å¯ä»¥è½¬ç§»åˆ°dp(9,6)ã€‚
ä½†æ˜¯æˆ‘ä»¬å‘ç°ä¹Ÿå¯ä»¥è½¬ç§»åˆ°dp(9,3)è¯¶ï¼
äº‹å®ä¸Šï¼Œåœ¨è¿™ä¹‹å‰dp(8,5)å·²ç»è½¬ç§»åˆ°dp(9,3)è¿‡äº†ã€‚è€Œdp(8,5)è¡¨ç¤ºä»€ä¹ˆï¼Ÿå®ƒè¡¨ç¤ºå‡†è€ƒè¯å·æšä¸¾8ä½ï¼Œå5ä½ä¸ä¸å‰åˆ©æ•°å­—çš„å‰5ä½åŒ¹é…ä¸Šã€‚
dp(8,8)åŒç†ï¼Œè¡¨ç¤ºå‡†è€ƒè¯å·æšä¸¾å‰8ä½ï¼Œå8ä½ä¸ä¸å‰åˆ©æ•°å­—çš„å‰8ä½åŒ¹é…ä¸Šã€‚
è¿™æ ·ç›´è§‚çœ‹èµ·æ¥æ²¡ä»€ä¹ˆç­”æ¡ˆå…³è”ã€‚ä½†æ˜¯ä»”ç»†è€ƒè™‘ä»¥ä¸‹ï¼Œä¸å‰åˆ©æ•°å­—çš„ç¬¬8ä½çš„å¤±é…æŒ‡é’ˆæŒ‡å‘ç¬¬5ä½ã€‚
è¿™è¯´æ˜ä»€ä¹ˆï¼Ÿ
ä¸å‰åˆ©æ•°å­—çš„å‰8ä½ä¸­ï¼Œå‰5ä½ç­‰äºå5ä½ï¼
åŒ¹é…5ä½çš„æƒ…å†µåŒ…å«åŒ¹é…8ä½çš„æƒ…å†µï¼ï¼ˆå› ä¸ºä½ åŒ¹é…äº†8ä½ï¼Œæ ¹æ®ä¸Šæ¨è®ºå¯çŸ¥ä¹Ÿç®—åœ¨åŒ¹é…äº†5ä½çš„æƒ…å†µä¸­ï¼‰
è¿™å°±æ˜¯åˆ«äººåšå®¢ä¸­æ­¤é¢˜é¢˜è§£ç»å¸¸æåˆ°çš„è®¡æ•°æ–¹æ¡ˆä¼šåŒ…å«çš„é—®é¢˜ã€‚
å…¶å®æŒ‰ç…§ACè‡ªåŠ¨æœºçš„æ„é€ æ–¹å¼ï¼Œå¦‚æœä¸€ä¸ªç‚¹æ²¡æœ‰å­—ç¬¦ä¸ºnewçš„å„¿å­è¾¹çš„è¯ï¼Œå®ƒä¼šå»ºå‡ºä¸€æ¡å¯¹åº”çš„è™šæ‹Ÿå„¿å­è¾¹å’Œç‚¹ï¼Œå„¿å­ç‚¹ä¸Šå­˜çš„æ˜¯æ²¿ç€å¤±é…æŒ‡é’ˆå¾€å›èµ°çš„ä¸Šä¸€ä¸ªå®é™…å­˜åœ¨è¿™æ¡å­—ç¬¦è¾¹æ‰€æŒ‡å‘çš„å„¿å­ã€‚
å½“ç„¶è¿™é¢˜må¾ˆå°ï¼Œä¸å‰åˆ©æ•°å­—ä¸²è‡ªå·±åŒ¹é…è‡ªå·±çš„å¤æ‚åº¦å¾ˆå°ï¼Œå¯ä»¥ç›´æ¥æš´åŠ›è·‘å¤±é…æŒ‡é’ˆæ‰¾ç¬¬ä¸€ä¸ªã€‚

å…¶ä¸­g(i,j)è¡¨ç¤ºå½“å‰åŒ¹é…åˆ°iä¸ªå­—ç¬¦ï¼Œæ·»åŠ ä¸€ä¸ªå­—ç¬¦å˜æˆåŒ¹é…ä¸ºjä¸ªå­—ç¬¦çš„æ–¹æ¡ˆæ•°ã€‚
ä¸å‰åˆ©æ•°å­—å·²ç»çŸ¥é“äº†ï¼Œgæ•°ç»„å¯ä»¥é¢„å¤„ç†å‡ºæ¥ï¼ˆKMPï¼‰ã€‚
ç„¶åæˆ‘ä»¬æƒŠå¥‡åœ°å‘ç°nâ‰¤1e9ï¼Œä¸è®©ä½ å¾ªç¯æ¨ï¼Œç›´æ¥å°±æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–äº†ã€‚
è§‚å¯Ÿä¸€ä¸‹è½¬ç§»æ–¹ç¨‹ï¼Œå‘ç°dp[i+1][?]æ€»æ˜¯ç”±dp[i][?]æ¨æ¥ï¼Œè€Œä¸”iè¿˜æ˜¯nè¿™ä¸ªçº§åˆ«çš„ã€‚
åˆå‘ç°æ¯æ¬¡å®é™…ä¸Šéƒ½æ˜¯ä¹˜ä¸€ä¸ªå›ºå®šçš„çŸ©é˜µgï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªdpæ•°ç»„çš„æŸä¸€ä½çš„å€¼å…¶å®éƒ½æ˜¯é€šè¿‡ä¸€äº›gæ•°ç»„ä¹˜è¿‡æ¥çš„ã€‚
æ‰€ä»¥å¯ä»¥æŠŠdpæ•°ç»„ç›´æ¥å½“æˆgæ•°ç»„è‡ªå·±ä¹˜è‡ªå·±ã€‚
æ¯”å¦‚è¯´ï¼Œg(4,2)=4ã€‚
è¡¨ç¤ºæœ‰4ç§è½¬ç§»æƒ…å†µå¯ä»¥è®© ä¸ä¸å‰åˆ©æ•°å­—çš„å‰4ä½åŒ¹é…çš„æƒ…å†µ åœ¨å‡†è€ƒè¯å·å¢åŠ 1ä½å ä¸ä¸å‰åˆ©æ•°å­—çš„å‰2ä½åŒ¹é…ã€‚
æ‰€ä»¥dp(x+1,2)=dp(x,4)âˆ—g(4,2)=dp(x,4)âˆ—4
è€Œdp(x,4)åˆæ˜¯å“ªæ¥çš„ï¼Ÿ
å®ƒæ˜¯é€šè¿‡âˆ‘i=1m\sum_{i=1}^mâˆ‘i=1mâ€‹dp(xâˆ’1,i)âˆ—g(i,4)è½¬ç§»è¿‡æ¥çš„ã€‚
æ‰€ä»¥ä¸€ç›´å¾€å‰æ¨åˆ°x=0ï¼Œå‘ç°dpå€¼çš„næ¬¡è½¬ç§»éƒ½åªè·Ÿè½¬ç§»çŸ©é˜µgæœ‰å…³ï¼Œæ˜¯å¦ä¸ä¸å‰åˆ©æ•°å­—å®Œå…¨åŒ¹é…ç­‰æƒ…å†µå¯ä»¥åœ¨å¼„gæ•°ç»„æ—¶å°±å¤„ç†æ‰ï¼Œå³gæ•°ç»„åªè€ƒè™‘ä¸å‰åˆ©æ•°å­—è¢«åŒ¹é…0~mâˆ’1ä½çš„æƒ…å†µï¼Œä¸è®©å®ƒè½¬ç§»åˆ°jä½éƒ½è¢«åŒ¹é…çš„æƒ…å†µã€‚
æ‰€ä»¥å°±æ˜¯å¯¹gçŸ©é˜µåšå¿«é€Ÿå¹‚ï¼Œæ±‚å®ƒçš„næ¬¡æ–¹ã€‚
æ—¶é—´å¤æ‚åº¦O(log(n)âˆ—m^3)
ä¸ºä»€ä¹ˆç­”æ¡ˆæ˜¯g(0,i)ï¼Œfor i 0~m-1
è€ƒè™‘g(i,j)çš„æ„ä¹‰ã€‚å¦‚æœgçŸ©é˜µè‡ªå·±å¯¹è‡ªå·±è¿ç»­è¿›è¡Œkæ¬¡è½¬ç§»ï¼ˆä¸è¿›è¡Œå¿«é€Ÿå¹‚è€Œå¾ªç¯æ¨ï¼‰ï¼Œg(i,j)å°±è¡¨ç¤ºï¼šåœ¨è¿›è¡Œkæ¬¡è½¬ç§»å‰ å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰iä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ kä¸ªå­—ç¬¦åï¼Œä½¿ä¸å‰åˆ©æ•°å­—æ²¿å¤±é…æŒ‡é’ˆï¼ˆè‡ªå·±ä¹Ÿå¯ä»¥ï¼‰æ‰¾åˆ°çš„æœ€å¤§çš„åŒ¹é…ä½æ•°jï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„kä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ˜¯çŸ©é˜µè½¬ç§»çš„åŸºæœ¬æ¦‚å¿µã€‚
æ‰€ä»¥è¿›è¡Œnæ¬¡è½¬ç§»åï¼Œg(i,j)å°±è¡¨ç¤ºä¸€å¼€å§‹å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰iä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ nä¸ªå­—ç¬¦åï¼Œä½¿ä¸å‰åˆ©æ•°å­—æ²¿å¤±é…æŒ‡é’ˆï¼ˆè‡ªå·±ä¹Ÿå¯ä»¥ï¼‰æ‰¾åˆ°çš„æœ€å¤§çš„åŒ¹é…ä½æ•°jï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„kä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚
æˆ‘ä»¬éœ€è¦å–å…¨å±€æƒ…å†µçš„ç­”æ¡ˆï¼Œè€Œè¿™æ˜¯å¾ˆæ˜¾ç„¶çš„ã€‚å¼€å§‹æ—¶å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰0ä½ï¼ˆå‡†è€ƒè¯å·è¿˜ä¸€ä½éƒ½æ²¡æšä¸¾ï¼‰ï¼Œæ‰€ä»¥iä¸º0ï¼›è€Œç”±äºå·²ç»å®šä¹‰è¿‡gæ•°ç»„åªè€ƒè™‘ä¸å‰åˆ©æ•°å­—è¢«åŒ¹é… 0~mâˆ’1ä½çš„æƒ…å†µï¼Œæ‰€ä»¥jåœ¨è¿™ä¸ªåŒºé—´å–ä»»æ„å€¼ï¼Œg(0,j)éƒ½æ˜¯ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ã€‚æŠŠå®ƒä»¬éƒ½ç®—ä¸Šå°±æ˜¯ç­”æ¡ˆã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=25;
char p[N];
int n,m,mod;
struct matrix
{
	int m[N][N];
	matrix()
	{
		memset(m,0,sizeof m);
	}
};
int ne[N];

matrix mul(matrix a,matrix b)
{
	matrix res;
	for(int i=0;i&amp;lt;m;i++)
		for(int j=0;j&amp;lt;m;j++)
			for(int k=0;k&amp;lt;m;k++)
				res.m[i][j]=(res.m[i][j]+a.m[i][k]*b.m[k][j])%mod;
	return res;
}

int main() 
{
	scanf(&amp;quot;%d%d%d&amp;quot;, &amp;amp;n, &amp;amp;m, &amp;amp;mod);
	scanf(&amp;quot;%s&amp;quot;, p+1);
	
	matrix g;
	for(int i=2,j=0;i&amp;lt;=m;i++)
	{
		while(j &amp;amp;&amp;amp; p[i] != p[j+1])
			j=ne[j];
		if(p[i] == p[j+1])
			j++;
		ne[i]=j;
	}
	
	for(int i=0;i&amp;lt;m;i++)
		for(int k=0;k&amp;lt;10;k++)
		{
			int j=i;
			while(j &amp;amp;&amp;amp; p[j+1]-&#39;0&#39; != k)
				j=ne[j];
			if(p[j+1]-&#39;0&#39; == k)
				j++;
			if(j&amp;lt;m)	g.m[i][j]=(g.m[i][j]+1)%mod;
		}
	
	matrix a;
	for(int i=0;i&amp;lt;m;i++)
		a.m[i][i]=1;
	
	while(n)
	{
		if(n &amp;amp; 1) a=mul(a,g);
		g=mul(g,g);
		n&amp;gt;&amp;gt;=1;
	}
//	
//	for(int i=0;i&amp;lt;m;i++)
//	{
//		for(int j=0;j&amp;lt;m;j++)
//			cout&amp;lt;&amp;lt;a.m[i][j]&amp;lt;&amp;lt;&#39; &#39;;
//		cout&amp;lt;&amp;lt;endl;
//	}
	
	int ans = 0;
	for(int i = 0; i &amp;lt; m; ++i)
		ans = (ans + a.m[0][i]) % mod;
	
	printf(&amp;quot;%d\n&amp;quot;, ans);
	return 0;
}



Zç®—æ³•




r[5] = 7
r[6] = 7
l[5] = 5
l[6] = 5

å¯¹äº Z[2] æˆ‘ä»¬éœ€è¦æš´åŠ›è®¡ç®—ã€‚
ä¹Ÿå°±æ˜¯æš´åŠ›è®¡ç®— S[1..|S|] å’Œ S[2..|S|] çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚
å¦‚æœ Z[2] &amp;gt; 0, é‚£ä¹ˆ r = r[2], l = l[2] = 2
å¦‚æœ Z[2] = 0, é‚£ä¹ˆ r = r[2] = 0, l = l[2] = 0
æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ç”¨å·²æœ‰çš„ Z[2], Z[3], ..., Z[k-1]ï¼Œæ¥æ¨
å‡º Z[k].
å‡è®¾ k = 121, Z[2..120] å·²ç»çŸ¥é“äº†
r[120] = 130, l[120] = 100

åˆ’åˆ†æˆ[l,i-1],[i,r]





è“è‰²éƒ¨åˆ†ä¸€å®šä¸ç›¸ç­‰ï¼Œå¦åˆ™è¯´æ˜z-boxå¯ä»¥å³ç§»
ç¬¬ä¸€æ­¥ï¼š
åˆå§‹åŒ– Z[]ï¼Œæš´åŠ›è®¡ç®— Z[2]
for(int i = 1;i &amp;lt;= n;i ++) z[i] = 0;
int l, r;
while(str[1 + z[2]] == str[2 + z[2]]) z[2] ++; 
l = 2, r = 2+ z[2]-1;

ç¬¬äºŒæ­¥ï¼š
æšä¸¾ iï¼Œåˆ†ä¸‰ç§æƒ…å†µä¾æ¬¡è®¡ç®— Z[i]
for(int i = 3;i &amp;lt;= n;i ++)
{
    if(i &amp;gt; r)
    {
        while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
        l = i, r = i + z[i] - 1;
    }
    else
    {
        if(z[i - l + 1] &amp;lt; r - i + 1) z[i] = z[i - l + 1];
        else
        {
            z[i] = r - i;
            while(str[1 + z[i]] == str[i + z[i]]) z[i] ++; 
            l = i, r = i + z[i] - 1; 
        }
    } 
}

æ—¶é—´å¤æ‚åº¦æ˜¯ O(n) çš„
æ‰©å±•KMP
ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tï¼ˆé•¿åº¦åˆ†åˆ«ä¸º n å’Œ mï¼‰
å®šä¹‰ extend[i] ä¸º S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚
æ±‚å‡º extend æ•°ç»„

å¦‚æœ S = Tï¼Œé‚£ä¹ˆ extend æ•°ç»„å°±æ˜¯ Z æ•°ç»„ã€‚

å‡è®¾ç°åœ¨éå†åˆ°äº† S[i]ï¼Œä¸” S[1], S[2],â€¦, S[i-1]éƒ½å·²ç»ç®—å‡º
ä¸ Z ç®—æ³•ç±»ä¼¼ï¼Œè®¾ç½®ä¸¤ä¸ªå˜é‡ l å’Œ rï¼Œr è¡¨ç¤ºèƒ½å’Œ T åŒ¹
é…åˆ°çš„æœ€å³è¾¹çš„ä½ç½®ï¼Œl ä¸º r å¯¹åº”çš„èµ·å§‹ä½ç½®ã€‚
ä¹Ÿå°±æ˜¯ S[l .. r] = T[1.. r-l+1]

S[i] å¯¹åº”çš„æ˜¯ T[i-l+1]
ç°åœ¨è¦è®¡ç®—çš„æ˜¯ S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€
æ³¨æ„åˆ°æ­¤æ—¶ S[i..r] = T[i-l+1 .. r-l+1]
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå¯¹ T æ±‚ä¸€é Z æ•°ç»„ï¼Œç„¶åè€ƒå¯Ÿä¸€ä¸‹ Z[i-l+1]



void calc_Z(char *str) 
{
	int n = strlen(str + 1);
	for(int i = 1; i &amp;lt;= n; i ++) z[i] = 0;
	z[1] = n;
	int l, r = 0;
	for(int i = 2; i &amp;lt;= n; i ++) 
	{
		if(i &amp;gt; r) 
		{
			while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
			l = i, r = i + z[i] - 1;
		} else 
		{
			if(z[i - l + 1] &amp;lt; r - i + 1) z[i] = z[i - l + 1];
			else 
			{
				z[i] = r - i + 1;
				while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
				l = i, r = i + z[i] - 1;
			}
		}
	}
}

void calc_extend(char *S, char *T) 
{
	calc_Z(T);
	int l, r = 0;
	int n = strlen(S + 1);
	int m = strlen(T + 1);
	for (int i = 1; i &amp;lt;= n; i ++) 
	{
		if (i &amp;gt; r) 
		{
			while (i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp;
			        S[i + ext[i]] == T[1 + ext[i]]) ext[i] ++;
			l = i, r = i + ext[i] - 1;
		}
		else 
		{
			if (i + z[i - l + 1] - 1 &amp;lt; r) ext[i] = z[i - l + 1];
			else 
			{
				ext[i] = r - i + 1;
				while (i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp; S[i +ext[i]] == T[1 + ext[i]]) 
					ext[i] ++;
				l = i, r = i + ext[i] - 1;
			}
		}
	}
}

ä¾‹é¢˜
é¢˜æ„ï¼šç»™ä½ nä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚è¿™nä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²
hdu4333
ç»™ä¸€ä¸ª L ä½æ•°çš„æ­£æ•´æ•° Nï¼Œæ¯æ¬¡å¯ä»¥æŠŠè¿™ä¸ªæ•°çš„æœ€åä¸€ä½ç§»åˆ°æœ€å‰é¢æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°ã€‚
æ€»å…±æœ€å¤šå¯ä»¥å¾—åˆ° n ä¸ªæ•°ï¼Œé‡å¤çš„åªç®—ä¸€æ¬¡ã€‚
é—®è¿™äº›æ•°ä¸­ï¼Œç­‰äº n çš„ï¼Œå°äº nçš„ï¼Œå¤§äº n çš„æ•°åˆ†åˆ«æœ‰å‡ ä¸ªã€‚
L â‰¤ 1e5

æ ·ä¾‹ï¼š
341 ï¼ˆç­”æ¡ˆï¼š 1 1 1ï¼‰
æˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæ•°å¤åˆ¶ä¸¤éï¼Œç„¶ååªè€ƒè™‘é•¿åº¦ä¸º n çš„å­ä¸²ã€‚è¿™äº›å­ä¸²å°±æ˜¯ç§»åŠ¨è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°ã€‚
å¦‚ä½•å’ŒåŸæ•° N åšæ¯”è¾ƒå‘¢
å‡è®¾ç°åœ¨çš„æ•°æ˜¯ S[i .. i+L-1], N æ˜¯ S[1..L]
æˆ‘ä»¬åªè¦æ±‚å‡ºä»–ä»¬çš„æœ€é•¿å…¬å…±å‰ç¼€ xï¼Œå¦‚æœ x = n è¯´æ˜è¿™ä¸¤ä¸ªæ•°ç›¸ç­‰ã€‚
å¦åˆ™ï¼Œæ¯”è¾ƒ S[x] å’Œ S[i+x-1] çš„å¤§å°ï¼Œå°±å¯ä»¥ç¡®å®šä»–ä»¬çš„å¤§å°å…³ç³»ã€‚
æ±‚ x ï¼Œå°±æ˜¯æ‰©å±• KMP ä¸­çš„ Z ç®—æ³•ã€‚x = min(n, Z[i])
æœ€åä¸€æ­¥å»é‡ã€‚å¯¹ N è·‘ä¸€æ¬¡ KMP
å¦‚æœ L-next[L] æ˜¯ L çš„çº¦æ•°ï¼Œé‚£ä¹ˆ L-next[L] æ˜¯ N çš„æœ€å°å¾ªç¯èŠ‚ã€‚å¦åˆ™ N çš„ æœ€å°å¾ªç¯èŠ‚æ˜¯ Lã€‚
å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾ä¸€éå³å¯,æˆ–é™¤ä»¥æœ€å°å¾ªç¯èŠ‚ä¸ªæ•°ã€‚
æ—¶é—´å¤æ‚åº¦ O(L)
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=200010;
char str[N];
int ne[N];
int z[N];

int main()
{
    int T;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;T);
    for(int kas=1;kas&amp;lt;=T;kas++)
    {
        scanf(&amp;quot;%s&amp;quot;,str+1);
        
        int len=strlen(str+1);
        for(int i=2,j=0;i&amp;lt;=len;i++)
        {
            while(j &amp;amp;&amp;amp; str[i] != str[j+1])
                j=ne[j];
            if(str[i] == str[j+1])
                j++;
            ne[i]=j;
        }
        
        for(int i=1;i&amp;lt;=len;i++)
            str[i+len]=str[i];
        str[len*2+1]=&#39;\0&#39;;
        memset(z,0,sizeof z);
        z[1]=len*2;
        int l,r=0;
        
        for(int i=2;i&amp;lt;=len*2;i++)
        {
            if(i&amp;gt;r)
            {
                while(str[1+z[i]] == str[i+z[i]])
                    z[i]++;
                l=i,r=i+z[i]-1;
            }
            else 
            {
                if(z[i-l+1] &amp;lt; r-i+1)
                    z[i]=z[i-l+1];
                else 
                {
                    z[i]=r-i;
                    while(str[1+z[i]] == str[i+z[i]])
                        z[i]++;
                    l=i,r=i+z[i]-1;
                }
            }
        }
        
        int gre=0,eql=0,les=0;
        for(int i=1;i&amp;lt;=len;i++)
        {
            if(z[i] &amp;gt;= len)
                eql++;
            else if(str[1+z[i]] &amp;gt; str[i+z[i]])
                les++;
            else gre++;
        }
        
        int t;
        if(len%(len-ne[len]) == 0)
            t=len/(len-ne[len]);//å¾ªç¯èŠ‚ä¸ªæ•° 
        else 
            t=1;
        printf(&amp;quot;Case %d: %d %d %d\n&amp;quot;,kas,les/t,eql/t,gre/t);
    }
}

å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾ä»£ç 
poj3376
ç»™ä½  n ä¸ªå­—ç¬¦ä¸² m[1], m[2], â€¦, m[n]ã€‚ æ±‚ S = m[i]m[j] ï¼ˆ1 &amp;lt;= i,j &amp;lt;= nï¼‰æ˜¯å›æ–‡ä¸²çš„æ•°é‡ã€‚
n ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¹‹å’Œä¸è¶…è¿‡ 2Â·1e6

æ ·ä¾‹è¾“å…¥ï¼š
3a
ab
ba
ç­”æ¡ˆï¼š5ï¼ˆaa,aba,aba,abba,baab)
è€ƒè™‘ä»€ä¹ˆæƒ…å†µä¸‹ i å’Œ j æ‹¼èµ·æ¥ä¼šæ˜¯å›æ–‡ä¸²ã€‚


içš„é•¿åº¦å°äºjï¼Œé‚£ä¹ˆiä¸€å®šæ˜¯jçš„åä¸²çš„å‰ç¼€ï¼Œä¸”jçš„åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²


içš„é•¿åº¦ç­‰äºjï¼Œé‚£ä¹ˆiç­‰äºjçš„åä¸²


içš„é•¿åº¦å¤§äºjï¼Œé‚£ä¹ˆjçš„åä¸²ä¸€å®šæ˜¯içš„å‰ç¼€ï¼Œä¸”iä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²


æˆ‘ä»¬å¯ä»¥å°†è¿™nä¸ªå­—ç¬¦ä¸²æ’å…¥trieï¼Œæ¯ä¸ªèŠ‚ç‚¹è¦ç»´æŠ¤ä¸¤ä¸ªå€¼ï¼š
value1. åˆ°å½“å‰èŠ‚ç‚¹çš„å­—ç¬¦ä¸²ä¸ªæ•°ï¼›value2.å½“å‰èŠ‚ç‚¹åé¢çš„å›æ–‡å­ä¸²ä¸ªæ•°
æˆ‘ä»¬ç”¨æ¯ä¸ªå­—ç¬¦ä¸²çš„åä¸²å»trieä¸ŠæŸ¥æ‰¾ï¼Œè¦æ„æˆå›æ–‡ä¸²æœ‰ä»¥ä¸‹æƒ…å†µï¼š


1.æ­¤åä¸²æ˜¯å…¶ä»–ä¸²çš„å‰ç¼€ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡å°±è¦åŠ ä¸Švalue2


2.æ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡è¦åŠ ä¸Švalue1


3.2çš„ç‰¹ä¾‹ï¼šæ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€ä¸ºç©ºï¼ŒåŒæ ·è¦åŠ ä¸Švalue1ï¼Œè¿™ç§æƒ…å†µå¯ä»¥å’Œ2ä¸€èµ·å¤„ç†


ç•™ä¸‹çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€ä¸­ï¼Œå“ªäº›æ˜¯å›æ–‡ä¸²ã€‚
å¯¹äºä¸² Sï¼Œæˆ‘ä»¬å…ˆæ±‚å‡ºæ­£ä¸² S å¯¹åä¸² T çš„ extend[i]
é‚£ä¹ˆå¯¹äºæ¯ä¸ª iï¼Œå¦‚æœ S[i..n] å’Œ T çš„æœ€é•¿å…¬å…±å‰ç¼€ç­‰äº
S[i..n] çš„é•¿åº¦ï¼Œè¯´æ˜ S[i..n] æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ã€‚
å› æ­¤æ•´é“é¢˜å°±åœ¨çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³äº†ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=2e6+10;
int trie[N][26],tot=1;
int n;
char s[N],t[N];
int len[N];
int slen;
int z[N],ext[N];
bool flag[2][N];
int bg[N],ed[N];
typedef long long LL;
struct Node
{
	int v1,v2;
}cnt[N];

void get_z(char *s)
{
	int n=strlen(s+1);
	for(int i=1;i&amp;lt;=n;i++) z[i]=0;
	z[1]=n;
	int l,r=0;
	for(int i=2;i&amp;lt;=n;i++)
	{
		if(i&amp;gt;r)
		{
			while(s[1+z[i]] == s[i+z[i]])
				z[i]++;
			l=i,r=i+z[i]-1;
		}
		else
		{
			if(z[i-l+1] &amp;lt; r-i+1)
				z[i]=z[i-l+1];
			else
			{
				z[i]=r-i;
				while(s[1+z[i]] == s[i+z[i]])
					z[i]++;
				l=i,r=i+z[i]-1;
			}
		}
	}
}

void exkmp(int type,char *s,char *t)
{
	get_z(t);
	int n=strlen(s+1);
	int m=strlen(t+1);
	for(int i=1;i&amp;lt;=n;i++)
		ext[i]=0;
	int l,r=0;
	for(int i=1;i&amp;lt;=n;i++)
	{
		if(i&amp;gt;r)
		{
			while(i+ext[i] &amp;lt;=n &amp;amp;&amp;amp; 1+ext[i] &amp;lt;=m &amp;amp;&amp;amp;
			s[i+ext[i]] == t[1+ext[i]])
				ext[i]++;
			l=i,r=i+ext[i]-1;
		}
		else
		{
			if(z[i-l+1] &amp;lt; r-i+1)
				ext[i]=z[i-l+1];
			else
			{
				ext[i]=r-i+1;
				while(i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp; 
				s[i+ext[i]] == t[1+ext[i]])
					ext[i]++;
				l=i,r=i+ext[i]-1;
			}
		}
	}

	for(int i=1;i&amp;lt;=n;i++)
	{
		//cout&amp;lt;&amp;lt;&amp;quot;---&amp;quot;&amp;lt;&amp;lt;ext[i]&amp;lt;&amp;lt;endl;
		if(ext[i] == n-i+1)
			flag[type][i+slen]=true;//s[i...n]ä¸ºå›æ–‡ä¸²
	}
}

void insert(int k)
{
	int p=1;
	for(int i=bg[k];i&amp;lt;=ed[k];i++)
	{
		cnt[p].v2+=flag[0][i];
		int ch=s[i]-&#39;a&#39;;
		if(!trie[p][ch])
			trie[p][ch]=++tot;
		p=trie[p][ch];
	}
	cnt[p].v1++;
}

void print(int k)
{
	int p=1;
	for(int i=bg[k];i&amp;lt;=ed[k];i++)
	{
		int ch=s[i]-&#39;a&#39;;
		p=trie[p][ch];
		cout&amp;lt;&amp;lt;&amp;quot;---&amp;quot;&amp;lt;&amp;lt;cnt[p].v2&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;cnt[p].v1&amp;lt;&amp;lt;endl;
	}
}

int main()
{
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	
	for(int i=1;i&amp;lt;=n;i++)
	{
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;len[i]);
		scanf(&amp;quot;%s&amp;quot;,s+1+slen);
		for(int j=1;j&amp;lt;=len[i];j++)
			t[slen+j]=s[slen+len[i]+1-j];
		t[slen+len[i]+1]=&#39;\0&#39;;
		exkmp(0,s+slen,t+slen);
		exkmp(1,t+slen,s+slen);

		bg[i]=slen+1;
		slen+=len[i];
		ed[i]=slen;

		insert(i);
		//print(i);
	}

	LL ans=0;
	for(int i=1;i&amp;lt;=n;i++)
	{
		int p=1;
		bool f=true;
		for(int j=ed[i];j&amp;gt;=bg[i];j--)//ç”¨åä¸²å»trieä¸ŠåŒ¹é…
		{
			int k=s[j]-&#39;a&#39;;
			if(!trie[p][k])
			{
				f=false;
				break;
			}
			else
				p=trie[p][k];
			if(flag[1][bg[i]+ed[i]-j+1] || j == bg[i])
				ans+=cnt[p].v1;
		}
		if(f)
			ans+=cnt[p].v2;
	}

	printf(&amp;quot;%lld\n&amp;quot;,ans);
	return 0;
}


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/zi-fu-chuan-fu-xi-yi/">Read More ~</a>
                            </div>
                </div>
            </article>
            
                <!-- ç¿»é¡µ -->
                
    <div class="pagination-container">
        
            <a href="https://caifxh.github.io/page/2/" class="page-btn btn">ä¸Šä¸€é¡µ</a>
            
                
    </div>
    
                </div>
                <!--  -->
                <div class="main-container-middle"></div>
                <!--  -->
                <div id="sidebar" class="main-container-right">

                    <!-- ä¸ªäººä¿¡æ¯ -->
                    
    <div class="id_card i-card">
        <div class="id_card-avatar" style="background-image: url(https://caifxh.github.io/images/avatar.png?v=1586405129501)">
        </div>
        <h1 class="id_card-title">
            fxh
        </h1>
        <h2 class="id_card-description">
            èœ
        </h2>
        <!--  -->
        <div class="id_card-sns">
            <!-- github -->
            
                    <!-- twitter -->
                    
                            <!-- weibo -->
                            
                                    <!-- facebook -->
                                    

        </div>
    </div>
    

                        <!-- å…¬å‘Šæ  -->
                        

                </div>
            </div>



            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://caifxh.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
</body>

</html>