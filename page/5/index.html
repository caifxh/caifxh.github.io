<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    fxh&#39;blog
</title>
<link rel="shortcut icon" href="https://caifxh.github.io/favicon.ico?v=1594530304239">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://caifxh.github.io/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://caifxh.github.io/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://caifxh.github.io">
                <img class="avatar" src="https://caifxh.github.io/images/avatar.png?v=1594530304239" alt="">
            </a>
            <div class="site-title">
                <h1>
                    fxh&#39;blog
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    é¦–é¡µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-container main-container">
                <div id="content" class="main-container-left">
                    
        
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/zi-fu-chuan-fu-xi-yi/">
                        å­—ç¬¦ä¸²å¤ä¹ ï¼ˆä¸€ï¼‰
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-03-26</time>
                    
                        <a href="https://caifxh.github.io/tag/O-y3VW7ncS/" class="post-tag i-tag
                            i-tag-">
            #å­—ç¬¦ä¸²
        </a>
                        
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            å“ˆå¸Œè¡¨
å¦‚æœè¦å‚¨å­˜å’Œä½¿ç”¨çº¿æ€§è¡¨ï¼ˆ1ï¼Œ75ï¼Œ324ï¼Œ43ï¼Œ1353ï¼Œ90ï¼Œ46ï¼‰ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ä¸€ä¸ªæ•°ç»„ A[1..7] æ¥é¡ºåºå­˜å‚¨è¿™äº›æ•°ã€‚
ä½†æ˜¯è¿™æ ·çš„å­˜å‚¨ç»“æ„ä¼šç»™æŸ¥è¯¢ç®—æ³•å¸¦æ¥ O(n) çš„æ—¶é—´å¼€é”€ã€‚
å¯¹ A æ’åºï¼Œä½¿ç”¨äºŒåˆ†æŸ¥è¯¢æ³•ï¼Œæ—¶é—´å¤æ‚åº¦å˜ä¸º O(log n)ä¹Ÿå¯ä»¥ç”¨ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ï¼Œç”¨æ•°ç»„ A[1..1353] æ¥è¡¨ç¤ºæ¯ä¸ªæ•°æ˜¯å¦å‡ºç°ï¼ŒæŸ¥æ‰¾çš„æ—¶é—´å¤æ‚åº¦å˜ä¸º O(1)ï¼Œä½†æ˜¯ç©ºé—´ä¸Šçš„å¼€é”€å˜å¾—å·¨å¤§ã€‚
ä¼˜åŒ–ä¸Šä¸€ç§åšæ³•ï¼Œå»ºç«‹ä¸€ä¸ªå“ˆå¸Œå‡½æ•° h(key) = key % 23.(1, 75, 324, 43, 1353, 90) -&amp;gt; (1, 6, 2, 20, 19, 21, 0)
æˆ‘ä»¬åªè¦ç”¨ä¸€ä¸ª A[0..22] æ•°ç»„å°±å¯ä»¥å¿«é€Ÿçš„æŸ¥è¯¢æ¯ä¸ªæ•°æ˜¯å¦å‡ºç°ã€‚
è¿™ç§çº¿æ€§è¡¨çš„ç»“æ„å°±ç§°ä¸ºå“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰ã€‚
å¯ä»¥çœ‹å‡ºï¼Œå“ˆå¸Œè¡¨çš„åŸºæœ¬åŸç†æ˜¯ç”¨ä¸€ä¸ªä¸‹æ ‡èŒƒå›´æ¯”è¾ƒå¤§çš„æ•°ç»„ A æ¥å­˜å‚¨å…ƒç´ ã€‚
è®¾è®¡ä¸€ä¸ªå‡½æ•° hï¼Œå¯¹äºè¦å­˜å‚¨çš„çº¿æ€§è¡¨çš„æ¯ä¸ªå…ƒç´  nodeï¼Œå–ä¸€ä¸ªå…³é”®å­— keyï¼Œç®—å‡ºå‡½æ•°å€¼ h(key) ç„¶åæŠŠè¿™ä¸ªå€¼ä½œä¸ºä¸‹æ ‡ï¼Œç”¨ A[h(key)] æ¥å­˜å‚¨ nodeã€‚
æœ€å¸¸è§çš„ h å°±æ˜¯æ¨¡å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é€‰å®šä¸€ä¸ª mï¼Œä»¤ h(key) =key % m.
ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯èƒ½å­˜åœ¨ä¸¤ä¸ª key: k1, k2 ä½¿å¾—h(k1)=h(k2)ï¼Œè¿™æ—¶ä¹Ÿç§°äº§ç”Ÿäº†â€œå†²çªâ€ã€‚
è§£å†³å†²çªæœ‰å¾ˆå¤šç§åŠæ³•ï¼š
1.å¼€æ”¾å¯»å€æ³•
2.æ‹‰é“¾æ³•ï¼šå¯ä»¥è®© A çš„æ¯ä¸ªå…ƒç´ éƒ½å­˜ä¸€ä¸ªé“¾è¡¨ï¼Œå¯¹äº
h(k1)=h(k2)ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¿™ä¸¤ä¸ª node éƒ½æ¥åœ¨ A[h(k1)]
çš„é“¾è¡¨ä¸Š
å‡è®¾æˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•è§£å†³å†²çªã€‚
å¯¹äºæ’å…¥å…ƒç´ (node, key)ï¼š

è®¡ç®— h(key)ï¼ŒæŠŠ node æ’å…¥ A[h(key)] é“¾è¡¨ã€‚

å¯¹äºæŸ¥è¯¢å…ƒç´ (node, key)ï¼š

è®¡ç®— h(key)ï¼Œå¦‚æœ A[h(key)] ä¸ºç©ºï¼Œè¯´æ˜ node ä¸å­˜åœ¨ã€‚
å¦åˆ™éå† A[h(key)] é“¾è¡¨ï¼Œå¯»æ‰¾ nodeã€‚

æ¨¡æ¿é¢˜
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=100003;
int h[N],e[N],ne[N],idx;

void insert(int x)
{
    int k=(x%N+N)%N;
    e[idx]=x;
    ne[idx]=h[k];
    h[k]=idx++;
}

bool find(int x)
{
    int k=(x%N+N)%N;
    for(int i=h[k];i!=-1;i=ne[i])
    {
        if(e[i]==x)
            return true;
    }
    return false;
}

int main()
{
    int n;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
    memset(h,-1,sizeof(h));
    while(n--)
    {
        char op[2];
        int x;
        scanf(&amp;quot;%s%d&amp;quot;,op,&amp;amp;x);

        if(*op==&#39;I&#39;)
            insert(x);
        else
        {
            if(find(x))
                puts(&amp;quot;Yes&amp;quot;);
            else
                puts(&amp;quot;No&amp;quot;);
        }
    }
    return 0;
}

ä¾‹é¢˜
å·²çŸ¥ X[1..4] æ˜¯ [-T, T] ä¸­çš„æ•´æ•°ï¼Œæ±‚å‡ºæ»¡è¶³æ–¹ç¨‹AX[1]+BX[2]+CX[3]+DX[4] = Pçš„è§£æœ‰å¤šå°‘ç»„ï¼Ÿ
|P|â‰¤1e9ï¼Œ|A|,|B|,|C|,|D|â‰¤1e4ï¼ŒTâ‰¤500
æœ€ç›´è§‚çš„æ–¹æ³•æšä¸¾ X[1..4], æ—¶é—´å¤æ‚åº¦ O(n4n^4n4)
é€‚å½“ä¼˜åŒ–ï¼Œæšä¸¾äº†X[1..3] ä¹‹åï¼Œå®é™…ä¸Š X[4] å·²ç»ç¡®å®šäº†ï¼Œæ—¶é—´å¤æ‚åº¦ O(n3n^3n3)
ç»§ç»­ä¼˜åŒ–ï¼Œé‡‡ç”¨ meet in the middle ç­–ç•¥ï¼š
ä¸€è¾¹æšä¸¾ X[1], X[2]
ä¸€è¾¹æšä¸¾ X[4], X[3]
ç„¶åçœ‹æœ‰å“ªäº›æ–¹æ¡ˆå¯ä»¥ç»„æˆæ–¹ç¨‹çš„è§£
æšä¸¾ X[1], X[2], ç„¶åç®—å‡º P-AX[1]-BX[2],æŠŠè¿™ä¸ªå€¼å­˜å…¥ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œæ³¨æ„è¦ç»Ÿè®¡æ¬¡æ•°ã€‚
è¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ O(n2n^2n2)
ç„¶åæšä¸¾ X[3], X[4], ç®—å‡º CX[3]+DX[4],å»å“ˆå¸Œè¡¨é‡ŒæŸ¥æ‰¾è¿™ä¸ªå€¼å‡ºç°äº†å‡ æ¬¡ã€‚
æŠŠæ¬¡æ•°åŠ è¿›ç­”æ¡ˆï¼Œè¿™ä¸€æ­¥æ—¶é—´å¤æ‚åº¦ O(n2n^2n2)
å› æ­¤æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n2n^2n2)
å­—ç¬¦ä¸²å“ˆå¸Œ
å‡è®¾æœ‰ n ä¸ªé•¿åº¦ä¸º L çš„å­—ç¬¦ä¸²ï¼Œé—®å…¶ä¸­æœ€å¤šæœ‰å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ç›¸ç­‰çš„ã€‚
ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªé•¿åº¦ä¸º L çš„å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰æ—¶é—´å¤æ‚åº¦æ˜¯O(L) çš„ã€‚
å› æ­¤éœ€è¦æšä¸¾ O(n2) å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œæ—¶é—´å¤æ‚åº¦ O(n2Ln^2Ln2L)
å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸ªå­—ç¬¦ä¸²éƒ½ç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°æ˜ å°„æˆä¸€ä¸ªæ•´æ•°ã€‚
é—®é¢˜å°±å˜æˆäº†æŸ¥æ‰¾ä¸€ä¸ªåºåˆ—çš„ä¼—æ•°ã€‚
æ—¶é—´å¤æ‚åº¦å˜ä¸ºäº† O(nL)
ä¸€ä¸ªè®¾è®¡è‰¯å¥½çš„å­—ç¬¦ä¸²å“ˆå¸Œå‡½æ•°å¯ä»¥è®©æˆ‘ä»¬å…ˆç”¨ O(L) çš„æ—¶é—´å¤æ‚åº¦é¢„å¤„ç†ï¼Œä¹‹åæ¯æ¬¡è·å–è¿™ä¸ªå­—ç¬¦ä¸²çš„ä¸€ä¸ªå­ä¸²çš„å“ˆå¸Œå€¼éƒ½åªè¦ O(1) çš„æ—¶é—´ã€‚
BKDRHash çš„åŸºæœ¬æ€æƒ³å°±æ˜¯æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å½“åšä¸€ä¸ª k è¿›åˆ¶æ•°æ¥å¤„ç†
å‡è®¾å­—ç¬¦ä¸² s çš„ä¸‹æ ‡ä» 1 å¼€å§‹ï¼Œé•¿åº¦ä¸º n
ha[0] = 0;
    for (int i = 1;i &amp;lt;= n;i ++)
        ha[i] = (ha[i - 1] * P + str[i]) % M;

æˆ‘ä»¬çŸ¥é“ ha[i] å°±æ˜¯ s[1..i] çš„ BKDRHash
é‚£ä¹ˆç°åœ¨è¯¢é—® s[x..y] çš„ BKDRHash ï¼Œ

å› æ­¤æˆ‘ä»¬é¢„å¤„ç†å‡º ha æ•°ç»„å’Œ k çš„å¹‚æ¬¡ï¼Œæ¯æ¬¡è¯¢é—® s[x..y]çš„å“ˆå¸Œå€¼ï¼Œåªè¦ O(1) çš„æ—¶é—´ã€‚
ç»éªŒå€¼ï¼Œk=131ï¼ŒM=2642^{64}264
æ¨¡æ¿é¢˜
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
typedef unsigned long long ULL;
const int N = 100010, P = 131;
int n, m;
char str[N];
ULL h[N], p[N];

ULL get(int l, int r)
{
    return h[r] - h[l - 1] * p[r - l + 1];
}

int main()
{
    scanf(&amp;quot;%d%d&amp;quot;, &amp;amp;n, &amp;amp;m);
    scanf(&amp;quot;%s&amp;quot;, str + 1);

    p[0] = 1;
    for (int i = 1; i &amp;lt;= n; i ++ )
    {
        h[i] = h[i - 1] * P + str[i];
        p[i] = p[i - 1] * P;
    }

    while (m -- )
    {
        int l1, r1, l2, r2;
        scanf(&amp;quot;%d%d%d%d&amp;quot;, &amp;amp;l1, &amp;amp;r1, &amp;amp;l2, &amp;amp;r2);

        if (get(l1, r1) == get(l2, r2)) puts(&amp;quot;Yes&amp;quot;);
        else puts(&amp;quot;No&amp;quot;);
    }

    return 0;
}

ä¾‹é¢˜
acwing160
æ ¸å¿ƒé—®é¢˜å°±æ˜¯ï¼š
ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² Aï¼ŒBã€‚æ±‚å‡º A çš„æ¯ä¸ªåç¼€å­ä¸²å’Œ B çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚
æ ‡å‡†åšæ³•æ˜¯æ‰©å±• KMPï¼Œæ—¶é—´å¤æ‚åº¦çº¿æ€§ã€‚
æˆ‘ä»¬æ¥ç”¨ Hash è¯•è¯•çœ‹
å‰é¢å·²ç»æåˆ°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ O(n)é¢„å¤„ç† O(1)å¤„ç†å‡ºä¸€ä¸ªå­ä¸²çš„å“ˆå¸Œå€¼ã€‚
æ±‚å­—ç¬¦ä¸² A[i..n] ä¸å­—ç¬¦ä¸² B[1..m] çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Ÿ
äºŒåˆ†é•¿åº¦ mid
è®¡ç®—å‡º A[i..i+mid-1] å’Œ B[1..mid] çš„å“ˆå¸Œå€¼ï¼Œæ¯”è¾ƒæ˜¯å¦ç›¸ç­‰ã€‚
å› æ­¤æ—¶é—´å¤æ‚åº¦æ˜¯ O(nlog n) çš„
#include &amp;lt;iostream&amp;gt;
#include &amp;lt;algorithm&amp;gt;
using namespace std;
typedef unsigned long long ULL;
const int N = 200010, P = 131;
int n, m,q;
char a[N];
char b[N];
ULL ha[N],hb[N],p[N];
int cnt[N];

ULL get(ULL h[],int l, int r)
{
    return h[r] - h[l - 1] * p[r - l + 1];
}

int main()
{
    scanf(&amp;quot;%d%d%d&amp;quot;, &amp;amp;n, &amp;amp;m,&amp;amp;q);
    scanf(&amp;quot;%s&amp;quot;, a + 1);
    scanf(&amp;quot;%s&amp;quot;,b+1);

    p[0] = 1;
    for(int i=1;i&amp;lt;=max(n,m);i++)
        p[i]=p[i-1]*P;
    for(int i=1;i&amp;lt;=n;i++)
        ha[i]=ha[i-1]*P+a[i];
    for(int i=1;i&amp;lt;=m;i++)
        hb[i]=hb[i-1]*P+b[i];
    
    for(int i=1;i&amp;lt;=n;i++)
    {
        int l=0,r=min(m,n-i+1);

        while(l&amp;lt;r)
        {
            int mid=l+r+1&amp;gt;&amp;gt;1;
            if(get(ha,i,i+mid-1) == get(hb,1,mid))
                l=mid;
            else
                r=mid-1;
        }
        cnt[l]++;
    }
    while(q--)
    {
        int x;
        scanf(&amp;quot;%d&amp;quot;,&amp;amp;x);
        printf(&amp;quot;%d\n&amp;quot;,cnt[x]);
    }

    return 0;
}

poj2774
ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tï¼Œæ±‚å®ƒä»¬çš„æœ€é•¿å…¬å…±å­ä¸²ã€‚|S|, |T| â‰¤ 1e5
æ€è·¯
åŸå§‹çš„ DP åšæ³•ï¼ˆæœ€é•¿å…¬å…±å­åºåˆ—ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦ O(n^2)
æˆ‘ä»¬å¯ä»¥äºŒåˆ†ç­”æ¡ˆ lenã€‚ç„¶åè®¡ç®— S å’Œ T ä¸­æ‰€æœ‰é•¿åº¦ä¸º len çš„å­ä¸²çš„å“ˆå¸Œå€¼ã€‚
è¿™ä¸€æ­¥æ˜¯ O(n) çš„ã€‚
ç„¶åæ¯”è¾ƒ S çš„å“ˆå¸Œå€¼é›†åˆä¸­å’Œ T çš„å“ˆå¸Œå€¼é›†åˆä¸­æœ‰æ²¡æœ‰ç›¸åŒçš„å…ƒç´ ã€‚
å¯ä»¥å†é€šè¿‡ä¸€æ­¥å“ˆå¸Œæ‰¾ç›¸åŒçš„å€¼ã€‚è¿™æ ·æ€»å…±ä»ç„¶æ˜¯ O(n)ã€‚
æ€»çš„æ—¶é—´å¤æ‚åº¦å°±æ˜¯ O(n log n)
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;vector&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=100010,P=131;
char a[N],b[N];
typedef unsigned long long ULL;
ULL ha[N],hb[N],p[N];
vector&amp;lt;ULL&amp;gt; v;
int la,lb;

ULL get(ULL h[],int l,int r)
{
	return h[r]-h[l-1]*p[r-l+1];
}

bool check(int mid)
{
	v.clear();
	for(int i=mid;i&amp;lt;=la;i++)
		v.push_back(get(ha,i-mid+1,i));
	
	sort(v.begin(),v.end());
	for(int i=mid;i&amp;lt;=lb;i++)
	{
		ULL t=get(hb,i-mid+1,i);
		if(binary_search(v.begin(),v.end(),t))
			return true;
	}
	return false;
}

int main()
{
	scanf(&amp;quot;%s%s&amp;quot;,a+1,b+1);
	la=strlen(a+1);
	lb=strlen(b+1);
	
	p[0]=1;
	for(int i=1;i&amp;lt;=max(la,lb);i++)
		p[i]=p[i-1]*P;
	for(int i=1;i&amp;lt;=la;i++)
		ha[i]=ha[i-1]*P+a[i];
	for(int i=1;i&amp;lt;=lb;i++)
		hb[i]=hb[i-1]*P+b[i];
		
	int l=0,r=1e5;
	while(l&amp;lt;r)
	{
		int mid=l+r+1&amp;gt;&amp;gt;1;
		if(check(mid))
			l=mid;
		else
			r=mid-1;
	}
	printf(&amp;quot;%d\n&amp;quot;,l);
	return 0;
}

ä¹Ÿå¯æ‰‹å†™å“ˆå¸Œè¡¨ï¼šä»£ç 
Codeforces 580E
ç»™å‡ºä¸€ä¸ªæ•°å­—ä¸²ï¼Œç°åœ¨æœ‰ä¸¤ç§æ“ä½œï¼š
1: l r d: å°†[l,r] ä¸­çš„æ‰€æœ‰æ•°å­—éƒ½æ”¹ä¸º d
2: l r dï¼šè¯¢é—®[l,r]è¿™ä¸ªå­ä¸²çš„å‘¨æœŸæ˜¯å¦ä¸º dã€‚ 1 &amp;lt;= n &amp;lt;= 1e5
é¦–å…ˆæ€è€ƒå¯¹äºä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œå¦‚ä½•åˆ¤æ–­å®ƒçš„å‘¨æœŸæ˜¯ä¸æ˜¯ dï¼Ÿ
æ¯”å¦‚ä¸² ababab çš„å‘¨æœŸæ˜¯ 2 ä¸² abcabc çš„å‘¨æœŸæ˜¯ 3 ä¸² abcde çš„å‘¨æœŸæ˜¯ 5
å‡è®¾ S çš„é•¿åº¦ä¸º nã€‚
åªè¦åˆ¤æ–­ S[1..n-d+1] å’Œ S[d+1..n]æ˜¯å¦ç›¸ç­‰å³å¯ã€‚


#include&amp;lt;iostream&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
#define lc u&amp;lt;&amp;lt;1
#define rc u&amp;lt;&amp;lt;1|1
int n,m,k;
const int N=100010,P=131,mod=1e9+7;
char s[N];
typedef long long LL;
struct Node
{
	int l,r;
	int tag;
	LL key;
}tr[N&amp;lt;&amp;lt;2];
LL h[N],p[N];//p[i]è¡¨ç¤ºpçš„iæ¬¡æ–¹ï¼Œh[i]è¡¨ç¤ºè¿ç»­iä¸ª1çš„å­—ç¬¦ä¸²çš„hashå€¼

void pushup(int u,int k)
{
	tr[u].key=((tr[lc].key*p[k])%mod+tr[rc].key)%mod;
}

void pushdown(int u)
{
	if(tr[u].tag)
	{
		int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1,l=tr[u].l,r=tr[u].r;
		tr[lc].key=(tr[u].tag*h[mid-l+1])%mod;
		tr[lc].tag=tr[u].tag;
		tr[rc].key=(tr[u].tag*h[r-mid])%mod;
		tr[rc].tag=tr[u].tag;
		tr[u].tag=0;
	}
}

void build(int u,int l,int r)
{
	if(l == r)
	{
		tr[u]={l,r,0,s[l]-&#39;0&#39;+1};
		return;
	}
	tr[u]={l,r};
	int mid=l+r&amp;gt;&amp;gt;1;
	build(lc,l,mid);
	build(rc,mid+1,r);
	pushup(u,r-mid);
}

void modify(int u,int l,int r,int d)
{
	if(l &amp;lt;= tr[u].l &amp;amp;&amp;amp; tr[u].r &amp;lt;= r)
	{
		tr[u].key=(d*h[tr[u].r-tr[u].l+1])%mod;
		//cout&amp;lt;&amp;lt;&amp;quot;-----&amp;quot;&amp;lt;&amp;lt;u&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].key&amp;lt;&amp;lt;endl;
		tr[u].tag=d;
		return;
	}
	pushdown(u);
	int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1;
	if(l &amp;lt;= mid)
		modify(lc,l,r,d);
	if(r &amp;gt; mid)
		modify(rc,l,r,d);
	pushup(u,tr[u].r-mid);
}

int query(int u,int l,int r)
{
	if(tr[u].l == l &amp;amp;&amp;amp; tr[u].r == r)
		return tr[u].key;
	pushdown(u);
	int mid=tr[u].l+tr[u].r&amp;gt;&amp;gt;1;
	if(r&amp;lt;=mid)
		return query(lc,l,r);
	else if(l&amp;gt;mid)
		return query(rc,l,r);
	else 
		return (query(lc,l,mid)*p[r-mid]%mod+query(rc,mid+1,r))%mod;
}

void print(int u)
{
	if(tr[u].key)
	{
		cout&amp;lt;&amp;lt;&amp;quot;--&amp;quot;&amp;lt;&amp;lt;u&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].l&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].r&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;tr[u].key&amp;lt;&amp;lt;endl;
		print(lc);
		print(rc);
	}
}

int main()
{
	scanf(&amp;quot;%d%d%d&amp;quot;,&amp;amp;n,&amp;amp;m,&amp;amp;k);
	scanf(&amp;quot;%s&amp;quot;,s+1);
	
	p[0]=1;
	for(int i=1;i&amp;lt;=n;i++)
	{
		h[i]=(h[i-1]*P%mod+1)%mod;
		p[i]=p[i-1]*P%mod;
	}

	build(1,1,n);
	
	m+=k;
	while(m--)
	{
		int t,l,r,d;
		scanf(&amp;quot;%d%d%d%d&amp;quot;,&amp;amp;t,&amp;amp;l,&amp;amp;r,&amp;amp;d);
		if(t == 1)
			modify(1,l,r,d+1);//åŠ ä¸€å¤„ç†ï¼Œé˜²æ­¢dä¸º0
		else
		{
			if(d == r - l + 1)
			{
                printf(&amp;quot;YES\n&amp;quot;);
                continue;
            }
			if(query(1,l,r-d) == query(1,l+d,r))
				puts(&amp;quot;YES&amp;quot;);
			else
				puts(&amp;quot;NO&amp;quot;);
		}
		//print(1);
	}
	return 0;
}

å‘ï¼šç¬¬75ç»„æ•°ç»„å¡æ— ç¬¦å·64ä½è‡ªåŠ¨æº¢å‡ºçš„hash,é˜²ullæº¢å‡ºçš„è§£å†³æ–¹æ³•æ˜¯å–æ¨¡
Codeforces 955D
ç»™å‡ºä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tã€‚ä½ éœ€è¦åœ¨ S ä¸­é€‰å‡ºä¸¤ä¸ªä¸ç›¸äº¤çš„é•¿åº¦ä¸º k çš„å­ä¸²ï¼Œä½¿å¾—ä»–ä»¬æ‹¼èµ·æ¥ä¹‹ååŒ…å« Tã€‚
|T| â‰¤ 2k â‰¤ |S| â‰¤ 5Â·1e5

æ ·ä¾‹ï¼š ï¼ˆç­”æ¡ˆï¼šYes 1 5ï¼‰
7 4 3
baabaab
aaaa
KMP


æˆ‘ä»¬ç”¨å½¢å¼åŒ–çš„è¯­è¨€æ¥è¿›è¡Œæè¿°ã€‚
å‡è®¾ç°åœ¨ T[s+1..s+k] å’Œ P[1..k] åŒ¹é…ä¸Šäº†ã€‚
æ­¤æ—¶ T[s+k+1] != P[k+1]ã€‚
æœ´ç´ çš„åšæ³•æ˜¯ï¼šå›åˆ° T[s + 2] å’Œ P[1] é‡æ–°å¼€å§‹æ¯”è¾ƒã€‚
KMPç®—æ³•ï¼šæ‰¾åˆ°ä¸€ä¸ªæœ€å¤§çš„ xï¼Œä½¿å¾— T[s+1..s+k] çš„å xä¸ªå­—ç¬¦ï¼Œå’Œ P çš„å‰ x ä¸ªå­—ç¬¦ç›¸åŒã€‚
è¿™éƒ¨åˆ†å°±æ˜¯èƒ½åŒ¹é…ä¸Šçš„ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨é€ä¸ªåˆ¤æ–­ã€‚
åˆæ³¨æ„åˆ° T[s+1..s+k] = P[1..k]
é‚£ä¹ˆæˆ‘ä»¬è¦æ±‚çš„å°±æ˜¯ä¸€ä¸ªæœ€å¤§çš„ xï¼Œæ»¡è¶³ P[1..k] çš„å‰ xä¸ªå­—ç¬¦ç­‰äºå®ƒçš„å x ä¸ªå­—ç¬¦ã€‚å½“ç„¶ x è¦å°äº kã€‚
è¿™ä¸ª x è®°ä¸º next[k]
å¯¹äº P = ababaca
æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºnextæ•°ç»„ï¼š

æœ‰äº† next æ•°ç»„ï¼Œç°åœ¨å¦‚ä½•åŒ¹é…ä¸¤ä¸ªå­—ç¬¦ä¸²å‘¢ï¼Ÿ
for (int i = 1, j = 0; i &amp;lt;= m; i ++ )
{
    while (j &amp;amp;&amp;amp; s[i] != p[j + 1]) j = ne[j];
    if (s[i] == p[j + 1]) j ++ ;
    if (j == n)
    {
        printf(&amp;quot;%d &amp;quot;, i - n);
        j = ne[j];
    }
}


è®²è¿‡å¦‚ä½•åŒ¹é…ä¹‹åï¼Œæˆ‘ä»¬è¿˜è¦ä¼šé«˜æ•ˆè®¡ç®— next æ•°ç»„ã€‚
è®¡ç®— next æ•°ç»„çš„è¿‡ç¨‹å°±æ˜¯æ‹¿ P å’Œ P è‡ªå·±åŒ¹é…çš„è¿‡ç¨‹ã€‚
åªä¸è¿‡è¦åœ¨åŒ¹é…çš„è¿‡ç¨‹ä¸­ï¼Œè®°å½•æ¯ä¸ªä½ç½®ä¸‹æŒ‡é’ˆæŒ‡å‘çš„ä½ç½®ï¼Œä½œä¸º next æ•°ç»„ã€‚
for (int i = 2, j = 0; i &amp;lt;= n; i ++ )
{
    while (j &amp;amp;&amp;amp; p[i] != p[j + 1]) j = ne[j];
    if (p[i] == p[j + 1]) j ++ ;
    ne[i] = j;
}

KMPç®—æ³•å¤æ‚åº¦
æ—¶é—´å¤æ‚åº¦ï¼šO(n)
ç©ºé—´å¤æ‚åº¦ï¼šO(n)
ä¾‹é¢˜
poj2406
ç»™ä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œæ±‚ S çš„ä¸€ä¸ªæœ€çŸ­çš„å¾ªç¯èŠ‚ eï¼Œä½¿å¾— S å¯ä»¥å†™æˆ eeeâ€¦eee ï¼ˆå…±|S|/|e|ä¸ª eï¼‰
è¾“å‡º |S|/|e| çš„æœ€å¤§å€¼ã€‚|S| â‰¤ 1e6

æ ·ä¾‹ï¼š
abcd ï¼ˆç­”æ¡ˆï¼š1ï¼‰
aaaa ï¼ˆç­”æ¡ˆï¼š4ï¼‰
ababab ï¼ˆç­”æ¡ˆï¼š3ï¼‰
å‡è®¾è¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸º len
å¦‚æœ len å¯ä»¥è¢« len-next[len] æ•´é™¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è¯´len-next[len] æ˜¯é‚£ä¸ªå¾ªç¯èŠ‚çš„é•¿åº¦ã€‚
å› ä¸º next[len] å°±è¡¨ç¤º: S[1..next[len]] = S[next[len] + 1..len]
å¯ä»¥è¯æ˜æ»¡è¶³è¿™ä¸€æ¡æ€§è´¨çš„å­—ç¬¦ä¸²å…·æœ‰é•¿åº¦ä¸º len-next[len] çš„å¾ªç¯å‘¨æœŸ
å¦åˆ™ç­”æ¡ˆå°±æ˜¯ 1 äº†ã€‚
å› ä¸ºå¦‚æœå­˜åœ¨ä¸€ä¸ªé•¿åº¦ä¸º d çš„å¾ªç¯èŠ‚ï¼Œé‚£ä¸€å®šæ»¡è¶³ï¼š
S[1..len-d+1] == S[d + 1 .. len]
ä½†æ˜¯ç°åœ¨å¾ªç¯èŠ‚çš„é•¿åº¦åªèƒ½æ˜¯ len-next[len],å¦‚æœå®ƒä¸æ˜¯ len çš„å› å­ï¼Œé‚£å°±æ²¡æœ‰å¯èƒ½äº†ã€‚
æ—¶é—´å¤æ‚åº¦ O(n)

å®šç†ï¼šå‡è®¾Sçš„é•¿åº¦ä¸ºlenï¼Œåˆ™Så­˜åœ¨æœ€å°å¾ªç¯èŠ‚ï¼Œå¾ªç¯èŠ‚çš„é•¿åº¦Lä¸ºlen-next[len]ï¼Œå­ä¸²ä¸ºS[0â€¦len-next[len]-1]ã€‚
ï¼ˆ1ï¼‰å¦‚æœlenå¯ä»¥è¢«len - next[len]æ•´é™¤ï¼Œåˆ™è¡¨æ˜å­—ç¬¦ä¸²Så¯ä»¥å®Œå…¨ç”±å¾ªç¯èŠ‚å¾ªç¯ç»„æˆï¼Œå¾ªç¯å‘¨æœŸT=len/Lã€‚
ï¼ˆ2ï¼‰å¦‚æœä¸èƒ½ï¼Œè¯´æ˜è¿˜éœ€è¦å†æ·»åŠ å‡ ä¸ªå­—æ¯æ‰èƒ½è¡¥å…¨ã€‚éœ€è¦è¡¥çš„ä¸ªæ•°æ˜¯å¾ªç¯ä¸ªæ•°L-len%L=L-(len-L)%L=L-next[len]%Lï¼ŒL=len-next[len]ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=1e6+10;
char s[N];
int ne[N];
int n;

int main()
{
	while(scanf(&amp;quot;%s&amp;quot;,s+1))
	{
		if(s[1] == &#39;.&#39;)
			break;
		
		n=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
		
		int t=n-ne[n];
		if(n%t == 0)
			cout&amp;lt;&amp;lt;n/t&amp;lt;&amp;lt;endl;
		else
			cout&amp;lt;&amp;lt;1&amp;lt;&amp;lt;endl;
	}
	return 0;
}

poj2752
ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² Sï¼Œæ±‚å‡º S ä¸­æ‰€æœ‰çš„æ—¢æ˜¯å‰ç¼€åˆæ˜¯åç¼€çš„å­ä¸²ã€‚è¾“å‡º i ä»£è¡¨ S[1..i]|S| â‰¤ 400000

æ ·ä¾‹ï¼š
ababcababababcababï¼ˆç­”æ¡ˆï¼š2 4 9 18ï¼‰
aaaaaï¼ˆç­”æ¡ˆï¼š1 2 3 4 5ï¼‰
æ±‚å‡º next æ•°ç»„ã€‚
ç­”æ¡ˆå°±æ˜¯ len, next[len], next[next[len]], â€¦

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=4e5+10;
char s[N];
int ne[N];
int ans[N];

int main()
{
	while(~scanf(&amp;quot;%s&amp;quot;,s+1))
	{
		int n=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
	
		int t=ne[n],cnt=0;
		while(t)
		{
			ans[cnt++]=t;
			t=ne[t];
		}
		
		for(int i=cnt-1;i&amp;gt;=0;i--)
			printf(&amp;quot;%d &amp;quot;,ans[i]);
		printf(&amp;quot;%d\n&amp;quot;,n);

	}
	return 0;
}

hdu2594
æ±‚å‡ºæœ€é•¿çš„æ—¢æ˜¯ s1 çš„å‰ç¼€åˆæ˜¯ s2 çš„åç¼€çš„å­ä¸²ã€‚

æ ·ä¾‹ï¼š
riemann
marjorie
ç­”æ¡ˆï¼šrie
åªè¦æŠŠä¸¤ä¸ªä¸²æ‹¼èµ·æ¥ï¼Œä¸­é—´ç”¨ä¸€ä¸ªåˆ†éš”ç¬¦,s1,s1,s1s2,ä»¤len=strlen(s1$s2),åˆ™next[len]å³ä¸ºç­”æ¡ˆ
ä¹Ÿå¯ä¸åŠ åˆ†éš”ç¬¦ï¼Œæšä¸¾ len, next[len], next[next[len]] ......æ‰¾åˆ°å°äº min(|s1|, |s2|) çš„æœ€å¤§å€¼å³å¯ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=50010*2;//æ•°ç»„å¼€ä¸¤å€!
char s1[N],s2[N];
int ne[N];

int main()
{
	while(~scanf(&amp;quot;%s%s&amp;quot;,s1+1,s2+1))
	{
		strcat(s1+1,&amp;quot;$&amp;quot;);
		strcat(s1+1,s2+1);
		int n=strlen(s1+1);
		for(int i=2,j=0;i&amp;lt;=n;i++)
		{
			while(j &amp;amp;&amp;amp; s1[i] != s1[j+1])
				j=ne[j];
			if(s1[i] == s1[j+1])
				j++;
			ne[i]=j;
		}
		
		int ans=ne[n];
		s1[ans+1]=&#39;\0&#39;;
		if(ans == 0)
			printf(&amp;quot;0\n&amp;quot;);
		else 
			printf(&amp;quot;%s %d\n&amp;quot;,s1+1,ans);
	}
}

Codeforces 526D
ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸² sï¼Œåˆ¤æ–­å…¶æ¯ä¸ªå‰ç¼€æ˜¯å¦å¯ä»¥è¡¨ç¤ºæˆABABâ€¦ABA çš„å½¢å¼ï¼ˆA å’Œ B éƒ½å¯ä»¥ä¸ºç©ºï¼Œ ä½†æ˜¯å¿…é¡»æ»¡è¶³ A æœ‰ k+1 ä¸ªï¼ŒB æœ‰ k ä¸ªï¼‰
|s|, k â‰¤ 1e6

è¾“å…¥
7 2
bcabcab
è¾“å‡º
0000011
é•¿åº¦ä¸º 6 çš„å‰ç¼€ï¼Œå¯ä»¥å– A=â€œâ€,B=â€œbcaâ€
é•¿åº¦ä¸º 7 çš„å‰ç¼€ï¼Œå¯ä»¥å– A=â€œbâ€, B=â€œcaâ€
å¯¹äºå‰ç¼€ Pï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ P æ‹†æˆ SSSSâ€¦STï¼Œå…¶ä¸­ T æ˜¯ Sçš„å‰ç¼€ã€‚
è¿™æ ·å°±å¯ä»¥ç”¨ KMP æ¥åšäº†ã€‚
é¦–å…ˆ i-next[i] å°±æ˜¯S[1..i] è¿™ä¸€æ®µçš„æœ€å°å¾ªç¯èŠ‚çš„é•¿åº¦ï¼Œ
è®°ä¸º eã€‚
å¯ä»¥å‘ç° e çš„å€æ•° je ä¹Ÿæ˜¯å¾ªç¯èŠ‚ã€‚

#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cmath&amp;gt;
#include&amp;lt;cstring&amp;gt;
using namespace std;
const int N=1e6+10;
char s[N];
int n,k;
int ne[N];

bool check(int i,int cir)
{
	int up=i/k/cir;
	int down=ceil((i/(k+1)+1)/(1.0*cir));
	return up&amp;gt;=down || (i % (k+1) == 0 &amp;amp;&amp;amp; (i / (k+1)) % cir == 0);
}

int main()
{
	while(~scanf(&amp;quot;%d%d&amp;quot;,&amp;amp;n,&amp;amp;k))
	{
		scanf(&amp;quot;%s&amp;quot;,s+1);
		
		int len=strlen(s+1);
		for(int i=2,j=0;i&amp;lt;=len;i++)
		{
			while(j &amp;amp;&amp;amp; s[i] != s[j+1])
				j=ne[j];
			
			if(s[i] == s[j+1])
				j++;
			ne[i]=j;
		}
		
		for(int i=1;i&amp;lt;=n;i++)
		{
			int cir=i-ne[i];
			printf(&amp;quot;%d&amp;quot;,check(i,cir));
		}
	}
}

acwing
é¦–å…ˆæˆ‘ä»¬ç”¨KMPæ±‚å‡º T çš„ nextæ•°ç»„ã€‚
åˆ©ç”¨ nextæ•°ç»„åœ¨é•¿æ–‡æœ¬ä¸­åŒ¹é…æ¨¡æ¿ä¸² Tçš„è¿‡ç¨‹ï¼šå¦‚æœä¸‹ä¸€ä¸ªå­—æ¯ä¸åŒ¹é…ï¼Œéœ€è¦ä¸€ç›´æ²¿ç€nextæŒ‡é’ˆæ‰¾ï¼šj = next[j]ï¼Œç›´åˆ°ä¸‹ä¸€ä¸ªå­—ç¬¦åŒ¹é…æˆ–è€…nextæŒ‡é’ˆæŒ‡å‘å¼€å¤´ä¸ºæ­¢ã€‚
ç„¶åæˆ‘ä»¬ä¼šå‘ç°ï¼Œå‡è®¾æˆ‘ä»¬å·²ç»åŒ¹é…å®Œé•¿æ–‡æœ¬çš„å‰ä¸ªå­—æ¯ï¼Œåˆ™å‰©ä¸‹éƒ¨åˆ†çš„åŒ¹é…è¿‡ç¨‹ï¼Œåªè·ŸnextæŒ‡é’ˆçš„ä½ç½®æœ‰å…³ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨äºŒç»´æ•°ç»„æ¥è¡¨ç¤ºå½“å‰çŠ¶æ€çš„æ–¹æ¡ˆæ•°ï¼š
f[i][j]è¡¨ç¤ºåŒ¹é…å®Œå‰ i ä¸ªå­—æ¯æ—¶ï¼ŒnextæŒ‡é’ˆåœ¨ j æ—¶çš„æ–¹æ¡ˆæ€»æ•°ã€‚
çŠ¶æ€è½¬ç§»ï¼šå¯¹äºæ¯ä¸ªçŠ¶æ€f[i][j]ï¼Œæˆ‘ä»¬ä»&#39;a&#39;-&#39;z&#39;æšä¸¾ä¸‹ä¸€ä¸ªå­—æ¯ï¼Œç„¶åæ±‚å‡ºå¯¹åº”çš„nextæŒ‡é’ˆï¼Œå‡è®¾æ˜¯ï¼Œåˆ™å°†f[i][j]çš„æ–¹æ¡ˆæ€»æ•°ç´¯åŠ åˆ°f[i+1][u]ã€‚
è½¬ç§»è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„ï¼Œå› ä¸ºå¯†ç ä¸­ä¸èƒ½å­˜åœ¨ Tï¼Œæ‰€ä»¥nextæŒ‡é’ˆè¦é¿å…è½¬ç§»åˆ° Tçš„æœ€åä¸€ä¸ªå­—æ¯ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt; 
using namespace std;
const int N=55,mod=1e9+7;
int f[N][N];
int edge[N][26];
char p[N];
int ne[N];
int n;


int main()
{
    cin&amp;gt;&amp;gt;n&amp;gt;&amp;gt;p+1;
    int m=strlen(p+1);
    
    for(int i=2,j=0;i&amp;lt;=m;i++)
    {
        while(j &amp;amp;&amp;amp; p[i] != p[j+1])
            j=ne[j];
        if(p[i] == p[j+1])
            j++;
        ne[i]=j;
    }
    
    for(int i=0;i&amp;lt;m;i++)
        for(char k=&#39;a&#39;;k&amp;lt;=&#39;z&#39;;k++)
        {
            int j=i;//å·²åŒ¹é…äº†å‰iä¸ªå­—æ¯
            while(j &amp;amp;&amp;amp; p[j+1] != k)
                j=ne[j];
            if(p[j+1] == k)
                j++;
            edge[i][k-&#39;a&#39;]=j;
        }
        
    f[0][0]=1;
    for(int i=0;i&amp;lt;n;i++)
        for(int j=0;j&amp;lt;m;j++)
            for(char k=&#39;a&#39;;k&amp;lt;=&#39;z&#39;;k++)
            {
                int u=edge[j][k-&#39;a&#39;];
                f[i+1][u]=(f[i+1][u]+f[i][j])%mod;
            }
            
    int res = 0;
    for (int i = 0; i &amp;lt; m; i ++ ) res = (res + f[n][i]) % mod;

    cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; endl;

    return 0;
}

luoguP3193
è®¾f(i,j)è¡¨ç¤ºä»¥å‡†è€ƒè¯å·ä¸ºåŸºå‡†é€’æ¨ï¼Œå‡†è€ƒè¯å·åŒ¹é…åˆ°ç¬¬iä½ï¼Œä¸å‰åˆ©æ•°å­—åŒ¹é…åˆ°ç¬¬jä½æ—¶ï¼ˆå³å‡†è€ƒè¯çš„åjä½ç­‰äºä¸å‰åˆ©æ•°å­—çš„å‰jä½ï¼‰ï¼Œä¸å‡ºç°ä¸å‰åˆ©æ•°å­—çš„å­—ç¬¦ä¸²æ•°é‡ã€‚ã€‚
é‚£æ€ä¹ˆè½¬ç§»ï¼Ÿ
æ—¢ç„¶è¦ä»¥è€ƒå·ä¸ºåŸºå‡†é€’æ¨ï¼Œå°±è¦è€ƒè™‘ä¸€ä½è€ƒå·å¯¹ä¸‹ä¸€ä½çš„å½±å“ã€‚
è€Œè€ƒå·æ˜¯å¯ä»¥éšä¾¿å†™çš„ï¼Œé‚£æˆ‘ä»¬å°±è¦è€ƒè™‘10ç§æ•°å­—äº†ã€‚
å¯¹äºä¸€ä¸ªæ–°æ•°å­—newï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š
1.new
ä¸ä¸å‰åˆ©æ•°å­—çš„j+1ä½åŒ¹é…ï¼Œdp(i+1,j+1)çš„ç­”æ¡ˆæ•°+dp(i,j)
2.ä¸Šè¿°ä¸¤è€…ä¸åŒ¹é…ã€‚
ä¸åŒ¹é…æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªä¸åŒ¹é…çš„newä¸€å®šæ²¡æœ‰è´¡çŒ®äº†ï¼Ÿ
å½“ç„¶ä¸ä¸€å®šã€‚
æ€ä¹ˆè®²å‘¢ï¼Œä¸¾ä¸ªä¾‹å­å§ï¼Œä¸å‰åˆ©æ•°å­—æ˜¯12212112ã€‚ç„¶åä½ çš„å‡†è€ƒè¯å·æšä¸¾åˆ°ç¬¬9ä½æ—¶ï¼Œå‰é¢8ä½å·²ç»æšä¸¾æˆäº†11112212ã€‚å¯ä»¥å‘ç°å·²ç»åŒ¹é…äº†ä¸å‰åˆ©æ•°å­—çš„å‰5ä½ï¼Œç°åœ¨è¦åŒ¹é…ç¬¬6ä½ã€‚
å¦‚æœç¬¬9ä½æšä¸¾1ï¼Œé‚£å®ƒå°±åŒ¹é…äº†ï¼Œdp(9,6)+=dp(8,5)ã€‚å¦‚æœç¬¬9ä½æšä¸¾2ï¼Œé‚£å®ƒå°±ä¸åŒ¹é…ã€‚ä½†æ˜¯ä¼šå‘ç°ï¼Œå­˜åœ¨ ä¸å½“å‰å·²åŒ¹é…çš„ä¸å‰åˆ©æ•°å­—çš„åç¼€ç›¸åŒ çš„å‰ç¼€ï¼Œå¯ä»¥åŒ¹é…ä¸Šè¿™ä¸ª2ï¼
ä¸Šä¸€ä¸ªä½ç½®å°±æ˜¯ä¸å‰åˆ©æ•°å­—çš„ç¬¬2ä½ã€‚
å®ƒçš„ä¸‹ä¸€ä½ï¼Œç¬¬3ä½2ï¼Œåˆšå¥½å¯ä»¥åŒ¹é…æšä¸¾çš„ç¬¬9ä½ï¼
æ‰€ä»¥æ­¤æ—¶æœ€å¤šèƒ½åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰3ä½ï¼Œæœ‰è½¬ç§»dp(9,3)+=dp(8,5)ã€‚
æˆ‘ä»¬åªéœ€è¦æ²¿ç€ä¸å‰åˆ©æ•°å­—çš„å¤±é…æŒ‡é’ˆå¾€å‰èµ°ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸‹ä¸€ä½ä¸newåŒ¹é…çš„ä½ç½®å°±å¯ä»¥äº†ã€‚
ä¸ºä»€ä¹ˆä¸ç”¨è€ƒè™‘å†å¾€å‰çš„ä¸‹ä¸€ä½å¯ä»¥åŒ¹é…newçš„ä½ç½®ï¼Ÿ
å› ä¸ºè¿™æ˜¯é€’æ¨ï¼Œä»å‰å¾€åæ¯ä¸€ç§çŠ¶æ€éƒ½ä¼šè¢«è€ƒè™‘ï¼Œæ‰€ä»¥åœ¨è€ƒè™‘åŒ¹é…åé¢çš„ä½ä¹‹å‰ï¼Œå‰é¢çš„ä½å·²ç»åŒ¹é…å¥½æ›´å‰é¢çš„æƒ…å†µäº†ã€‚
æ¯”å¦‚ä¸å‰åˆ©æ•°å­—1221221211ã€‚ä½ ç›®å‰æšä¸¾çš„å‡†è€ƒè¯å·å‰8ä½æ˜¯12212212ï¼Œç°åœ¨ä½ è¦æšä¸¾ç¬¬9
ä½ã€‚å¾ˆæ˜æ˜¾å½“æšä¸¾2æ—¶ï¼Œé€šè¿‡æ‰¾ä¸å‰åˆ©æ•°å­—ä¸­ åç¼€ç›¸åŒçš„å‰ç¼€ï¼Œå¯çŸ¥dp(8,8)å¯ä»¥è½¬ç§»åˆ°dp(9,6)ã€‚
ä½†æ˜¯æˆ‘ä»¬å‘ç°ä¹Ÿå¯ä»¥è½¬ç§»åˆ°dp(9,3)è¯¶ï¼
äº‹å®ä¸Šï¼Œåœ¨è¿™ä¹‹å‰dp(8,5)å·²ç»è½¬ç§»åˆ°dp(9,3)è¿‡äº†ã€‚è€Œdp(8,5)è¡¨ç¤ºä»€ä¹ˆï¼Ÿå®ƒè¡¨ç¤ºå‡†è€ƒè¯å·æšä¸¾8ä½ï¼Œå5ä½ä¸ä¸å‰åˆ©æ•°å­—çš„å‰5ä½åŒ¹é…ä¸Šã€‚
dp(8,8)åŒç†ï¼Œè¡¨ç¤ºå‡†è€ƒè¯å·æšä¸¾å‰8ä½ï¼Œå8ä½ä¸ä¸å‰åˆ©æ•°å­—çš„å‰8ä½åŒ¹é…ä¸Šã€‚
è¿™æ ·ç›´è§‚çœ‹èµ·æ¥æ²¡ä»€ä¹ˆç­”æ¡ˆå…³è”ã€‚ä½†æ˜¯ä»”ç»†è€ƒè™‘ä»¥ä¸‹ï¼Œä¸å‰åˆ©æ•°å­—çš„ç¬¬8ä½çš„å¤±é…æŒ‡é’ˆæŒ‡å‘ç¬¬5ä½ã€‚
è¿™è¯´æ˜ä»€ä¹ˆï¼Ÿ
ä¸å‰åˆ©æ•°å­—çš„å‰8ä½ä¸­ï¼Œå‰5ä½ç­‰äºå5ä½ï¼
åŒ¹é…5ä½çš„æƒ…å†µåŒ…å«åŒ¹é…8ä½çš„æƒ…å†µï¼ï¼ˆå› ä¸ºä½ åŒ¹é…äº†8ä½ï¼Œæ ¹æ®ä¸Šæ¨è®ºå¯çŸ¥ä¹Ÿç®—åœ¨åŒ¹é…äº†5ä½çš„æƒ…å†µä¸­ï¼‰
è¿™å°±æ˜¯åˆ«äººåšå®¢ä¸­æ­¤é¢˜é¢˜è§£ç»å¸¸æåˆ°çš„è®¡æ•°æ–¹æ¡ˆä¼šåŒ…å«çš„é—®é¢˜ã€‚
å…¶å®æŒ‰ç…§ACè‡ªåŠ¨æœºçš„æ„é€ æ–¹å¼ï¼Œå¦‚æœä¸€ä¸ªç‚¹æ²¡æœ‰å­—ç¬¦ä¸ºnewçš„å„¿å­è¾¹çš„è¯ï¼Œå®ƒä¼šå»ºå‡ºä¸€æ¡å¯¹åº”çš„è™šæ‹Ÿå„¿å­è¾¹å’Œç‚¹ï¼Œå„¿å­ç‚¹ä¸Šå­˜çš„æ˜¯æ²¿ç€å¤±é…æŒ‡é’ˆå¾€å›èµ°çš„ä¸Šä¸€ä¸ªå®é™…å­˜åœ¨è¿™æ¡å­—ç¬¦è¾¹æ‰€æŒ‡å‘çš„å„¿å­ã€‚
å½“ç„¶è¿™é¢˜må¾ˆå°ï¼Œä¸å‰åˆ©æ•°å­—ä¸²è‡ªå·±åŒ¹é…è‡ªå·±çš„å¤æ‚åº¦å¾ˆå°ï¼Œå¯ä»¥ç›´æ¥æš´åŠ›è·‘å¤±é…æŒ‡é’ˆæ‰¾ç¬¬ä¸€ä¸ªã€‚

å…¶ä¸­g(i,j)è¡¨ç¤ºå½“å‰åŒ¹é…åˆ°iä¸ªå­—ç¬¦ï¼Œæ·»åŠ ä¸€ä¸ªå­—ç¬¦å˜æˆåŒ¹é…ä¸ºjä¸ªå­—ç¬¦çš„æ–¹æ¡ˆæ•°ã€‚
ä¸å‰åˆ©æ•°å­—å·²ç»çŸ¥é“äº†ï¼Œgæ•°ç»„å¯ä»¥é¢„å¤„ç†å‡ºæ¥ï¼ˆKMPï¼‰ã€‚
ç„¶åæˆ‘ä»¬æƒŠå¥‡åœ°å‘ç°nâ‰¤1e9ï¼Œä¸è®©ä½ å¾ªç¯æ¨ï¼Œç›´æ¥å°±æƒ³åˆ°çŸ©é˜µå¿«é€Ÿå¹‚ä¼˜åŒ–äº†ã€‚
è§‚å¯Ÿä¸€ä¸‹è½¬ç§»æ–¹ç¨‹ï¼Œå‘ç°dp[i+1][?]æ€»æ˜¯ç”±dp[i][?]æ¨æ¥ï¼Œè€Œä¸”iè¿˜æ˜¯nè¿™ä¸ªçº§åˆ«çš„ã€‚
åˆå‘ç°æ¯æ¬¡å®é™…ä¸Šéƒ½æ˜¯ä¹˜ä¸€ä¸ªå›ºå®šçš„çŸ©é˜µgï¼Œä¹Ÿå°±æ˜¯è¯´æ•´ä¸ªdpæ•°ç»„çš„æŸä¸€ä½çš„å€¼å…¶å®éƒ½æ˜¯é€šè¿‡ä¸€äº›gæ•°ç»„ä¹˜è¿‡æ¥çš„ã€‚
æ‰€ä»¥å¯ä»¥æŠŠdpæ•°ç»„ç›´æ¥å½“æˆgæ•°ç»„è‡ªå·±ä¹˜è‡ªå·±ã€‚
æ¯”å¦‚è¯´ï¼Œg(4,2)=4ã€‚
è¡¨ç¤ºæœ‰4ç§è½¬ç§»æƒ…å†µå¯ä»¥è®© ä¸ä¸å‰åˆ©æ•°å­—çš„å‰4ä½åŒ¹é…çš„æƒ…å†µ åœ¨å‡†è€ƒè¯å·å¢åŠ 1ä½å ä¸ä¸å‰åˆ©æ•°å­—çš„å‰2ä½åŒ¹é…ã€‚
æ‰€ä»¥dp(x+1,2)=dp(x,4)âˆ—g(4,2)=dp(x,4)âˆ—4
è€Œdp(x,4)åˆæ˜¯å“ªæ¥çš„ï¼Ÿ
å®ƒæ˜¯é€šè¿‡âˆ‘i=1m\sum_{i=1}^mâˆ‘i=1mâ€‹dp(xâˆ’1,i)âˆ—g(i,4)è½¬ç§»è¿‡æ¥çš„ã€‚
æ‰€ä»¥ä¸€ç›´å¾€å‰æ¨åˆ°x=0ï¼Œå‘ç°dpå€¼çš„næ¬¡è½¬ç§»éƒ½åªè·Ÿè½¬ç§»çŸ©é˜µgæœ‰å…³ï¼Œæ˜¯å¦ä¸ä¸å‰åˆ©æ•°å­—å®Œå…¨åŒ¹é…ç­‰æƒ…å†µå¯ä»¥åœ¨å¼„gæ•°ç»„æ—¶å°±å¤„ç†æ‰ï¼Œå³gæ•°ç»„åªè€ƒè™‘ä¸å‰åˆ©æ•°å­—è¢«åŒ¹é…0~mâˆ’1ä½çš„æƒ…å†µï¼Œä¸è®©å®ƒè½¬ç§»åˆ°jä½éƒ½è¢«åŒ¹é…çš„æƒ…å†µã€‚
æ‰€ä»¥å°±æ˜¯å¯¹gçŸ©é˜µåšå¿«é€Ÿå¹‚ï¼Œæ±‚å®ƒçš„næ¬¡æ–¹ã€‚
æ—¶é—´å¤æ‚åº¦O(log(n)âˆ—m^3)
ä¸ºä»€ä¹ˆç­”æ¡ˆæ˜¯g(0,i)ï¼Œfor i 0~m-1
è€ƒè™‘g(i,j)çš„æ„ä¹‰ã€‚å¦‚æœgçŸ©é˜µè‡ªå·±å¯¹è‡ªå·±è¿ç»­è¿›è¡Œkæ¬¡è½¬ç§»ï¼ˆä¸è¿›è¡Œå¿«é€Ÿå¹‚è€Œå¾ªç¯æ¨ï¼‰ï¼Œg(i,j)å°±è¡¨ç¤ºï¼šåœ¨è¿›è¡Œkæ¬¡è½¬ç§»å‰ å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰iä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ kä¸ªå­—ç¬¦åï¼Œä½¿ä¸å‰åˆ©æ•°å­—æ²¿å¤±é…æŒ‡é’ˆï¼ˆè‡ªå·±ä¹Ÿå¯ä»¥ï¼‰æ‰¾åˆ°çš„æœ€å¤§çš„åŒ¹é…ä½æ•°jï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„kä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ˜¯çŸ©é˜µè½¬ç§»çš„åŸºæœ¬æ¦‚å¿µã€‚
æ‰€ä»¥è¿›è¡Œnæ¬¡è½¬ç§»åï¼Œg(i,j)å°±è¡¨ç¤ºä¸€å¼€å§‹å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰iä½æ—¶ï¼Œå‡†è€ƒè¯å·å¢åŠ nä¸ªå­—ç¬¦åï¼Œä½¿ä¸å‰åˆ©æ•°å­—æ²¿å¤±é…æŒ‡é’ˆï¼ˆè‡ªå·±ä¹Ÿå¯ä»¥ï¼‰æ‰¾åˆ°çš„æœ€å¤§çš„åŒ¹é…ä½æ•°jï¼ˆç®—ä¸Šæ–°åŒ¹é…çš„kä½ï¼‰çš„æ–¹æ¡ˆæ•°ã€‚
æˆ‘ä»¬éœ€è¦å–å…¨å±€æƒ…å†µçš„ç­”æ¡ˆï¼Œè€Œè¿™æ˜¯å¾ˆæ˜¾ç„¶çš„ã€‚å¼€å§‹æ—¶å‡†è€ƒè¯å·åŒ¹é…ä¸å‰åˆ©æ•°å­—çš„å‰0ä½ï¼ˆå‡†è€ƒè¯å·è¿˜ä¸€ä½éƒ½æ²¡æšä¸¾ï¼‰ï¼Œæ‰€ä»¥iä¸º0ï¼›è€Œç”±äºå·²ç»å®šä¹‰è¿‡gæ•°ç»„åªè€ƒè™‘ä¸å‰åˆ©æ•°å­—è¢«åŒ¹é… 0~mâˆ’1ä½çš„æƒ…å†µï¼Œæ‰€ä»¥jåœ¨è¿™ä¸ªåŒºé—´å–ä»»æ„å€¼ï¼Œg(0,j)éƒ½æ˜¯ç­”æ¡ˆçš„ä¸€éƒ¨åˆ†ã€‚æŠŠå®ƒä»¬éƒ½ç®—ä¸Šå°±æ˜¯ç­”æ¡ˆã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstdio&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
using namespace std;
const int N=25;
char p[N];
int n,m,mod;
struct matrix
{
	int m[N][N];
	matrix()
	{
		memset(m,0,sizeof m);
	}
};
int ne[N];

matrix mul(matrix a,matrix b)
{
	matrix res;
	for(int i=0;i&amp;lt;m;i++)
		for(int j=0;j&amp;lt;m;j++)
			for(int k=0;k&amp;lt;m;k++)
				res.m[i][j]=(res.m[i][j]+a.m[i][k]*b.m[k][j])%mod;
	return res;
}

int main() 
{
	scanf(&amp;quot;%d%d%d&amp;quot;, &amp;amp;n, &amp;amp;m, &amp;amp;mod);
	scanf(&amp;quot;%s&amp;quot;, p+1);
	
	matrix g;
	for(int i=2,j=0;i&amp;lt;=m;i++)
	{
		while(j &amp;amp;&amp;amp; p[i] != p[j+1])
			j=ne[j];
		if(p[i] == p[j+1])
			j++;
		ne[i]=j;
	}
	
	for(int i=0;i&amp;lt;m;i++)
		for(int k=0;k&amp;lt;10;k++)
		{
			int j=i;
			while(j &amp;amp;&amp;amp; p[j+1]-&#39;0&#39; != k)
				j=ne[j];
			if(p[j+1]-&#39;0&#39; == k)
				j++;
			if(j&amp;lt;m)	g.m[i][j]=(g.m[i][j]+1)%mod;
		}
	
	matrix a;
	for(int i=0;i&amp;lt;m;i++)
		a.m[i][i]=1;
	
	while(n)
	{
		if(n &amp;amp; 1) a=mul(a,g);
		g=mul(g,g);
		n&amp;gt;&amp;gt;=1;
	}
//	
//	for(int i=0;i&amp;lt;m;i++)
//	{
//		for(int j=0;j&amp;lt;m;j++)
//			cout&amp;lt;&amp;lt;a.m[i][j]&amp;lt;&amp;lt;&#39; &#39;;
//		cout&amp;lt;&amp;lt;endl;
//	}
	
	int ans = 0;
	for(int i = 0; i &amp;lt; m; ++i)
		ans = (ans + a.m[0][i]) % mod;
	
	printf(&amp;quot;%d\n&amp;quot;, ans);
	return 0;
}



Zç®—æ³•




r[5] = 7
r[6] = 7
l[5] = 5
l[6] = 5

å¯¹äº Z[2] æˆ‘ä»¬éœ€è¦æš´åŠ›è®¡ç®—ã€‚
ä¹Ÿå°±æ˜¯æš´åŠ›è®¡ç®— S[1..|S|] å’Œ S[2..|S|] çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚
å¦‚æœ Z[2] &amp;gt; 0, é‚£ä¹ˆ r = r[2], l = l[2] = 2
å¦‚æœ Z[2] = 0, é‚£ä¹ˆ r = r[2] = 0, l = l[2] = 0
æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ç”¨å·²æœ‰çš„ Z[2], Z[3], ..., Z[k-1]ï¼Œæ¥æ¨
å‡º Z[k].
å‡è®¾ k = 121, Z[2..120] å·²ç»çŸ¥é“äº†
r[120] = 130, l[120] = 100

åˆ’åˆ†æˆ[l,i-1],[i,r]





è“è‰²éƒ¨åˆ†ä¸€å®šä¸ç›¸ç­‰ï¼Œå¦åˆ™è¯´æ˜z-boxå¯ä»¥å³ç§»
ç¬¬ä¸€æ­¥ï¼š
åˆå§‹åŒ– Z[]ï¼Œæš´åŠ›è®¡ç®— Z[2]
for(int i = 1;i &amp;lt;= n;i ++) z[i] = 0;
int l, r;
while(str[1 + z[2]] == str[2 + z[2]]) z[2] ++; 
l = 2, r = 2+ z[2]-1;

ç¬¬äºŒæ­¥ï¼š
æšä¸¾ iï¼Œåˆ†ä¸‰ç§æƒ…å†µä¾æ¬¡è®¡ç®— Z[i]
for(int i = 3;i &amp;lt;= n;i ++)
{
    if(i &amp;gt; r)
    {
        while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
        l = i, r = i + z[i] - 1;
    }
    else
    {
        if(z[i - l + 1] &amp;lt; r - i + 1) z[i] = z[i - l + 1];
        else
        {
            z[i] = r - i;
            while(str[1 + z[i]] == str[i + z[i]]) z[i] ++; 
            l = i, r = i + z[i] - 1; 
        }
    } 
}

æ—¶é—´å¤æ‚åº¦æ˜¯ O(n) çš„
æ‰©å±•KMP
ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tï¼ˆé•¿åº¦åˆ†åˆ«ä¸º n å’Œ mï¼‰
å®šä¹‰ extend[i] ä¸º S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚
æ±‚å‡º extend æ•°ç»„

å¦‚æœ S = Tï¼Œé‚£ä¹ˆ extend æ•°ç»„å°±æ˜¯ Z æ•°ç»„ã€‚

å‡è®¾ç°åœ¨éå†åˆ°äº† S[i]ï¼Œä¸” S[1], S[2],â€¦, S[i-1]éƒ½å·²ç»ç®—å‡º
ä¸ Z ç®—æ³•ç±»ä¼¼ï¼Œè®¾ç½®ä¸¤ä¸ªå˜é‡ l å’Œ rï¼Œr è¡¨ç¤ºèƒ½å’Œ T åŒ¹
é…åˆ°çš„æœ€å³è¾¹çš„ä½ç½®ï¼Œl ä¸º r å¯¹åº”çš„èµ·å§‹ä½ç½®ã€‚
ä¹Ÿå°±æ˜¯ S[l .. r] = T[1.. r-l+1]

S[i] å¯¹åº”çš„æ˜¯ T[i-l+1]
ç°åœ¨è¦è®¡ç®—çš„æ˜¯ S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€
æ³¨æ„åˆ°æ­¤æ—¶ S[i..r] = T[i-l+1 .. r-l+1]
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå¯¹ T æ±‚ä¸€é Z æ•°ç»„ï¼Œç„¶åè€ƒå¯Ÿä¸€ä¸‹ Z[i-l+1]



void calc_Z(char *str) 
{
	int n = strlen(str + 1);
	for(int i = 1; i &amp;lt;= n; i ++) z[i] = 0;
	z[1] = n;
	int l, r = 0;
	for(int i = 2; i &amp;lt;= n; i ++) 
	{
		if(i &amp;gt; r) 
		{
			while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
			l = i, r = i + z[i] - 1;
		} else 
		{
			if(z[i - l + 1] &amp;lt; r - i + 1) z[i] = z[i - l + 1];
			else 
			{
				z[i] = r - i + 1;
				while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
				l = i, r = i + z[i] - 1;
			}
		}
	}
}

void calc_extend(char *S, char *T) 
{
	calc_Z(T);
	int l, r = 0;
	int n = strlen(S + 1);
	int m = strlen(T + 1);
	for (int i = 1; i &amp;lt;= n; i ++) 
	{
		if (i &amp;gt; r) 
		{
			while (i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp;
			        S[i + ext[i]] == T[1 + ext[i]]) ext[i] ++;
			l = i, r = i + ext[i] - 1;
		}
		else 
		{
			if (i + z[i - l + 1] - 1 &amp;lt; r) ext[i] = z[i - l + 1];
			else 
			{
				ext[i] = r - i + 1;
				while (i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp; S[i +ext[i]] == T[1 + ext[i]]) 
					ext[i] ++;
				l = i, r = i + ext[i] - 1;
			}
		}
	}
}

ä¾‹é¢˜
é¢˜æ„ï¼šç»™ä½ nä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚è¿™nä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²
hdu4333
ç»™ä¸€ä¸ª L ä½æ•°çš„æ­£æ•´æ•° Nï¼Œæ¯æ¬¡å¯ä»¥æŠŠè¿™ä¸ªæ•°çš„æœ€åä¸€ä½ç§»åˆ°æœ€å‰é¢æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°ã€‚
æ€»å…±æœ€å¤šå¯ä»¥å¾—åˆ° n ä¸ªæ•°ï¼Œé‡å¤çš„åªç®—ä¸€æ¬¡ã€‚
é—®è¿™äº›æ•°ä¸­ï¼Œç­‰äº n çš„ï¼Œå°äº nçš„ï¼Œå¤§äº n çš„æ•°åˆ†åˆ«æœ‰å‡ ä¸ªã€‚
L â‰¤ 1e5

æ ·ä¾‹ï¼š
341 ï¼ˆç­”æ¡ˆï¼š 1 1 1ï¼‰
æˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæ•°å¤åˆ¶ä¸¤éï¼Œç„¶ååªè€ƒè™‘é•¿åº¦ä¸º n çš„å­ä¸²ã€‚è¿™äº›å­ä¸²å°±æ˜¯ç§»åŠ¨è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°ã€‚
å¦‚ä½•å’ŒåŸæ•° N åšæ¯”è¾ƒå‘¢
å‡è®¾ç°åœ¨çš„æ•°æ˜¯ S[i .. i+L-1], N æ˜¯ S[1..L]
æˆ‘ä»¬åªè¦æ±‚å‡ºä»–ä»¬çš„æœ€é•¿å…¬å…±å‰ç¼€ xï¼Œå¦‚æœ x = n è¯´æ˜è¿™ä¸¤ä¸ªæ•°ç›¸ç­‰ã€‚
å¦åˆ™ï¼Œæ¯”è¾ƒ S[x] å’Œ S[i+x-1] çš„å¤§å°ï¼Œå°±å¯ä»¥ç¡®å®šä»–ä»¬çš„å¤§å°å…³ç³»ã€‚
æ±‚ x ï¼Œå°±æ˜¯æ‰©å±• KMP ä¸­çš„ Z ç®—æ³•ã€‚x = min(n, Z[i])
æœ€åä¸€æ­¥å»é‡ã€‚å¯¹ N è·‘ä¸€æ¬¡ KMP
å¦‚æœ L-next[L] æ˜¯ L çš„çº¦æ•°ï¼Œé‚£ä¹ˆ L-next[L] æ˜¯ N çš„æœ€å°å¾ªç¯èŠ‚ã€‚å¦åˆ™ N çš„ æœ€å°å¾ªç¯èŠ‚æ˜¯ Lã€‚
å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾ä¸€éå³å¯,æˆ–é™¤ä»¥æœ€å°å¾ªç¯èŠ‚ä¸ªæ•°ã€‚
æ—¶é—´å¤æ‚åº¦ O(L)
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=200010;
char str[N];
int ne[N];
int z[N];

int main()
{
    int T;
    scanf(&amp;quot;%d&amp;quot;,&amp;amp;T);
    for(int kas=1;kas&amp;lt;=T;kas++)
    {
        scanf(&amp;quot;%s&amp;quot;,str+1);
        
        int len=strlen(str+1);
        for(int i=2,j=0;i&amp;lt;=len;i++)
        {
            while(j &amp;amp;&amp;amp; str[i] != str[j+1])
                j=ne[j];
            if(str[i] == str[j+1])
                j++;
            ne[i]=j;
        }
        
        for(int i=1;i&amp;lt;=len;i++)
            str[i+len]=str[i];
        str[len*2+1]=&#39;\0&#39;;
        memset(z,0,sizeof z);
        z[1]=len*2;
        int l,r=0;
        
        for(int i=2;i&amp;lt;=len*2;i++)
        {
            if(i&amp;gt;r)
            {
                while(str[1+z[i]] == str[i+z[i]])
                    z[i]++;
                l=i,r=i+z[i]-1;
            }
            else 
            {
                if(z[i-l+1] &amp;lt; r-i+1)
                    z[i]=z[i-l+1];
                else 
                {
                    z[i]=r-i;
                    while(str[1+z[i]] == str[i+z[i]])
                        z[i]++;
                    l=i,r=i+z[i]-1;
                }
            }
        }
        
        int gre=0,eql=0,les=0;
        for(int i=1;i&amp;lt;=len;i++)
        {
            if(z[i] &amp;gt;= len)
                eql++;
            else if(str[1+z[i]] &amp;gt; str[i+z[i]])
                les++;
            else gre++;
        }
        
        int t;
        if(len%(len-ne[len]) == 0)
            t=len/(len-ne[len]);//å¾ªç¯èŠ‚ä¸ªæ•° 
        else 
            t=1;
        printf(&amp;quot;Case %d: %d %d %d\n&amp;quot;,kas,les/t,eql/t,gre/t);
    }
}

å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾ä»£ç 
poj3376
ç»™ä½  n ä¸ªå­—ç¬¦ä¸² m[1], m[2], â€¦, m[n]ã€‚ æ±‚ S = m[i]m[j] ï¼ˆ1 &amp;lt;= i,j &amp;lt;= nï¼‰æ˜¯å›æ–‡ä¸²çš„æ•°é‡ã€‚
n ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¹‹å’Œä¸è¶…è¿‡ 2Â·1e6

æ ·ä¾‹è¾“å…¥ï¼š
3a
ab
ba
ç­”æ¡ˆï¼š5ï¼ˆaa,aba,aba,abba,baab)
è€ƒè™‘ä»€ä¹ˆæƒ…å†µä¸‹ i å’Œ j æ‹¼èµ·æ¥ä¼šæ˜¯å›æ–‡ä¸²ã€‚


içš„é•¿åº¦å°äºjï¼Œé‚£ä¹ˆiä¸€å®šæ˜¯jçš„åä¸²çš„å‰ç¼€ï¼Œä¸”jçš„åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²


içš„é•¿åº¦ç­‰äºjï¼Œé‚£ä¹ˆiç­‰äºjçš„åä¸²


içš„é•¿åº¦å¤§äºjï¼Œé‚£ä¹ˆjçš„åä¸²ä¸€å®šæ˜¯içš„å‰ç¼€ï¼Œä¸”iä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²


æˆ‘ä»¬å¯ä»¥å°†è¿™nä¸ªå­—ç¬¦ä¸²æ’å…¥trieï¼Œæ¯ä¸ªèŠ‚ç‚¹è¦ç»´æŠ¤ä¸¤ä¸ªå€¼ï¼š
value1. åˆ°å½“å‰èŠ‚ç‚¹çš„å­—ç¬¦ä¸²ä¸ªæ•°ï¼›value2.å½“å‰èŠ‚ç‚¹åé¢çš„å›æ–‡å­ä¸²ä¸ªæ•°
æˆ‘ä»¬ç”¨æ¯ä¸ªå­—ç¬¦ä¸²çš„åä¸²å»trieä¸ŠæŸ¥æ‰¾ï¼Œè¦æ„æˆå›æ–‡ä¸²æœ‰ä»¥ä¸‹æƒ…å†µï¼š


1.æ­¤åä¸²æ˜¯å…¶ä»–ä¸²çš„å‰ç¼€ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡å°±è¦åŠ ä¸Švalue2


2.æ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡è¦åŠ ä¸Švalue1


3.2çš„ç‰¹ä¾‹ï¼šæ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€ä¸ºç©ºï¼ŒåŒæ ·è¦åŠ ä¸Švalue1ï¼Œè¿™ç§æƒ…å†µå¯ä»¥å’Œ2ä¸€èµ·å¤„ç†


ç•™ä¸‹çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€ä¸­ï¼Œå“ªäº›æ˜¯å›æ–‡ä¸²ã€‚
å¯¹äºä¸² Sï¼Œæˆ‘ä»¬å…ˆæ±‚å‡ºæ­£ä¸² S å¯¹åä¸² T çš„ extend[i]
é‚£ä¹ˆå¯¹äºæ¯ä¸ª iï¼Œå¦‚æœ S[i..n] å’Œ T çš„æœ€é•¿å…¬å…±å‰ç¼€ç­‰äº
S[i..n] çš„é•¿åº¦ï¼Œè¯´æ˜ S[i..n] æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ã€‚
å› æ­¤æ•´é“é¢˜å°±åœ¨çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³äº†ã€‚
#include&amp;lt;iostream&amp;gt;
#include&amp;lt;cstring&amp;gt;
#include&amp;lt;algorithm&amp;gt;
#include&amp;lt;cstdio&amp;gt;
using namespace std;
const int N=2e6+10;
int trie[N][26],tot=1;
int n;
char s[N],t[N];
int len[N];
int slen;
int z[N],ext[N];
bool flag[2][N];
int bg[N],ed[N];
typedef long long LL;
struct Node
{
	int v1,v2;
}cnt[N];

void get_z(char *s)
{
	int n=strlen(s+1);
	for(int i=1;i&amp;lt;=n;i++) z[i]=0;
	z[1]=n;
	int l,r=0;
	for(int i=2;i&amp;lt;=n;i++)
	{
		if(i&amp;gt;r)
		{
			while(s[1+z[i]] == s[i+z[i]])
				z[i]++;
			l=i,r=i+z[i]-1;
		}
		else
		{
			if(z[i-l+1] &amp;lt; r-i+1)
				z[i]=z[i-l+1];
			else
			{
				z[i]=r-i;
				while(s[1+z[i]] == s[i+z[i]])
					z[i]++;
				l=i,r=i+z[i]-1;
			}
		}
	}
}

void exkmp(int type,char *s,char *t)
{
	get_z(t);
	int n=strlen(s+1);
	int m=strlen(t+1);
	for(int i=1;i&amp;lt;=n;i++)
		ext[i]=0;
	int l,r=0;
	for(int i=1;i&amp;lt;=n;i++)
	{
		if(i&amp;gt;r)
		{
			while(i+ext[i] &amp;lt;=n &amp;amp;&amp;amp; 1+ext[i] &amp;lt;=m &amp;amp;&amp;amp;
			s[i+ext[i]] == t[1+ext[i]])
				ext[i]++;
			l=i,r=i+ext[i]-1;
		}
		else
		{
			if(z[i-l+1] &amp;lt; r-i+1)
				ext[i]=z[i-l+1];
			else
			{
				ext[i]=r-i+1;
				while(i + ext[i] &amp;lt;= n &amp;amp;&amp;amp; 1 + ext[i] &amp;lt;= m &amp;amp;&amp;amp; 
				s[i+ext[i]] == t[1+ext[i]])
					ext[i]++;
				l=i,r=i+ext[i]-1;
			}
		}
	}

	for(int i=1;i&amp;lt;=n;i++)
	{
		//cout&amp;lt;&amp;lt;&amp;quot;---&amp;quot;&amp;lt;&amp;lt;ext[i]&amp;lt;&amp;lt;endl;
		if(ext[i] == n-i+1)
			flag[type][i+slen]=true;//s[i...n]ä¸ºå›æ–‡ä¸²
	}
}

void insert(int k)
{
	int p=1;
	for(int i=bg[k];i&amp;lt;=ed[k];i++)
	{
		cnt[p].v2+=flag[0][i];
		int ch=s[i]-&#39;a&#39;;
		if(!trie[p][ch])
			trie[p][ch]=++tot;
		p=trie[p][ch];
	}
	cnt[p].v1++;
}

void print(int k)
{
	int p=1;
	for(int i=bg[k];i&amp;lt;=ed[k];i++)
	{
		int ch=s[i]-&#39;a&#39;;
		p=trie[p][ch];
		cout&amp;lt;&amp;lt;&amp;quot;---&amp;quot;&amp;lt;&amp;lt;cnt[p].v2&amp;lt;&amp;lt;&#39; &#39;&amp;lt;&amp;lt;cnt[p].v1&amp;lt;&amp;lt;endl;
	}
}

int main()
{
	scanf(&amp;quot;%d&amp;quot;,&amp;amp;n);
	
	for(int i=1;i&amp;lt;=n;i++)
	{
		scanf(&amp;quot;%d&amp;quot;,&amp;amp;len[i]);
		scanf(&amp;quot;%s&amp;quot;,s+1+slen);
		for(int j=1;j&amp;lt;=len[i];j++)
			t[slen+j]=s[slen+len[i]+1-j];
		t[slen+len[i]+1]=&#39;\0&#39;;
		exkmp(0,s+slen,t+slen);
		exkmp(1,t+slen,s+slen);

		bg[i]=slen+1;
		slen+=len[i];
		ed[i]=slen;

		insert(i);
		//print(i);
	}

	LL ans=0;
	for(int i=1;i&amp;lt;=n;i++)
	{
		int p=1;
		bool f=true;
		for(int j=ed[i];j&amp;gt;=bg[i];j--)//ç”¨åä¸²å»trieä¸ŠåŒ¹é…
		{
			int k=s[j]-&#39;a&#39;;
			if(!trie[p][k])
			{
				f=false;
				break;
			}
			else
				p=trie[p][k];
			if(flag[1][bg[i]+ed[i]-j+1] || j == bg[i])
				ans+=cnt[p].v1;
		}
		if(f)
			ans+=cnt[p].v2;
	}

	printf(&amp;quot;%lld\n&amp;quot;,ans);
	return 0;
}


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/zi-fu-chuan-fu-xi-yi/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://caifxh.github.io/post/hello-gridea/">
                        Hello Gridea
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2018-12-12</time>
                    
                        <a href="https://caifxh.github.io/tag/Pg9vEok_L/" class="post-tag i-tag
                            i-tag-primary">
            #Gridea
        </a>
                        
                </div>
                <div class="post-article">
                    
                        <a href="https://caifxh.github.io/post/hello-gridea/" class="post-feature-image" style="background-image:url(https://caifxh.github.io/post-images/hello-gridea.png) ">
                        </a>
                        
                            <div class="post-content">
                                
                                    <div class="post-content-abstract">
                                        <p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>

                                    </div>
                                    
                                            <a class="btn btn-text" href="https://caifxh.github.io/post/hello-gridea/">Read More ~</a>
                            </div>
                </div>
            </article>
            
                <!-- ç¿»é¡µ -->
                
    <div class="pagination-container">
        
            <a href="https://caifxh.github.io/page/4/" class="page-btn btn">ä¸Šä¸€é¡µ</a>
            
                
    </div>
    
                </div>
                <!--  -->
                <div class="main-container-middle"></div>
                <!--  -->
                <div id="sidebar" class="main-container-right">

                    <!-- ä¸ªäººä¿¡æ¯ -->
                    
    <div class="id_card i-card">
        <div class="id_card-avatar" style="background-image: url(https://caifxh.github.io/images/avatar.png?v=1594530304239)">
        </div>
        <h1 class="id_card-title">
            fxh&#39;blog
        </h1>
        <h2 class="id_card-description">
            èœé¸¡ä¸€æš
        </h2>
        <!--  -->
        <div class="id_card-sns">
            <!-- github -->
            
                    <!-- twitter -->
                    
                            <!-- weibo -->
                            
                                    <!-- facebook -->
                                    

        </div>
    </div>
    

                        <!-- å…¬å‘Šæ  -->
                        

                </div>
            </div>



            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://caifxh.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
</body>

</html>