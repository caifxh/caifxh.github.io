<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gridea</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="//cdnjs.loli.net/ajax/libs/mdui/0.4.3/css/mdui.min.css">
    <link rel="stylesheet" href="media/css/post.css">
    <link rel="stylesheet" href="media/live2d/css/live2d.css" />
    
</head>
<body class=" mdui-appbar-with-toolbar  mdui-theme-primary-pink mdui-theme-accent-pink">
<header class="mdui-toolbar mdui-color-pink mdui-appbar-fixed mdui-appbar-scroll-toolbar-hide" style="z-index: 1000">
    <a href="javascript:;" mdui-drawer="{target: '#left-drawer',overlay:true}" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">menu</i></a>
    <span class="mdui-typo-title">Gridea</span>
    <div class="mdui-toolbar-spacer"></div>
<!--    <a href="javascript:history.go(0);" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">search</i></a>-->
    <a href="javascript:;" class="mdui-btn mdui-btn-icon"><i class="mdui-icon material-icons">more_vert</i></a>
</header>

<div class="mdui-drawer mdui-color-white mdui-drawer-full-height mdui-drawer-close" id="left-drawer">
    <ul class="mdui-list">
        <li class="mdui-subheader">菜单</li>
        
        <li class="mdui-list-item mdui-ripple">
            <a href="/" class="mdui-list-item-content">首页</a>
        </li>
        
        <li class="mdui-list-item mdui-ripple">
            <a href="/archives" class="mdui-list-item-content">归档</a>
        </li>
        
        <li class="mdui-list-item mdui-ripple">
            <a href="/tags" class="mdui-list-item-content">标签</a>
        </li>
        
        <li class="mdui-list-item mdui-ripple">
            <a href="/post/about" class="mdui-list-item-content">关于</a>
        </li>
        
    </ul>
</div>

<div id="content" class="site-content">
    <div id="primary" class="content-area">
        <main id="main" class="site-main" role="main">
            <article id="post-1270" class="post-1270 post type-post status-publish format-standard hentry category-90 category-129 tag-149">
                <header class="entry-header">
                    <h1 class="entry-title">高精度</h1>
                    <p class="entry-census">发布于 2020-04-08</p>
                    <hr>
                </header>
                <div class="neko">
                    <h4 id="高精度加法">高精度加法</h4>
<p>当进行加法运算的数字较大时，受存储范围限制，无法使用int或longlong型变量进行存储。<br>
考虑到加法运算的本质，不妨将数字拆开来存储。<br>
对于一个超过变量存储数据范围的数字，可以将这个数字拆开，拆成一位一位的，或者是几位几位的存储到一个数组中， 用一个数组去表示一个数字</p>
<p>采用用顺序存储数据方式，会有一个问题：最高位进位变得很困难。<br>
最高位在num[0]，所以一旦有进位，需要将num[]数组中每一位都往后移，时间复杂度O(len)<br>
·倒序存储·：num[]数组从0到len-1依次存储整数个位到最高位。则最高位进位时，只需要num[len++]=t，t为最高位数字</p>
<p>进位：<br>
方法一：设一个变量t，记录当前进位<br>
边计算边进位和逐位相加不进位最后再统一进位效果是一样的如下，先进行一遍逐位相加。<br>
然后，从0开始遍历一遍ans.num[]，将本位大于9的部分进位给更高位。<br>
最后判断是否最高位有进位，有则ans.len++</p>
<p><a href="https://www.luogu.com.cn/problem/P1601">模板题</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=510;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum add(bignum a,bignum b)
{
	bignum c;
	c.len=max(a.len , b.len);
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]+b.m[i];
	for(int i=0;i&lt;c.len;i++)
		if(c.m[i] &gt; 9)
		{
			c.m[i+1]+=1;
			c.m[i]-=10;
		}
	if(c.m[c.len]) c.len++;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	len=strlen(s);
	b.len=len;
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=add(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="高精度减法">高精度减法</h4>
<ul>
<li>判断正负</li>
<li>基本和加法一模一样，只不过从进位变成退位</li>
<li>退位后更新结果长度<br>
<a href="https://www.luogu.com.cn/problem/P2142">模板题</a></li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=10100;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

int judge(bignum a,bignum b)
{
	if(a.len &gt; b.len) return 1;
	if(a.len &lt; b.len) return -1;
	for(int i=a.len-1;i&gt;=0;i--)
	{
		if(a.m[i] &gt; b.m[i]) return 1;
		if(a.m[i] &lt; b.m[i]) return -1;
	}
	return 0;
}

bignum Minus(bignum a,bignum b)
{
	if(judge(a,b) == -1)
	{
		printf(&quot;-&quot;);
		return Minus(b,a);
	}

	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]-b.m[i];
	for(int i=0;i&lt;c.len;i++)
		if(c.m[i] &lt; 0)
		{
			c.m[i+1]-=1;
			c.m[i]+=10;
		}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	len=strlen(s);
	b.len=len;
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=Minus(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="高精度乘法">高精度乘法</h4>
<h4 id="1高精低精">1.高精*低精</h4>
<p>将加法运算改为乘法运算即可。<br>
注意：</p>
<ul>
<li>进位的运算</li>
<li>最高位进位的处理，可能不止进一位<br>
<a href="https://www.acwing.com/problem/content/description/795/">模板题</a></li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=100010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum mul(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]*b;
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
		if(i == c.len-1 &amp;&amp; c.m[i+1]) c.len++;
	}

	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	int b;
	scanf(&quot;%d&quot;,&amp;b);

	bignum c=mul(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="2高精高精">2.高精*高精</h4>
<p>乘法竖式中，a.num[i]和b.num[j]相乘的结果，放在了ans.num[i+j]的位置。<br>
a,b都为正整数时，长度为a.len和b.len的数字相乘得到ans，则<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/17/9969_ff4d713467-43.PNG" alt="43.PNG" loading="lazy"><br>
模拟上例竖式运算过程即可<br>
{模板题](https://www.luogu.com.cn/problem/P1303}</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=4010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum mul(bignum a,bignum b)
{
	bignum c;
	c.len=a.len+b.len;
	for(int i=0;i&lt;a.len;i++)
		for(int j=0;j&lt;b.len;j++)
			c.m[i+j]+=a.m[i]*b.m[j];
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
	}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	b.len=len=strlen(s);
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=mul(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="高精度除法">高精度除法</h4>
<h4 id="1高精低精-2">1.高精/低精</h4>
<p>除法是从高位到低位进行运算的。使用一个临时变量来记录余数，注意细节<br>
<a href="https://www.acwing.com/problem/content/description/796/">模板题</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=100010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};
int t;

bignum Div(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	t=0;
	for(int i=c.len-1;i&gt;=0;i--)
	{
		t=t*10+a.m[i];
		c.m[i]=t/b;
		t%=b;
	}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	int b;
	scanf(&quot;%d&quot;,&amp;b);
	bignum c=Div(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	printf(&quot;%d\n&quot;,t);

	return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P1255">数楼梯</a><br>
斐波那契递推<br>
<a href="https://paste.ubuntu.com/p/JKWpDTPXrj/">code</a></p>
<p><a href="https://www.luogu.com.cn/problem/P1249">P1249</a><br>
【思路】<br>
1、这道题预先需要知道的一点是：数越多，乘积越大。<br>
“1”对于乘积是没有收益的，我们要从2~n-1中选出尽可能多的数，使它们的和为n。然后把选出的数相乘就是答案。<br>
2、两个特例，“3”和“4”。这两个只能从拆成“1+2”和“1+3”</p>
<p>【流程】<br>
输入——选数——高精度乘法——输出。（选数时和高精度乘法无关）<br>
【如何选数】<br>
我们就以13为例，“2”、“3”、“4”都可以选，但是“5”如果选了，sum（2，3，4，5）=14超过13，5不能选。此时sum（2，3，4）=9，还余4，我们把4这个值分配到“2”、“3”、“4”这三个数上。</p>
<p>怎么分最好？这里有两个原则：<br>
（1）增长的数的个数越多，乘积越大。“2+1”、“3+1”、“4+2”优于“2”、“3”、“4+4”；<br>
（2）若只有部分数能增长，那么本身大的增长后，乘积更大。“2”、“3”、“4+1”优于“2+1”、“3”、“4”<br>
所以对于 “2”、“3”、“4”，余4 来说。</p>
<p>可以都增长，那么变成 “2+1”、“3+1”、“4+1”，余1 。<br>
不能都增长，那么变成 “3”、“4”、“5+1”，余0</p>
<p>【高精度乘法】<br>
选数之后就是把所有选择的数相乘，因为最终值可能很大，所以需要用到高精度乘法，关于高精度乘法，不赘述。<br>
【代码】</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
using namespace std;
const int N=40010;
struct bignum
{
	int m[N];
	int len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};
vector&lt;int&gt; num;
int n;

void init()
{
	int sum=0;
	for(int i=2;i&lt;n;i++)
		if(sum + i &gt; n)
		{
			int remain=n-sum;
			while(remain)
			{
				for(int j=num.size()-1;j&gt;=0;j--)
				{
					remain--;
					num[j]++;
					if(!remain) return;
				}
			}
		}
		else num.push_back(i),sum+=i;
}

bignum mul(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]*b;
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
		if(i == c.len-1 &amp;&amp; c.m[i+1]) c.len++;
	}
	return c;
}

int main()
{
	cin&gt;&gt;n;
	
	if(n == 3)
	{
		cout&lt;&lt;1&lt;&lt;' '&lt;&lt;2&lt;&lt;endl;
		cout&lt;&lt;2&lt;&lt;endl;
	}
	else if(n == 4)
	{
		cout&lt;&lt;1&lt;&lt;' '&lt;&lt;3&lt;&lt;endl;
		cout&lt;&lt;3&lt;&lt;endl;
	}
	else 
	{
		init();
		
		bignum ans;
		ans.m[0]=1,ans.len=1;
		
		for(int i=0;i&lt;num.size();i++)
			ans=mul(ans,num[i]);
		
		for(int i=0;i&lt;num.size();i++)
			cout&lt;&lt;num[i]&lt;&lt;' ';
		cout&lt;&lt;endl;
		
		for(int i=ans.len-1;i&gt;=0;i--)
			printf(&quot;%d&quot;,ans.m[i]);
		puts(&quot;&quot;);
	}
	return 0;
}
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://cdn.acwing.com/media/article/image/2020/05/25/9969_2bdee5009e-33.PNG" alt="33.PNG" loading="lazy"></figure>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
#include&lt;cmath&gt;
using namespace std;
const int N=10010,M=40010,INF=0x3f3f3f3f;
struct bignum
{
	int m[M];
	int len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};
double w[N];
double f[N];
int trans[N];
vector&lt;int&gt; num;
int n;

bignum mul(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]*b;
	
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
		if(i == c.len-1 &amp;&amp; c.m[i+1]) c.len++;
	}
	return c;
}

int main()
{
	cin&gt;&gt;n;
	
	for(int i=1;i&lt;=n;i++) w[i]=log(i);
	
	for(int i=1;i&lt;=n;i++) f[i]=-INF;
	
	for(int i=1;i&lt;=n;i++)
		for(int j=n;j&gt;=i;j--)
			if(f[j-i]+w[i] &gt; f[j])
				f[j]=f[j-i]+w[i],trans[j]=j-i;
				
	for(int p=n;p;p=trans[p])
		num.push_back(p-trans[p]);
 
	bignum ans;
	ans.m[0]=1,ans.len=1;
	
	for(int i=num.size()-1;i&gt;=0;i--)
		ans=mul(ans,num[i]);
	
	for(int i=num.size()-1;i&gt;=0;i--)
		cout&lt;&lt;num[i]&lt;&lt;' ';
	cout&lt;&lt;endl;
	
	for(int i=ans.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,ans.m[i]);
	puts(&quot;&quot;);
	
	return 0;
}
</code></pre>

                </div>
            </article>
        </main>
    </div>
    <div class="doc-footer-nav mdui-color-theme">
        <div class="mdui-container">
            <div class="mdui-row">
                
                <a href="https://caifxh.github.io/post/dan-diao-shu-ju-jie-gou/" class="mdui-ripple mdui-color-theme mdui-col-xs-2 mdui-col-sm-6 doc-footer-nav-left">
                    <div class="doc-footer-nav-text">
                        <i class="mdui-icon material-icons">arrow_back</i>
                        <span class="doc-footer-nav-direction mdui-hidden-xs-down">上一篇文章</span>
                        <div class="doc-footer-nav-chapter mdui-hidden-xs-down">单调数据结构</div>
                    </div>
                </a>
                
                
                <a href="https://caifxh.github.io/post/shu-xing-dp/" class="mdui-ripple mdui-color-theme mdui-col-xs-10 mdui-col-sm-6 doc-footer-nav-right">
                    <div class="doc-footer-nav-text">
                        <i class="mdui-icon material-icons">arrow_forward</i>
                        <span class="doc-footer-nav-direction">下一篇文章</span>
                        <div class="doc-footer-nav-chapter">树形dp</div>
                    </div>
                </a>
                
            </div>
        </div>
    </div>
    <br>
    
    <div class="comment"></div>
</div>
<footer class="mdui-container footer ">
    <div class="head_card-offset"></div>
    <div class="mdui-row mdui-row-gapless">
        <div class="k-container">
            <img width="100%" src="/media/img/skirt.png">
        </div>
    </div>

    <div class="site-info">
        Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
    </div>
</footer>
<div id="landlord" style="left:5px;bottom:0px;">
    <div class="message" style="opacity:0"></div>
    <canvas id="live2d" width="500" height="560" class="live2d"></canvas>
    <div class="live_talk_input_body">
        <div class="live_talk_input_name_body">
            <input name="name" type="text" class="live_talk_name white_input" id="AIuserName" autocomplete="off" placeholder="你的名字" />
        </div>
        <div class="live_talk_input_text_body">
            <input name="talk" type="text" class="live_talk_talk white_input" id="AIuserText" autocomplete="off" placeholder="要和我聊什么呀？"/>
            <button type="button" class="live_talk_send_btn" id="talk_send">发送</button>
        </div>
    </div>
    <input name="live_talk" id="live_talk" value="1" type="hidden" />
    <div class="live_ico_box">
        <div class="live_ico_item type_info" id="showInfoBtn"></div>
        <div class="live_ico_item type_talk" id="showTalkBtn"></div>
        <div class="live_ico_item type_music" id="musicButton"></div>
        <div class="live_ico_item type_youdu" id="youduButton"></div>
        <div class="live_ico_item type_quit" id="hideButton"></div>
        <input name="live_statu_val" id="live_statu_val" value="0" type="hidden" />
        <audio src="" style="display:none;" id="live2d_bgm" data-bgm="0" preload="none"></audio>
        <input name="live2dBGM" value="https://img.apa70.com/123.mp3" type="hidden">
        <input name="live2dBGM" value="https://img.apa70.com/123.mp3" type="hidden">
        <input id="duType" value="douqilai,l2d_caihong" type="hidden">
    </div>
</div>
<div id="open_live2d">召唤伊斯特瓦尔</div>
<script>
    var message_Path = '/media/live2d/';//资源目录，如果目录不对请更改
    var talkAPI = "";//如果有类似图灵机器人的聊天接口请填写接口路径
</script>
<!--<script src="/media/js/jquery-3.3.1.min.js"></script>-->
<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript" src="/media/live2d/js/live2d.js"></script>
<script type="text/javascript" src="/media/live2d/js/message.js"></script>

</body>
<script src="//cdnjs.loli.net/ajax/libs/mdui/0.4.3/js/mdui.min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    $('.comment').bind('DOMNodeInserted',()=>{
        $('.comment').unbind()

        $('.vbtn').addClass(' mdui-btn mdui-color-theme-accent mdui-ripple')
    })

    let valine = new Valine({
        el: '.comment',
        
        
        
        path: window.location.pathname,
        pageSize: 30,
        avatar:'mm',
        notify:true
    })
</script>
</html>
