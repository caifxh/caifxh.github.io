<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://caifxh.github.io</id>
    <title>fxh</title>
    <updated>2020-04-09T04:05:44.364Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://caifxh.github.io"/>
    <link rel="self" href="https://caifxh.github.io/atom.xml"/>
    <subtitle>èœ</subtitle>
    <logo>https://caifxh.github.io/images/avatar.png</logo>
    <icon>https://caifxh.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, fxh</rights>
    <entry>
        <title type="html"><![CDATA[å››è¾¹å½¢ä¸ç­‰å¼]]></title>
        <id>https://caifxh.github.io/post/si-bian-xing-bu-deng-shi/</id>
        <link href="https://caifxh.github.io/post/si-bian-xing-bu-deng-shi/">
        </link>
        <updated>2020-04-09T04:05:10.000Z</updated>
        <content type="html"><![CDATA[<p>å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–ä¸»è¦é’ˆå¯¹åŒºé—´DPæ¨¡å‹ã€‚<br>
è½¬ç§»æ–¹ç¨‹å½¢å¦‚ï¼š<br>
f[i][j] = min(f[i][k] + f[k + 1][j] + w(i, j))<br>
å¯¹äºæ¯ä¸ªåŒºé—´éƒ½è¦æšä¸¾ k<br>
æ—¶é—´å¤æ‚åº¦ O(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">n^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span>)<br>
çŠ¶æ€æ•°å·²ç»å®šå¥½äº†æ˜¯ O(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">n^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>)ï¼Œæˆ‘ä»¬èƒ½æƒ³åŠæ³•ä¼˜åŒ–çš„éƒ¨åˆ†å°±æ˜¯æŠŠ O(n) çš„è½¬ç§»ä¼˜åŒ–åˆ° O(1)<br>
è¿™é‡Œå°±è¦ç”¨åˆ°å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–ã€‚</p>
<p>å¯¹äº a &lt; b &lt; c &lt; dï¼š<br>
å¦‚æœæœ‰ f(a, c) + f(b, d) &lt;= f(b, c) + f(a, d) <strong>äº¤å‰ &lt;= åŒ…å«</strong><br>
æˆ‘ä»¬å°±ç§° f æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚</p>
<p>å¦‚æœä»£ä»·å‡½æ•° w(i,j) æ»¡è¶³å•è°ƒæ€§å’Œå››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆ dp å‡½æ•° f(i,j) ä¹Ÿæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚<br>
å®šä¹‰ s(i,j) ä¸º f(i,j) å–å¾—æœ€ä¼˜å€¼å¯¹åº”çš„è½¬ç§»ï¼ˆå³ kï¼‰<br>
å¦‚æœ f(i,j) æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆ s(i,j) å•è°ƒ<br>
å³s(i,j)â‰¤s(i,j+1)â‰¤s(i+1,j+1)</p>
<h4 id="åº”ç”¨èƒŒæ™¯">åº”ç”¨èƒŒæ™¯</h4>
<figure data-type="image" tabindex="1"><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_a72071bc79-20.PNG" alt="20.PNG" loading="lazy"></figure>
<p><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_9d82d0e079-21.PNG" alt="21.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_c982acc479-22.PNG" alt="22.PNG" loading="lazy"></p>
<h4 id="å››è¾¹å½¢ä¸ç­‰å¼å®šä¹‰å’Œå•è°ƒæ€§å®šä¹‰">å››è¾¹å½¢ä¸ç­‰å¼å®šä¹‰å’Œå•è°ƒæ€§å®šä¹‰</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_22f1d33479-23.PNG" alt="23.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_70a44cae79-24.png" alt="24.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_9708b8d079-25.PNG" alt="25.PNG" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=310,INF=0x3f3f3f3f;
int f[N][N];
int sum[N];
int s[N][N];
int n;

int main()
{
    cin&gt;&gt;n;

    for(int i=1;i&lt;=n;i++)
    {
        cin&gt;&gt;sum[i];
        sum[i]+=sum[i-1];
        s[i][i]=i;
    }

    for(int len=2;len&lt;=n;len++)
    {
        for(int i=1;i+len-1&lt;=n;i++)
        {
            int j=i+len-1;
            f[i][j]=INF;
            for(int k=s[i][j-1];k&lt;=s[i+1][j];k++)
                if(f[i][j] &gt; f[i][k]+f[k+1][j]+sum[j]-sum[i-1])
                {
                    f[i][j] = f[i][k]+f[k+1][j]+sum[j]-sum[i-1];
                    s[i][j]=k;
                }
        }
    }

    cout&lt;&lt;f[1][n]&lt;&lt;endl;

    return 0;
}

</code></pre>
<p><a href="https://www.acwing.com/problem/content/1070/">acwing1068</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_1733cf0c79-29.png" alt="29.png" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
const int N=210,INF=0x3f3f3f3f;
int f[N][N];
int g[N][N];
int w[N];
int sum[N];
int s[N][N];
int n;

int main()
{
    cin&gt;&gt;n;
    
    for(int i=1;i&lt;=n;i++)
    {
        cin&gt;&gt;w[i];
        w[n+i]=w[i];
    }
    
    for(int i=1;i&lt;=n*2;i++)
    {
        sum[i]=sum[i-1]+w[i];
        s[i][i]=i;
    }
    
    for(int len=2;len&lt;=n*2;len++)
    {
        for(int i=1;i+len-1&lt;=n*2;i++)
        {
            int j=i+len-1;
            f[i][j]=INF;
            for(int k=s[i][j-1];k&lt;=s[i+1][j];k++)
                if(f[i][j] &gt; f[i][k]+f[k+1][j]+sum[j]-sum[i-1])
                {
                    f[i][j] = f[i][k]+f[k+1][j]+sum[j]-sum[i-1];
                    s[i][j]=k;
                }
                
            g[i][j]=max(g[i+1][j],g[i][j-1])+sum[j]-sum[i-1];
        }
    }
    
    int maxv=0;
    int minv=INF;
    for(int i=1;i&lt;=n;i++)
    {
        maxv=max(maxv,g[i][n+i-1]);
        minv=min(minv,f[i][n+i-1]);
    }
    
    cout&lt;&lt;minv&lt;&lt;endl&lt;&lt;maxv&lt;&lt;endl;
    
    return 0;
}
</code></pre>
<h4 id="å››è¾¹å½¢ä¸ç­‰å¼å®šç†">å››è¾¹å½¢ä¸ç­‰å¼å®šç†</h4>
<figure data-type="image" tabindex="2"><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_ffe53f3c79-27.PNG" alt="27.PNG" loading="lazy"></figure>
<h4 id="ä¸€ç»´çº¿æ€§dpçš„å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–">ä¸€ç»´çº¿æ€§DPçš„å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–</h4>
<figure data-type="image" tabindex="3"><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_0a2e13bc79-28.PNG" alt="28.PNG" loading="lazy"></figure>
<p>æ¯”èµ›æ—¶ï¼Œæˆ‘ä»¬åªè¦å…ˆå†™å‡ºæš´åŠ›çš„ DP ç„¶åæ‰“å‡º costã€dpã€å’Œå†³ç­–æ•°ç»„ï¼ŒéªŒè¯ costã€dpå‡½æ•°æ˜¯å¦æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œ<br>
ä»¥åŠå†³ç­–æ˜¯å¦å…·æœ‰å•è°ƒæ€§ã€‚</p>
<ul>
<li>æ‹¿åˆ°é¢˜ç›®åï¼Œå…ˆåˆ¤æ–­wæ˜¯å¦å•è°ƒã€æ˜¯å¦æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œå†ä½¿ç”¨å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–DPã€‚</li>
</ul>
<h4 id="æœ€ä¼˜äºŒå‰æœç´¢æ ‘">æœ€ä¼˜äºŒå‰æœç´¢æ ‘</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_f95a567879-31.PNG" alt="31.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_e9d4e4fc79-30.PNG" alt="30.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_13099f6679-32.PNG" alt="32.PNG" loading="lazy"><br>
é¢˜ç›®ç»™å‡ºçš„æ•°åˆ—(val)æ˜¯æœ‰åºçš„ï¼Œå‡è®¾æˆ‘ä»¬ä»¥iä¸ºæ ¹ï¼Œ1<sub>i-1å°±æ˜¯å·¦å­æ ‘ï¼Œi+1</sub>nå°±æ˜¯å³å­æ ‘</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
const int N=260;
int w[N];
int sum[N];
int s[N][N];
int f[N][N];
int n;

int main()
{
	while(~scanf(&quot;%d&quot;,&amp;n))
	{
		for(int i=1;i&lt;=n;i++)
		{
			cin&gt;&gt;w[i];
			sum[i]=sum[i-1]+w[i];
			s[i][i]=i;
		}
		
		for(int len=1;len&lt;=n;len++)
		{
			for(int i=1;i+len-1&lt;=n;i++)
			{
				int j=i+len-1;
				f[i][j]=1e9;
				if(len == 1) f[i][j]=0;
				
				for(int k=s[i][j-1];k&lt;=s[i+1][j];k++)
					if(f[i][j] &gt; f[i][k-1]+f[k+1][j]+sum[j]-sum[i-1]-w[k])
					{
						f[i][j] = f[i][k-1]+f[k+1][j]+sum[j]-sum[i-1]-w[k];
						s[i][j]=k;
					}
			}
		}
		
		cout&lt;&lt;f[1][n]&lt;&lt;endl;
	}
	return 0;
}
</code></pre>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2829">hdu2829</a><br>
æœ‰ n ä¸ªç«è½¦ç«™ï¼Œç¬¬ i ä¸ªç«è½¦ç«™æœ‰ä¸€ä¸ªé‡è¦åº¦ a[i]ã€‚<br>
ä½ ç°åœ¨å¯ä»¥ç‚¸æ‰ m æ¡é“è½¨ã€‚è¿™æ ·é“è½¨å°±æ–­æˆäº† m + 1 æ®µï¼Œæ¯ä¸€æ®µéƒ½æœ‰ä¸€ä¸ªæˆ˜ç•¥å€¼ï¼Œå®ƒç­‰äºè¿™ä¸€æ®µé“è½¨ä¸Šçš„ç«è½¦ç«™ä¸¤ä¸¤çš„é‡è¦åº¦ä¹˜ç§¯ä¹‹å’Œã€‚è¯·ä½ æœ€å°åŒ–æ€»çš„æˆ˜ç•¥å€¼ä¹‹å’Œã€‚<br>
0 â‰¤ m &lt; n â‰¤ 1000</p>
<p>æ–œç‡ä¼˜åŒ–ï¼š<br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_e9dadca879-33.PNG" alt="33.PNG" loading="lazy"><br>
é‚£ä¹ˆï¼Œå°±æœ‰ï¼šdp[i][j] = min( dp[k][j-1] + w[k+1][i] )ï¼Œjâ‰¤k&lt;iï¼›<br>
æ–¹ç¨‹çš„æ„ä¹‰æ˜¯ï¼šç‚¸æ¯ä»“åº“kå’Œä»“åº“k+1ä¹‹é—´çš„é‚£æ®µé“è·¯ï¼ˆå³ç¬¬kæ®µé“è·¯ï¼‰ï¼Œç®—å‡ºæ€»ä»·å€¼ï¼Œæšä¸¾kæ‰¾åˆ°æœ€å°çš„ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•è®¡ç®—w[k+1][i]å‘¢ï¼Ÿå‡è®¾sum[i]=<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>âˆ‘</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>i</mi></msubsup><mi>v</mi><mo>[</mo><mi>k</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">\sum_{k=1}^{i}v[k]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.264274em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">âˆ‘</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.964564em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">]</span></span></span></span> ï¼Œé‚£ä¹ˆå°±æœ‰ï¼šw[1][i] = w[1][k] + w[k+1][i] + (v[1]+v[2]+â€¦+v[k]) Ã— (v[k+1]+v[k+2]+â€¦+v[i])= w[1][k] + w[k+1][i] + sum[k] Ã— (sum[i]-sum[k])<br>
å³w[k+1][i] = w[1][i] - w[1][k] - sum[k] Ã— (sum[i]-sum[k])</p>
<p>æˆ‘ä»¬æŠŠw[k+1][i]çš„è®¡ç®—å¼å¸¦å…¥çŠ¶æ€è½¬ç§»æ–¹ç¨‹å¾—åˆ°ï¼š<br>
dp[i][j] = min{ dp[k][j-1] + w[1][i] - w[1][k] - sum[k] Ã— (sum[i]-sum[k]) }</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N=1010;
int f[N][N];
int s[N],w[N];
int q[N];
int n,m;

int getY(int i,int j,int k)
{
	return f[i-1][j]-w[j]+s[j]*s[j]-f[i-1][k]+w[k]-s[k]*s[k];
}

int getX(int i,int j)
{
	return s[i]-s[j];
}

int main()
{
	while(~scanf(&quot;%d%d&quot;,&amp;n,&amp;m))
	{
		if(!n &amp;&amp; !m) break;
		
		for(int i=1;i&lt;=n;i++)
		{
			int x;
			scanf(&quot;%d&quot;,&amp;x);
			s[i]=s[i-1]+x;
			w[i]=w[i-1]+s[i-1]*x;
			f[0][i]=w[i];
		}
		
		for(int i=1;i&lt;=m;i++)
		{
			int hh=0,tt=-1;
			q[++tt]=0;
			for(int j=1;j&lt;=n;j++)
			{
				while(hh &lt; tt &amp;&amp; getY(i,q[hh+1],q[hh]) &lt;= s[j]*getX(q[hh+1],q[hh]))
					hh++;
				int k=q[hh];
				f[i][j]=f[i-1][k]+w[j]-w[k]-s[k]*(s[j]-s[k]);
				
				while(hh &lt; tt &amp;&amp; getY(i,q[tt],q[tt-1])*getX(j,q[tt]) &gt;= getY(i,j,q[tt])*getX(q[tt],q[tt-1]))
					tt--;
				q[++tt]=j;
			}			
		}
		
		printf(&quot;%d\n&quot;,f[m][n]);
	}
	return 0;
}
</code></pre>
<p>å››è¾¹å½¢ä¸ç­‰å¼ï¼š<br>
ç”¨ f[i][j] æ¥è¡¨ç¤ºåœ¨å‰ j ä¸ªç«è½¦ç«™ä¸­ç”¨äº† i ä¸ªç‚¸å¼¹å¾—åˆ°çš„æœ€å°çš„æˆ˜ç•¥å€¼æ€»å’Œã€‚<br>
æšä¸¾ä¸Šä¸€æ¬¡ä½¿ç”¨ç‚¸å¼¹çš„ä½ç½® kï¼Œå¾—åˆ°<br>
f[i][j] = min(f[i - 1][k] + w[k + 1][j])(i-1 &lt; k &lt; j)</p>
<p>w[i][j] = [i, j] ä¸­ä¸¤ä¸¤ä¹˜ç§¯ä¹‹å’Œ= [(a[i] + a[i + 1] + â€¦ + a[j])2 - (a[i]2 + a[i + 1]2 + â€¦ + a[j]2)] / 2<br>
å¯ä»¥éªŒè¯å®ƒæ˜¯æ»¡è¶³å•è°ƒæ€§å’Œå››è¾¹å½¢ä¸ç­‰å¼çš„ã€‚<br>
å› æ­¤è¿™é¢˜å¯ä»¥ç”¨å››è¾¹å½¢ä¸ç­‰å¼æ¥ä¼˜åŒ–ã€‚<br>
f[i][j] = min(f[i - 1][k] + w[k + 1][j])<br>
(s[i-1][j] &lt; k &lt; s[i+1][j])</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N=1010;
int f[N][N];
int a[N];
int w[N][N];
int p[N][N];
int n,m;

int main()
{
	while(~scanf(&quot;%d%d&quot;,&amp;n,&amp;m))
	{
		if(!n &amp;&amp; !m) break;
		
		for(int i=1;i&lt;=n;i++) scanf(&quot;%d&quot;,&amp;a[i]);
		
		for(int i=1;i&lt;=n;i++)
		{
			int sum=0;
			w[i][i]=0;
			for(int j=i+1;j&lt;=n;j++)
			{
				sum+=a[j-1];
				w[i][j]=w[i][j-1]+sum*a[j];
			}
		}
		
		//      æ‰“è¡¨
// 		for(int i=1;i&lt;=n;i++) 
// 		{
// 		    for(int j=1;j&lt;=n;j++)
// 		        cout&lt;&lt;w[i][j]&lt;&lt;' ';
// 		    cout&lt;&lt;endl;
// 		}
		
		for(int i=0;i&lt;=n;i++)
		{
			f[0][i]=w[1][i];
			p[0][i]=0;
			p[i][n+1]=n;
		}
	
		
		for(int i=1;i&lt;=m;i++)
			for(int j=n;j&gt;=1;j--)
			{
				f[i][j]=1e9;
				for(int k=p[i-1][j];k&lt;=p[i][j+1];k++)
					if(f[i][j] &gt; f[i-1][k] + w[k+1][j])
					{
						f[i][j] = f[i-1][k] + w[k+1][j];
						p[i][j]=k;
					}
			}
		
		printf(&quot;%d\n&quot;,f[m][n]);
	}
	return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ–œç‡ä¼˜åŒ–]]></title>
        <id>https://caifxh.github.io/post/xie-lu-you-hua/</id>
        <link href="https://caifxh.github.io/post/xie-lu-you-hua/">
        </link>
        <updated>2020-04-08T09:24:30.000Z</updated>
        <content type="html"><![CDATA[<p><img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_52e5180078-1.png" alt="1.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_55ff749078-2.png" alt="2.png" loading="lazy"></p>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3507">hdu3507</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_98db0db078-3.png" alt="3.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_3be50fce78-4.PNG" alt="4.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_3db0a1a678-5.PNG" alt="5.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_6b0c654078-6.png" alt="6.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_80a51b8678-7.PNG" alt="7.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_afd9578278-8.PNG" alt="8.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_d2b42cb478-9.PNG" alt="9.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_e1bc29be78-10.PNG" alt="10.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_e3da236678-11.PNG" alt="11.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_e70434fa78-12.PNG" alt="12.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_e8f70a9e78-13.PNG" alt="13.PNG" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=500010;
int f[N];
int s[N];
int q[N];
int n,m;

int getY(int i,int j)
{
	return f[i]+s[i]*s[i]-f[j]-s[j]*s[j];
}

int getX(int i,int j)
{
	return s[i]-s[j];
}

int main()
{
	while(~scanf(&quot;%d%d&quot;,&amp;n,&amp;m))
	{
		for(int i=1;i&lt;=n;i++)
		{
			scanf(&quot;%d&quot;,&amp;s[i]);
			s[i]+=s[i-1];
		}
		
		int hh=0,tt=-1;
		q[++tt]=0;
		
		for(int i=1;i&lt;=n;i++)
		{
			while(hh&lt;tt &amp;&amp; getY(q[hh+1],q[hh]) &lt;= 2*s[i]*getX(q[hh+1],q[hh]))
				hh++;
			int j=q[hh];
			f[i]=f[j]+(s[i]-s[j])*(s[i]-s[j])+m;
			while(hh&lt;tt &amp;&amp; getY(q[tt],q[tt-1])*getX(i,q[tt]) &gt;= getY(i,q[tt])*getX(q[tt],q[tt-1]))
				tt--;
			q[++tt]=i;
		}
		
		printf(&quot;%d\n&quot;,f[n]);
	}
	return 0;
}
</code></pre>
<p><img src="https://cdn.acwing.com/media/article/image/2020/04/07/9969_b435e00678-14.png" alt="14.png" loading="lazy"><br>
<a href="https://www.acwing.com/problem/content/description/304/">acwing302</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;cstring&gt;
using namespace std;
typedef long long LL;
const int N=300010;
LL st[N],sc[N];
LL f[N];
int q[N];
int n,s;

LL getY(int i,int j)
{
    return f[i]-f[j];
}

LL getX(int i,int j)
{
    return sc[i]-sc[j];
}

int main()
{
    cin&gt;&gt;n&gt;&gt;s;
    
    for(int i=1;i&lt;=n;i++)
    {
        scanf(&quot;%lld%lld&quot;,&amp;st[i],&amp;sc[i]);
        st[i]+=st[i-1];
        sc[i]+=sc[i-1];
    }
    
    int hh=0,tt=-1;
    q[++tt]=0;
    for(int i=1;i&lt;=n;i++)
    {
        int l=hh,r=tt;
        while(l&lt;r)
        {
            int mid=l+r&gt;&gt;1;
            if(getY(q[mid+1],q[mid]) &gt;= (s+st[i])*getX(q[mid+1],q[mid])) r=mid;
            else l=mid+1;
        }
        
        int j=q[l];
        f[i]=f[j]-(s+st[i])*sc[j]+s*sc[n]+st[i]*sc[i];
        while(hh&lt;tt &amp;&amp; getY(q[tt],q[tt-1])*getX(i,q[tt]) &gt;= getY(i,q[tt])*getX(q[tt],q[tt-1]))
            tt--;
        q[++tt]=i;
    }
    
    cout&lt;&lt;f[n]&lt;&lt;endl;
    
    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/description/305/">acwing303</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_1bbe8e4e78-15.png" alt="15.png" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N=100010,M=100010,P=110;
LL f[P][M];
LL d[N];
int t[M],a[M];
LL s[M];
int q[M];
int n,m,p;

LL getY(int i,int j,int k)
{
    return f[i-1][j]+s[j]-f[i-1][k]-s[k];
}

int getX(int i,int j)
{
    return i-j;
}

int main()
{
    cin&gt;&gt;n&gt;&gt;m&gt;&gt;p;
    
    for(int i=2;i&lt;=n;i++)
        cin&gt;&gt;d[i],d[i]+=d[i-1];
        
    for(int i=1;i&lt;=m;i++)
    {
        int h;
        cin&gt;&gt;h&gt;&gt;t[i];
        a[i]=t[i]-d[h];
    }
    
    sort(a+1,a+m+1);
    
    
    for(int i=1;i&lt;=m;i++) s[i]=s[i-1]+a[i];
    
    memset(f,0x3f,sizeof f);
    for(int i=0;i&lt;=p;i++) f[i][0]=0;
    
    for(int i=1;i&lt;=p;i++)
    {
        
        int hh=0,tt=-1;
        q[++tt]=0;
        
        for(int j=1;j&lt;=m;j++)
        {
            while(hh &lt; tt &amp;&amp; getY(i,q[hh+1],q[hh]) &lt;= (LL)a[j]*getX(q[hh+1],q[hh]))
                hh++;
            int k=q[hh];
            f[i][j]=f[i-1][k]+(LL)a[j]*(j-k)-(s[j]-s[k]);
            while(hh &lt; tt &amp;&amp; getY(i,q[tt],q[tt-1])*getX(j,q[tt]) &gt;= getY(i,j,q[tt])*getX(q[tt],q[tt-1]))
                tt--;
            q[++tt]=j;
        }
    }

    cout&lt;&lt;f[p][m]&lt;&lt;endl;
    
    return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P2120">P2120</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_cc43d24e79-17.PNG" alt="17.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_e7b6cfb879-18.PNG" alt="18.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/08/9969_ea64c32879-19.PNG" alt="19.PNG" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N=1000010;
LL f[N];
LL x[N],c[N],p[N];
LL sp[N],sxp[N];
int q[N];
int n;

LL getY(int i,int j)
{
	return f[i]+sxp[i]-f[j]-sxp[j];
}

LL getX(int i,int j)
{
	return sp[i]-sp[j];
}

int main()
{
	cin&gt;&gt;n;
	
	for(int i=1;i&lt;=n;i++)
	{
		scanf(&quot;%lld%lld%lld&quot;,&amp;x[i],&amp;p[i],&amp;c[i]);
		sp[i]=sp[i-1]+p[i];
		sxp[i]=sxp[i-1]+x[i]*p[i];
	}
	
	int hh=0,tt=-1;
	q[++tt]=0;
	
	for(int i=1;i&lt;=n;i++)
	{
		while(hh &lt; tt &amp;&amp; getY(q[hh+1],q[hh]) &lt;= x[i]*getX(q[hh+1],q[hh]))
			hh++;
		int j=q[hh];
		f[i]=f[j]+x[i]*(sp[i]-sp[j])-(sxp[i]-sxp[j])+c[i];
		while(hh &lt; tt &amp;&amp; getY(q[tt],q[tt-1])*getX(i,q[tt]) &gt;= getY(i,q[tt])*getX(q[tt],q[tt-1]))
			tt--;
		q[++tt]=i;
	}
	
	printf(&quot;%lld\n&quot;,f[n]);
	
	return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å‰ç¼€å’Œ å·®åˆ†]]></title>
        <id>https://caifxh.github.io/post/qian-zhui-he-chai-fen/</id>
        <link href="https://caifxh.github.io/post/qian-zhui-he-chai-fen/">
        </link>
        <updated>2020-04-07T16:42:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å‰ç¼€å’Œ"><a href="https://www.acwing.com/problem/content/797/">å‰ç¼€å’Œ</a></h3>
<p>ç»™å®šä¸€ä¸ªåºåˆ—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mn>1</mn><mo>âˆ’</mo><mi>n</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[1-n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>ã€‚<br>
æœ‰å¾ˆå¤šæ¬¡è¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®å½¢å¦‚:l r  è¯¢é—®<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>çš„åŒºé—´å’Œã€‚<br>
<code>æ¯æ¬¡è¯¢é—®çš„å¤æ‚åº¦è¦æ±‚ O(1)</code><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/08/9969_9251f5104a-1.PNG" alt="1.PNG" loading="lazy"></p>
<h4 id="é¢„å¤„ç†æ—¶é—´å¤æ‚åº¦on">é¢„å¤„ç†æ—¶é—´å¤æ‚åº¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></h4>
<pre><code>for(int i=1;i&lt;=n;i++)
{
    scanf(&quot;%d&quot;,&amp;a[i]);
    s[i]=s[i-1]+a[i];
}
</code></pre>
<h4 id="alrçš„åŒºé—´å’Œ-sr-sl-1"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>çš„åŒºé—´å’Œ: s[r]-s[l-1]</h4>
<h4 id="æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦o1">æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mn>1</mn><mo>)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></h4>
<pre><code>while(m--)
{
    int l,r;
    scanf(&quot;%d%d&quot;,&amp;l,&amp;r);
    printf(&quot;%d\n&quot;,s[r]-s[l-1]);
}
</code></pre>
<h2 id="pså‰ç¼€å’Œä¸‹æ ‡ä»1å¼€å§‹"><code>PS:å‰ç¼€å’Œä¸‹æ ‡ä»1å¼€å§‹</code></h2>
<h3 id="åŒºé—´åŠ å·®åˆ†"><a href="https://www.acwing.com/problem/content/799/">åŒºé—´åŠ /å·®åˆ†</a></h3>
<p>ç»™å®šä¸€ä¸ªåºåˆ—<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mn>1</mn><mo>âˆ’</mo><mi>n</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[1-n]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">n</span><span class="mclose">]</span></span></span></span>(åˆå€¼å…¨ä¸º0)ã€‚<br>
æœ‰å¾ˆå¤šæ¬¡æ“ä½œï¼Œæ¯ä¸ªæ“ä½œå½¢å¦‚:l r  å°†<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mo>[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">a[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>çš„æ¯ä¸ªå€¼åŠ ä¸Škã€‚<br>
æœ€åè¾“å‡ºæ•´ä¸ªæ•°ç»„ã€‚å¤æ‚åº¦è¦æ±‚<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo>(</mo><mi>n</mi><mo>)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/08/9969_bd972e544a-2.PNG" alt="2.PNG" loading="lazy"><br>
åŒºé—´åŠ [l,r]ï¼Œå®é™…ä¸Šæ˜¯å‘ç”Ÿäº†è¿™ä¸¤ä»¶äº‹ï¼š<br>
a[l]æ¯”å‰ä¸€ä¸ªå…ƒç´ å¤šäº†k;<br>
a[r+1]æ¯”å‰ä¸€ä¸ªå…ƒç´ å°‘äº†k.<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/08/9969_065512be4a-4.PNG" alt="4.PNG" loading="lazy"><br>
æˆ‘ä»¬ç”¨æ•°ç»„bè¡¨ç¤ºåˆšåˆšçš„å·®å€¼ï¼Œ<strong>b[i]=a[i]-a[i-1]</strong>.<br>
é‚£ä¹ˆï¼šåŒºé—´åŠ [ğ’,ğ’“]ï¼Œå¯ä»¥åŒ–ä¸ºè¿™ä¸¤ä¸ªæ“ä½œï¼š <strong>b[l]+=k; b[r+1]-=k;</strong></p>
<pre><code>void insert(int l,int r,int c)
{
    b[l]+=c;
    b[r+1]-=c;
}
</code></pre>
<p>å› æ­¤ï¼Œä¸€æ¬¡åŒºé—´åŠ åªä¿®æ”¹è¿™ä¸¤ä¸ªå…ƒç´ ï¼› æœ€ååˆ©ç”¨bæ•°ç»„æ±‚å‡ºaæ•°ç»„(aæ•°ç»„ä¸ºbæ•°ç»„çš„å‰ç¼€å’Œ)ï¼Œå¯¹bæ•°ç»„æ±‚ä¸€éå‰ç¼€å’Œå³ä¸ºç­”æ¡ˆã€‚</p>
<pre><code>for(int i=1;i&lt;=n;i++)
{
    b[i]+=b[i-1];
    printf(&quot;%d &quot;,b[i]);
}
</code></pre>
<p><code>PS:æ•°ç»„aåˆå€¼ä¸º0ï¼Œè¿›è¡Œnæ¬¡æ’å…¥æ“ä½œå¯å¾—åˆ°æ•°ç»„aã€‚</code></p>
<pre><code>for(int i=1;i&lt;=n;i++)
    scanf(&quot;%d&quot;,&amp;a[i]);
for(int i=1;i&lt;=n;i++)
    insert(i,i,a[i]);
</code></pre>
<h4 id="æ€»ç»“å·®åˆ†æ— éœ€æ„é€ å‰ç¼€å’Œéœ€æ„é€ ">æ€»ç»“ï¼šå·®åˆ†æ— éœ€æ„é€ ï¼Œå‰ç¼€å’Œéœ€æ„é€ </h4>
<p>é€šè¿‡ä¸Šè¿°çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬èƒ½è½»æ˜“åœ°å¤„ç†è¿™ä¸¤ç±»é—®é¢˜ï¼š</p>
<ul>
<li>æ•°ç»„å›ºå®šï¼Œç„¶åå¤§é‡è¯¢é—®ï¼›</li>
<li>å¤§é‡åšåŒºé—´åŠ ï¼Œæœ€åè¦ä½ ç»™å‡ºè¿™ä¸ªæ•°ç»„ã€‚</li>
</ul>
<h3 id="ä¾‹é¢˜">ä¾‹é¢˜</h3>
<p><a href="https://www.luogu.com.cn/problem/P2879">Luogu2879</a><br>
æœ‰å¥½å‡ å¤´ç‰›ä»ï¼‘åˆ°nçº¿æ€§æ’åˆ—ï¼Œæ¯å¤´ç‰›çš„é«˜åº¦ä¸ºh[i]ç°åœ¨å‘Šè¯‰ä½ è¿™é‡Œé¢çš„ç‰›çš„æœ€å¤§é«˜ åº¦ä¸ºmaxH,è€Œä¸”æœ‰rç»„å…³ç³»ï¼Œæ¯ç»„å…³ç³»è¾“å…¥ä¸¤ä¸ªæ•°å­—ï¼Œå‡è®¾ä¸ºaå’Œb,è¡¨ç¤ºç¬¬aå¤´ç‰›èƒ½çœ‹åˆ°ç¬¬bå¤´ç‰›ï¼Œèƒ½çœ‹åˆ°çš„æ¡ä»¶æ˜¯a, bä¹‹é—´çš„å…¶å®ƒç‰›çš„é«˜åº¦éƒ½ä¸¥æ ¼å°äºmin(h[a], h[b]),è€Œ h[b] &gt;= h[a] æœ€åæ±‚æ‰€æœ‰ç‰›çš„å¯èƒ½æœ€é«˜èº«é«˜è¾“å‡º</p>
<h4 id="æ€è·¯">æ€è·¯ï¼š</h4>
<p>é¦–å…ˆå‡è®¾æ‰€æœ‰ç‰›éƒ½æ˜¯æœ€é«˜èº«é«˜ã€‚ è¯»å…¥çš„çº¦æŸä¿¡æ¯éœ€è¦å»é‡ï¼Œè¿™ä¸ªåˆ©ç”¨æ’åºæˆ–è€…setå¯ä»¥è§£å†³ã€‚ å¯ä»¥å‘ç°å¯¹äºæ¯ä¸ªä½ç½®h[i],å‡è®¾å®ƒè¢«è¦†ç›–äº†xæ¬¡ï¼Œæœ€åç­”æ¡ˆå°±æ˜¯h[i]-x. å¦‚æœå‡ºç°äº†ä¸€å¯¹[l,r]ï¼ŒæŠŠåŒºé—´(l,r)çš„æ•°éƒ½-1å°±å¯ä»¥äº†ã€‚ï¼ˆæ³¨æ„åŒºé—´å¼€é—­ï¼‰</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;set&gt; 
using namespace std;
const int N=10010;
int height[N];
set&lt;pair&lt;int,int&gt; &gt; S;

int main()
{
	int n,i,h,r;
	cin&gt;&gt;n&gt;&gt;i&gt;&gt;h&gt;&gt;r;
	height[1]=h;//å·®åˆ†æ•°ç»„ 
	
	while(r--)
	{
		int a,b;
		cin&gt;&gt;a&gt;&gt;b;
		if(a&gt;b)
			swap(a,b);
		if(!S.count({a,b}))
		{
			S.insert({a,b});
			height[a+1]--;
			height[b]++;
		}
	}
	
	for(int i=1;i&lt;=n;i++)
	{
		height[i]+=height[i-1];
		cout&lt;&lt;height[i]&lt;&lt;endl;
	}
	return 0;
 } 
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P3406">Luogu3406</a><br>
è¯¥é“è·¯ç»è¿‡Nä¸ªåŸå¸‚ï¼Œæ¯ä¸ªåŸå¸‚éƒ½æœ‰ä¸€ä¸ªç«™ã€‚ä¸è¿‡ï¼Œç”±äºå„ä¸ªåŸå¸‚ä¹‹é—´ä¸èƒ½åè°ƒå¥½ ï¼Œäºæ˜¯ä¹˜è½¦æ¯ç»è¿‡ä¸¤ä¸ªç›¸é‚»çš„åŸå¸‚ä¹‹é—´ï¼ˆæ–¹å‘ä¸é™ï¼‰ï¼Œå¿…é¡»å•ç‹¬è´­ä¹°è¿™ä¸€å°æ®µçš„è½¦ ç¥¨ã€‚ç¬¬iæ®µé“è·¯è¿æ¥äº†åŸå¸‚iå’ŒåŸå¸‚i+1(1&lt;=i&lt;N)ã€‚å¦‚æœæ­ä¹˜çš„æ¯”è¾ƒè¿œï¼Œéœ€è¦è´­ä¹°å¤šå¼  è½¦ç¥¨ã€‚ç¬¬iæ®µé“è·¯è´­ä¹°çº¸è´¨å•ç¨‹ç¥¨éœ€è¦Aiåšè‰¾å…ƒã€‚ è™½ç„¶ä¸€äº›äº‹æƒ…æ²¡æœ‰åè°ƒå¥½ï¼Œå„æ®µé“è·¯å…¬å¸ä¹Ÿä¸ºäº†æ–¹ä¾¿ä¹˜å®¢ï¼Œæ¨å‡ºäº†ICå¡ã€‚å¯¹äºç¬¬iæ®µ é“è·¯ï¼Œéœ€è¦èŠ±Ciåšè‰¾å…ƒçš„å·¥æœ¬è´¹è´­ä¹°ä¸€å¼ ICå¡ï¼Œç„¶åä¹˜åè¿™æ®µé“è·¯ä¸€æ¬¡å°±åªè¦æ‰£ Bi(Bi&lt;Ai)å…ƒã€‚ICå¡å¯ä»¥æå‰è´­ä¹°ï¼Œæœ‰é’±å°±å¯ä»¥ä»ç½‘ä¸Šä¹°å¾—åˆ°ï¼Œè€Œä¸éœ€è¦äº²è‡ªå»å¯¹åº” çš„åŸå¸‚è´­ä¹°ã€‚å·¥æœ¬è´¹ä¸èƒ½é€€ï¼Œä¹Ÿä¸èƒ½è´­ä¹°è½¦ç¥¨ã€‚æ¯å¼ å¡éƒ½å¯ä»¥å……å€¼ä»»æ„æ•°é¢ã€‚å¯¹äº ç¬¬iæ®µé“è·¯çš„ICå¡ï¼Œæ— æ³•ä¹˜ååˆ«çš„é“è·¯çš„è½¦ã€‚ Uimç°åœ¨éœ€è¦å‡ºå·®ï¼Œè¦å»Mä¸ªåŸå¸‚ï¼Œä»åŸå¸‚P1å‡ºå‘åˆ†åˆ«æŒ‰ç…§P1,P2,P3...PMçš„é¡ºåºè®¿ é—®å„ä¸ªåŸå¸‚ï¼Œå¯èƒ½ä¼šå¤šæ¬¡è®¿é—®ä¸€ä¸ªåŸå¸‚ï¼Œä¸”ç›¸é‚»è®¿é—®çš„åŸå¸‚ä½ç½®ä¸ä¸€å®šç›¸é‚»ï¼Œè€Œä¸” ä¸ä¼šæ˜¯åŒä¸€ä¸ªåŸå¸‚ã€‚ ç°åœ¨ä»–å¸Œæœ›çŸ¥é“ï¼Œå‡ºå·®ç»“æŸåï¼Œè‡³å°‘ä¼šèŠ±æ‰å¤šå°‘çš„é’±ï¼ŒåŒ…æ‹¬è´­ä¹°çº¸è´¨è½¦ç¥¨ã€ä¹°å¡å’Œ å……å€¼çš„æ€»è´¹ç”¨ã€‚</p>
<p>ç›´æ¥æ¨¡æ‹Ÿæ¯æ®µé“è·¯çš„è¦†ç›–å³å¯</p>
<pre><code> #include&lt;iostream&gt;
using namespace std;
const int N=100010;
 int a[N];
 int b[N];//å·®åˆ†æ•°ç»„ 
 typedef long long LL;
 
 int main()
 {
 	int n,m;
 	cin&gt;&gt;n&gt;&gt;m;
 	for(int i=1;i&lt;=m;i++)
 		cin&gt;&gt;a[i];
 	for(int i=1;i&lt;m;i++)
 	{
 		b[min(a[i],a[i+1])]++;
 		b[max(a[i],a[i+1])]--;
	 }
	 
	 for(int i=1;i&lt;=n;i++)
	 	b[i]+=b[i-1];
	
//	for(int i=1;i&lt;=n;i++)
//		cout&lt;&lt;&quot;--&quot;&lt;&lt;b[i]&lt;&lt;' ';
	
	LL sum=0;
	for(int i=1;i&lt;n;i++)
	{
		LL ai,bi,ci;
		cin&gt;&gt;ai&gt;&gt;bi&gt;&gt;ci;
		sum+=min(ai*b[i],ci+bi*b[i]);
	}
	
	cout&lt;&lt;sum&lt;&lt;endl;
	return 0;
 }
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P1083">Luogu1083</a></p>
<h4 id="æ€è·¯1">æ€è·¯1ï¼š</h4>
<p>åˆ©ç”¨å·®åˆ†æ•°ç»„å­˜æ¯å¤©çš„æ•™å®¤ä½¿ç”¨æƒ…å†µï¼Œç„¶åæ±‚å‰ç¼€å’Œï¼Œå¦‚æœå‘ç°ä¸ç¬¦åˆè¦æ±‚ï¼Œå°±ä»åå¾€å‰æ’¤å›è®¢å•ï¼Œç›´åˆ°æ¯å¤©éƒ½ç¬¦åˆè¦æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ’¤å›çš„æœ€åä¸€ä¸ªï¼ˆä¹Ÿå°±æ˜¯æœ€é å‰çš„ä¸€ä¸ªï¼‰å³ä¸ºans</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
using namespace std;
int n,m;
const int N=1000010,INF=0x3f3f3f3f;
int a[N];
int b[N];
int l[N],r[N],d[N];
int res=INF;

int main()
{
	cin&gt;&gt;n&gt;&gt;m;
	
	for(int i=1;i&lt;=n;i++)
		scanf(&quot;%d&quot;,&amp;a[i]);
	
	for(int i=1;i&lt;=m;i++)
	{
		scanf(&quot;%d%d%d&quot;,&amp;d[i],&amp;l[i],&amp;r[i]);
		b[l[i]]+=d[i];
		b[r[i]+1]-=d[i];
	}
	
	int j=m;//ä»åå¾€å‰æ’¤å›è®¢å•ï¼Œç›´è‡³æ»¡è¶³è¦æ±‚ 
	int sum=0;
	for(int i=1;i&lt;=n;i++)
	{
		sum+=b[i];
		//cout&lt;&lt;sum&lt;&lt;' ';
		if(sum&gt;a[i])
		{
			//ä»åå¾€å‰æ’¤å› 
			while(sum&gt;a[i])
			{
				b[l[j]]-=d[j];
				b[r[j]+1]+=d[j];
				if(i&gt;=l[j] &amp;&amp; i&lt;=r[j])
					sum-=d[j];
				j--;
			}
			res=min(res,j);
		}	
	}
	
	if(res==INF)
		cout&lt;&lt;&quot;0&quot;;
    else 
		cout&lt;&lt;&quot;-1&quot;&lt;&lt;endl&lt;&lt;res+1&lt;&lt;endl;
    return 0;
}
</code></pre>
<h4 id="æ€è·¯2">æ€è·¯2ï¼š</h4>
<p>åœ¨è¿™ä¸ªé¢˜é‡Œï¼Œå› ä¸ºå¦‚æœå‰ä¸€ä»½è®¢å•éƒ½ä¸æ»¡è¶³ï¼Œé‚£ä¹ˆä¹‹åçš„æ‰€æœ‰è®¢å•éƒ½ä¸ç”¨ç»§ç»­è€ƒè™‘ï¼›è€Œå¦‚æœåä¸€ä»½è®¢å•éƒ½æ»¡è¶³ï¼Œé‚£ä¹ˆä¹‹å‰çš„æ‰€æœ‰è®¢å•ä¸€å®šéƒ½å¯ä»¥æ»¡è¶³ï¼Œç¬¦åˆå±€éƒ¨èˆå¼ƒæ€§ï¼Œæ‰€ä»¥å¯ä»¥äºŒåˆ†è®¢å•æ•°é‡ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
int n,m;
const int N=1000010,INF=0x3f3f3f3f;
int a[N];
int b[N];
int s[N],t[N],d[N];

bool check(int x)//åˆ¤æ–­å‰xä»½è®¢å•èƒ½å¦å…¨éƒ¨æ»¡è¶³ 
{
	memset(b,0,sizeof b);
	for(int i=1;i&lt;=x;i++)
	{
		b[s[i]]+=d[i];
		b[t[i]+1]-=d[i];
	}

	for(int i=1;i&lt;=n;i++)
	{
		b[i]+=b[i-1];
		if(b[i]&gt;a[i])
			return false;
	}
	return true;
}

int main()
{
//	freopen(&quot;test.in.txt&quot;,&quot;r&quot;,stdin);
//	freopen(&quot;test.out&quot;,&quot;w&quot;,stdout);
	scanf(&quot;%d%d&quot;,&amp;n,&amp;m);
	
	for(int i=1;i&lt;=n;i++)
		scanf(&quot;%d&quot;,&amp;a[i]);
	
	for(int i=1;i&lt;=m;i++)
	{
		scanf(&quot;%d%d%d&quot;,&amp;d[i],&amp;s[i],&amp;t[i]);
	}
	if(check(m))
	{
		puts(&quot;0&quot;);
		return 0;
	}
	int l=0,r=m;//lå–æˆ0ï¼Œé˜²æ­¢æ— è§£æƒ…å†µ 
	while(l&lt;r)
	{
		int mid=l+r+1&gt;&gt;1;
		if(check(mid))
			l=mid;
		else	
			r=mid-1;
	}
	cout&lt;&lt;-1&lt;&lt;endl;
	cout&lt;&lt;l+1&lt;&lt;endl;

    return 0;
}
</code></pre>
<h4 id="å‰ç¼€å’Œå·®åˆ†">å‰ç¼€å’Œ+å·®åˆ†</h4>
<p><a href="https://www.luogu.com.cn/problem/P3948">luoguP3948</a></p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;
const int N=80010;
typedef long long LL;
LL b[N];
int sum[N];
int n,opt,minn,maxx,l,r,x,f;
LL mod;
char ch[5];

int main()
{
    scanf(&quot;%d%d%lld%d%d&quot;,&amp;n,&amp;opt,&amp;mod,&amp;minn,&amp;maxx);
    for(int j=1;j&lt;=opt;j++){
        scanf(&quot;%s%d%d%&quot;,&amp;ch,&amp;l,&amp;r);
        if(ch[0]=='A'){
            scanf(&quot;%d&quot;,&amp;x);
            b[l]+=x;
            b[r+1]-=x;
        }
        else{
            int ans=0;
			LL now=0;
            for(int i=1;i&lt;=r;i++){
                now+=b[i];
                if(i&gt;=l&amp;&amp;(now*i)%mod&gt;=minn&amp;&amp;(now*i)%mod&lt;=maxx)ans++;
            }
            printf(&quot;%d\n&quot;,ans);
        }
    }
    scanf(&quot;%d&quot;,&amp;f);
    for(int i=1;i&lt;=n;i++){
        b[i]+=b[i-1];
        if((b[i]*i)%mod&gt;=minn&amp;&amp;(b[i]*i)%mod&lt;=maxx)sum[i]=sum[i-1]+1;
        else sum[i]=sum[i-1];
    }
    for(int j=1;j&lt;=f;j++){
        scanf(&quot;%d%d&quot;,&amp;l,&amp;r);
        printf(&quot;%d\n&quot;,sum[r]-sum[l-1]);
    }
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å•è°ƒæ•°æ®ç»“æ„]]></title>
        <id>https://caifxh.github.io/post/dan-diao-shu-ju-jie-gou/</id>
        <link href="https://caifxh.github.io/post/dan-diao-shu-ju-jie-gou/">
        </link>
        <updated>2020-04-07T16:41:48.000Z</updated>
        <content type="html"><![CDATA[<h4 id="å•è°ƒæ ˆ">å•è°ƒæ ˆ</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_93bac9686e-28.PNG" alt="28.PNG" loading="lazy"><br>
ç»™å®šä¸€ä¸ªåºåˆ—ã€‚å¯¹åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œæ±‚å‡ºå®ƒå·¦ä¾§çš„ç¬¬ä¸€ä¸ªå°äºå®ƒ çš„å…ƒç´ çš„ä½ç½®ã€‚è‹¥æ²¡æœ‰è¿™æ ·çš„å…ƒç´ ï¼Œè¾“å‡º0ã€‚</p>
<blockquote></blockquote>
<p>æ ·ä¾‹è¾“å…¥ï¼š<br>
4<br>
5 3 7 4<br>
æ ·ä¾‹è¾“å‡ºï¼š<br>
0 0 2 2</p>
<p><img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_d560c46c6e-29.PNG" alt="29.PNG" loading="lazy"><br>
<a href="https://www.acwing.com/problem/content/832/">æ¨¡æ¿é¢˜1</a></p>
<pre><code>#include&lt;iostream&gt;
using namespace std;
const int N=100010;
int stk[N],top;

int main()
{
    int n;
    cin&gt;&gt;n;
    while(n--)
    {
        int x;
        cin&gt;&gt;x;
        while(top&amp;&amp;stk[top]&gt;=x)
            top--;
        if(top)  
            cout&lt;&lt;stk[top]&lt;&lt;&quot; &quot;;
        else 
            cout&lt;&lt;-1&lt;&lt;&quot; &quot;;
        stk[++top]=x;
    }
    return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P5788">æ¨¡æ¿é¢˜2</a><br>
æ‰¾å‡ºç¬¬ i ä¸ªå…ƒç´ ä¹‹åç¬¬ä¸€ä¸ªå¤§äº aiçš„å…ƒç´ çš„ä¸‹æ ‡<br>
åˆ†æï¼š<br>
ä»åå¾€å‰æšä¸¾ï¼Œå¯¹äºi&lt;j,è‹¥a[i]&gt;=a[j],åˆ™jä¸å¯èƒ½æˆä¸ºä¸‹æ ‡å°äºiçš„å…ƒç´ çš„ç­”æ¡ˆã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=3e6+10;
int stk[N],top;
int n;
int a[N];
int ans[N];

int main()
{
	cin&gt;&gt;n;
	for(int i=1;i&lt;=n;i++) scanf(&quot;%d&quot;,&amp;a[i]);
	
	for(int i=n;i&gt;=1;i--)
	{
		while(top &amp;&amp; a[stk[top]] &lt;= a[i]) top--;
		
		if(top) ans[i]=stk[top];
		else ans[i]=0;
		
		stk[++top]=i;
		
	}
	
	for(int i=1;i&lt;=n;i++) printf(&quot;%d &quot;,ans[i]);
	return 0;
}
</code></pre>
<h4 id="ä¾‹é¢˜">ä¾‹é¢˜</h4>
<p><a href="https://vjudge.net/problem/POJ-2559">poj2559</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_b64b4e746e-30.PNG" alt="30.PNG" loading="lazy"><br>
é¦–å…ˆè€ƒè™‘æœ€å¤§é¢ç§¯çš„çŸ©å½¢Xçš„å·¦å³è¾¹ç•Œçš„æ€§è´¨ï¼š</p>
<p>è®¾å…¶å·¦è¾¹ç•Œä¸ºLï¼Œå³è¾¹ç•Œä¸ºRï¼Œåˆ™å…¶é«˜H = min{h[i] | L &lt;= i &lt;= R}</p>
<p>æ­¤æ—¶æœ€å¤§é¢ç§¯ä¸º (R - L + 1) * H</p>
<p>è‹¥æ­¤æ—¶å·¦è¾¹ç•Œçš„å·¦è¾¹é‚£ä¸ªçŸ©å½¢çš„é«˜åº¦ h[L-1] &gt;= H<br>
åˆ™å·¦è¾¹ç•Œå¯ä»¥å‘å·¦æ‹“å±•ï¼Œåˆ™æ–°çš„é¢ç§¯ä¸ºï¼š</p>
<p>(R - (L-1) + 1) * H &gt; åŸé¢ç§¯</p>
<p>åˆ™ä¸åŸå‡è®¾æ¡ä»¶å†²çª</p>
<p>æ•…å·¦è¾¹ç•Œå·¦è¾¹çš„é‚£ä¸ªçŸ©å½¢çš„é«˜åº¦ :h[L-1] &lt; H<br>
åŒç†å³è¾¹ç•Œå³è¾¹çš„é‚£ä¸ªçŸ©å½¢çš„é«˜åº¦ï¼š h[R+1] &lt; H</p>
<p>è®¾H = h[i]</p>
<p>æ‰€ä»¥å·¦è¾¹ç•ŒLæ˜¯æ»¡è¶³h[j-1] &lt; h[i]çš„æœ€å¤§çš„jï¼Œå³ä»iç‚¹å‘å·¦éå†çš„ç¬¬ä¸€ä¸ªé«˜åº¦æ¯”iå°çš„ç‚¹çš„å³è¾¹ä¸€ä¸ªç‚¹</p>
<p>è€Œå³è¾¹ç•ŒRæ˜¯æ»¡è¶³ h[j+1] &lt; h[i]çš„æœ€å°çš„jï¼Œå³ä»iç‚¹å‘å³éå†ç¬¬ä¸€ä¸ªé«˜åº¦æ¯”iå°çš„ç‚¹çš„å·¦è¾¹ä¸€ä¸ªç‚¹</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å•è°ƒæ ˆçš„æ€§è´¨å¾—åˆ°æ¯ä¸ªç¡®å®šç‚¹ï¼Œå³ç¡®å®šé«˜åº¦çš„æœ€å¤§é¢ç§¯çŸ©å½¢çš„å·¦å³è¾¹ç•Œï¼Œç„¶åæšä¸¾å–æœ€å¤§å³å¯ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef long long LL;
const int N=100010;
int h[N];
int l[N],r[N];
int stk[N],top;
int n;

int main()
{
	while(~scanf(&quot;%d&quot;,&amp;n) &amp;&amp; n)
	{
		top=0;
		for(int i=1;i&lt;=n;i++)
			scanf(&quot;%d&quot;,&amp;h[i]);
		
		for(int i=1;i&lt;=n;i++)//æ‰¾å‡ºh[i]å·¦è¾¹ç¬¬ä¸€ä¸ªå°äºh[i]çš„ä½ç½® 
		{
			while(top &amp;&amp; h[stk[top]] &gt;= h[i]) 
				top--;
			
			if(top) l[i]=stk[top]+1;
			else l[i]=1;//è¡¨ç¤ºå·¦è¾¹æ²¡æœ‰æ¯”h[i]å°çš„ä½ç½® 
			
			stk[++top]=i;
		}
		
		top=0;
		for(int i=n;i&gt;=1;i--)//æ‰¾å‡ºh[i]å³è¾¹ç¬¬ä¸€ä¸ªå°äºh[i]çš„ä½ç½® 
		{
			while(top &amp;&amp; h[stk[top]] &gt;= h[i])
				top--;
			if(top) r[i]=stk[top]-1;
			else r[i]=n;//è¡¨ç¤ºå³è¾¹æ²¡æœ‰æ¯”h[i]å¤§çš„ä½ç½® 
				
			stk[++top]=i; 
		}
		
		LL ans=0;
		for(int i=1;i&lt;=n;i++)
			ans=max(ans,(LL)h[i]*(r[i]-l[i]+1));
	
		printf(&quot;%lld\n&quot;,ans);
	}
	return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P1901">P1901</a><br>
å¯¹äºä¸€ä¸ªæ–°çš„ä¿¡å·å¡”:</p>
<ul>
<li>å½“ä»–åŠ å…¥æ ˆä¸­æ—¶,ä¼šæŒ¡ä½ä¹‹å‰æ¯”å®ƒä½çš„å¡”çš„ä¼ æ’­,åŒæ—¶ , ä¹Ÿä¼šæ¥å—åˆ°æ¯”å®ƒä½çš„å¡”çš„ä¿¡å·</li>
<li>æ‰€ä»¥å°†æ ˆé¡¶æ‰€æœ‰æ¯”å®ƒä½çš„å¡”åˆ é™¤,(å› ä¸ºä»–ä»¬å·²ç»ä¸èƒ½å†ä¼ æ’­ç»™å…¶ä»–å¡”ä¿¡å·äº†),åŒæ—¶ , æ–°çš„å¡”æ¥æ”¶åˆ°çš„èƒ½é‡åŠ ä¸Š åˆ æ‰çš„å¡”ä¼ æ’­çš„èƒ½é‡</li>
<li>å¯¹äºåŸæœ‰çš„é«˜åº¦æ¯”å®ƒé«˜çš„ä¿¡å·å¡”,ç¦»æ­¤æ–°çš„ä¿¡å·å¡”æœ€è¿‘çš„(å½“å‰æ ˆé¡¶å…ƒç´ ),ä¼šæ¥å—åˆ°æ–°çš„å¡”çš„ä¿¡å·</li>
<li>å†å°†æ­¤æ–°çš„ä¿¡å·å¡”åŠ å…¥æ ˆä¸­,æœ€åO(n)æ‰«ä¸€éå,è¾“å‡ºæœ€å¤§å€¼å³å¯</li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
const int N=1e6+10;
int stk[N],top;
int sum[N];
int h[N],w[N];
int n;

int main()
{
	cin&gt;&gt;n;
	for(int i=1;i&lt;=n;i++)
	{
		cin&gt;&gt;h[i]&gt;&gt;w[i];
		
		while(top &amp;&amp; h[stk[top]] &lt;= h[i])
			sum[i]+=w[stk[top--]];
		sum[stk[top]]+=w[i];
		
		stk[++top]=i;
	}
	
	int ans=0;
	for(int i=1;i&lt;=n;i++)
		ans=max(ans,sum[i]);
	
	printf(&quot;%d\n&quot;,ans);
	return 0;
}
</code></pre>
<p><a href="">P1823</a><br>
å…ˆå‡è®¾æ¯ä¸ªäººèº«é«˜ä¸åŒï¼Œè„‘è¡¥ä¸€ä¸‹èµ°è¿‡æ•´ä¸ªé˜Ÿåˆ—ã€‚</p>
<ul>
<li>è§‚å¯Ÿé˜Ÿä¼ä¸­çš„ä¸€ä¸ªäººAã€‚å¦‚æœæˆ‘ä»¬ä»–åé¢æ‰¾åˆ°äº†ä¸€ä¸ªæ¯”ä»–ä¸çŸ¥é“é«˜åˆ°å“ªé‡Œå»äº†çš„Bï¼ŒAå°±ä¸èƒ½ä¸Båé¢çš„äººè°ˆç¬‘é£ç”Ÿäº†ã€‚</li>
<li>å› æ­¤æˆ‘ä»¬å¯ä»¥ç»´æŠ¤ä¸€ä¸ªå•è°ƒæ ˆï¼Œè®°å½•æˆ‘ä»¬å·²ç»æ‰¾åˆ°è¿‡çš„é«˜äººï¼Œæ˜¾ç„¶æ ˆä¸Šçš„é«˜äººä»¬æŒ‰é«˜åº¦çš„é™åºæ’åˆ—ï¼Œæ ˆé¡¶çš„äººæœ€çŸ®ã€‚</li>
<li>å½“æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ–°çš„é«˜äººæ—¶ï¼Œä»–å¯ä»¥å‘æ ˆé‡Œæ¯”ä»–çŸ®çš„äººä¼ æˆäººç”Ÿç»éªŒï¼Œå¹¶è®©ä»–ä»¬å‡ºæ ˆã€‚å¦‚æœå‡ºæ ˆä¹‹åæ ˆéç©ºï¼Œä»–è¿˜å¯ä»¥ä¸æ ˆé¡¶çš„é«˜äººè°ˆç¬‘é£ç”Ÿã€‚ç„¶åæˆ‘ä»¬å†å¦è¯·è¿™ä½é«˜æ˜è¿›æ ˆã€‚</li>
<li>æˆ‘ä»¬è¿˜è¦è€ƒè™‘ä¸¤ä¸ªäººèº«é«˜ç›¸åŒçš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥åœ¨æ ˆé‡Œå­˜pair&lt;èº«é«˜ï¼Œäººæ•°&gt;å¹¶ç»´æŠ¤å®ƒã€‚</li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
typedef pair&lt;int,int&gt; PII;
#define x first
#define y second
typedef long long LL;
const int N=500010;
int h[N];
PII stk[N];
int top;
int n;

int main()
{
	cin&gt;&gt;n;
	LL ans=0;
	for(int i=1;i&lt;=n;i++)
	{
		scanf(&quot;%d&quot;,&amp;h[i]);
		
		PII p=make_pair(h[i],1);
		while(top &amp;&amp; stk[top].x &lt;= h[i])
		{
			if(stk[top].x == h[i]) 
				p.y+=stk[top].y;
			ans+=stk[top].y;
			top--;
		}
		
		if(top) ans++;
		stk[++top]=p;
	}
	printf(&quot;%lld\n&quot;,ans);
	return 0;
}
</code></pre>
<h4 id="å•è°ƒé˜Ÿåˆ—">å•è°ƒé˜Ÿåˆ—</h4>
<figure data-type="image" tabindex="1"><img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_5111bd346e-31.PNG" alt="31.PNG" loading="lazy"></figure>
<p><a href="https://www.luogu.com.cn/problem/P1886">æ¨¡æ¿é¢˜</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_55f2d4966e-32.PNG" alt="32.PNG" loading="lazy"><br>
å•è°ƒé˜Ÿåˆ—ä¸æ™®é€šé˜Ÿåˆ—ä¸ä¸€æ ·çš„åœ°æ–¹å°±åœ¨äºå•è°ƒé˜Ÿåˆ—æ—¢å¯ä»¥ä»é˜Ÿé¦–å‡ºé˜Ÿï¼Œä¹Ÿå¯ä»¥ä»é˜Ÿå°¾å‡ºé˜Ÿã€‚<br>
é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€æ ·å®ç°å•è°ƒé˜Ÿåˆ—å‘¢?<br>
å°±æ‹¿æ ·ä¾‹æ¥è°ˆè°ˆï¼Œè®¾ä»¥æœ€å°çš„ä¸ºæ ‡å‡†ã€‚</p>
<blockquote></blockquote>
<p>8 3<br>
1 3 -1 -3 5 3 6 7</p>
<p>ä¸‹æ–‡ä¸­æˆ‘ä»¬ç”¨qæ¥è¡¨ç¤ºå•è°ƒé˜Ÿåˆ—ï¼Œpæ¥è¡¨ç¤ºå…¶æ‰€å¯¹åº”çš„åœ¨åŸåˆ—è¡¨é‡Œçš„åºå·ã€‚</p>
<ul>
<li>
<p>ç”±äºæ­¤æ—¶é˜Ÿä¸­æ²¡æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œæˆ‘ä»¬ç›´æ¥ä»¤1è¿›é˜Ÿã€‚æ­¤æ—¶ï¼Œq={1},p={1}ã€‚</p>
</li>
<li>
<p>ç°åœ¨3é¢ä¸´ç€æŠ‰æ‹©ã€‚ä¸‹é¢åŸºäºè¿™æ ·ä¸€ä¸ªæ€æƒ³:å‡å¦‚æŠŠ3æ”¾è¿›å»ï¼Œå¦‚æœåé¢2ä¸ªæ•°éƒ½æ¯”å®ƒå¤§ï¼Œé‚£ä¹ˆ3åœ¨å…¶æœ‰ç”Ÿä¹‹å¹´å°±æœ‰å¯èƒ½æˆä¸ºæœ€å°çš„ã€‚æ­¤æ—¶ï¼Œq={1,3},p={1,2}</p>
</li>
<li>
<p>ä¸‹é¢å‡ºç°äº†-1ã€‚é˜Ÿå°¾å…ƒç´ 3æ¯”-1å¤§ï¼Œé‚£ä¹ˆæ„å‘³ç€åªè¦-1è¿›é˜Ÿï¼Œé‚£ä¹ˆ3åœ¨å…¶æœ‰ç”Ÿä¹‹å¹´å¿…å®šæˆä¸ºä¸äº†æœ€å°å€¼ï¼ŒåŸå› å¾ˆæ˜æ˜¾:å› ä¸ºå½“ä¸‹é¢3è¢«æ¡†èµ·æ¥ï¼Œé‚£ä¹ˆ-1ä¹Ÿä¸€å®šè¢«æ¡†èµ·æ¥ï¼Œæ‰€ä»¥3æ°¸è¿œä¸èƒ½å½“æœ€å°å€¼ã€‚æ‰€ä»¥ï¼Œ3ä»é˜Ÿå°¾å‡ºé˜Ÿã€‚åŒç†ï¼Œ1ä»é˜Ÿå°¾å‡ºé˜Ÿã€‚æœ€å-1è¿›é˜Ÿï¼Œæ­¤æ—¶q={-1},p={3}</p>
</li>
<li>
<p>å‡ºç°-3ï¼ŒåŒä¸Šé¢åˆ†æï¼Œ-1&gt;-3ï¼Œ-1ä»é˜Ÿå°¾å‡ºé˜Ÿ,-3ä»é˜Ÿå°¾è¿›é˜Ÿã€‚q={-3}ï¼Œp={4}ã€‚</p>
</li>
<li>
<p>å‡ºç°5ï¼Œå› ä¸º5&gt;-3ï¼ŒåŒç¬¬äºŒæ¡åˆ†æï¼Œ5åœ¨æœ‰ç”Ÿä¹‹å¹´è¿˜æ˜¯æœ‰å¸Œæœ›çš„ï¼Œæ‰€ä»¥5è¿›é˜Ÿã€‚æ­¤æ—¶ï¼Œq={-3,5},p={4,5}</p>
</li>
<li>
<p>å‡ºç°3ã€‚3å…ˆä¸é˜Ÿå°¾çš„5æ¯”è¾ƒï¼Œ3&lt;5ï¼ŒæŒ‰ç…§ç¬¬3æ¡çš„åˆ†æï¼Œ5ä»é˜Ÿå°¾å‡ºé˜Ÿã€‚3å†ä¸-3æ¯”è¾ƒï¼ŒåŒç¬¬äºŒæ¡åˆ†æï¼Œ3è¿›é˜Ÿã€‚æ­¤æ—¶ï¼Œq={-3,3},p={4,6}</p>
</li>
<li>
<p>å‡ºç°6ã€‚6ä¸3æ¯”è¾ƒï¼Œå› ä¸º3&lt;6ï¼Œæ‰€ä»¥3ä¸å¿…å‡ºé˜Ÿã€‚ç”±äº3ä»¥å‰å…ƒç´ éƒ½ï¼œ3ï¼Œæ‰€ä»¥ä¸å¿…å†æ¯”è¾ƒï¼Œ6è¿›é˜Ÿã€‚å› ä¸º-3æ­¤æ—¶å·²ç»åœ¨æ»‘åŠ¨çª—å£ä¹‹å¤–ï¼Œæ‰€ä»¥-3ä»é˜Ÿé¦–å‡ºé˜Ÿã€‚æ­¤æ—¶ï¼Œq={3,6},p={6,7}</p>
</li>
<li>
<p>å‡ºç°7ã€‚é˜Ÿå°¾å…ƒç´ 6å°äº7ï¼Œ7è¿›é˜Ÿã€‚æ­¤æ—¶ï¼Œq={3,6,7},p={6,7,8}ã€‚</p>
</li>
</ul>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å¯¹å•è°ƒé˜Ÿåˆ—çš„åŸºæœ¬æ“ä½œå·²ç»åˆ†æå®Œæ¯•ã€‚å› ä¸ºå•è°ƒé˜Ÿåˆ—ä¸­å…ƒç´ å¤§å°å•è°ƒé€’(å¢/å‡/è‡ªå®šä¹‰æ¯”è¾ƒ)ï¼Œå› æ­¤ï¼Œé˜Ÿé¦–å…ƒç´ å¿…å®šæ˜¯æœ€å€¼ã€‚æŒ‰é¢˜æ„è¾“å‡ºå³å¯ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
using namespace std;
const int N=1000010;
int a[N];
int q[N];
int n,k;

int main()
{
	scanf(&quot;%d%d&quot;,&amp;n,&amp;k);
	
	int hh=0,tt=-1;
	
	for(int i=1;i&lt;=n;i++)
		scanf(&quot;%d&quot;,&amp;a[i]);
		
	for(int i=1;i&lt;=n;i++)//æ±‚æ»‘åŠ¨çª—å£æœ€å°å€¼ 
	{
		if(hh &lt;= tt &amp;&amp; i-k&gt;= q[hh]) hh++;
		while(hh &lt;= tt &amp;&amp; a[q[tt]] &gt;= a[i])
			tt--;
		q[++tt]=i;
		if(i &gt;= k)
			printf(&quot;%d &quot;,a[q[hh]]);
	}
	puts(&quot;&quot;);
	
	hh=0,tt=-1;
	for(int i=1;i&lt;=n;i++)
	{
		if(hh &lt;= tt &amp;&amp; i-k&gt;=q[hh]) hh++;
		while(hh &lt;= tt &amp;&amp; a[q[tt]] &lt;= a[i])
			tt--;
		q[++tt]=i;
		if(i &gt;= k)
			printf(&quot;%d &quot;,a[q[hh]]);
	}
	return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/137/">acwing135</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/25/9969_1ff2c8586e-33.PNG" alt="33.PNG" loading="lazy"></p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
using namespace std;
const int N = 300010, INF = 0x3f3f3f3f;
int n, m;
int s[N];
int q[N];

int main()
{
    scanf(&quot;%d%d&quot;, &amp;n, &amp;m);
    for (int i = 1; i &lt;= n; i ++ ) scanf(&quot;%d&quot;, &amp;s[i]), s[i] += s[i - 1];

    int res = -INF;
    int hh = 0, tt = -1;
    q[++tt]=0;//å°†s[0]å…¥é˜Ÿ
    for (int i = 1; i &lt;= n; i ++ )
    {
        if(hh&lt;=tt &amp;&amp; i-m &gt; q[hh]) hh++;
        res=max(res,s[i]-s[q[hh]]);
        while (hh &lt;= tt &amp;&amp; s[q[tt]] &gt;= s[i]) tt -- ;
        q[ ++ tt] = i;
    }

    printf(&quot;%d\n&quot;, res);

    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[é«˜ç²¾åº¦]]></title>
        <id>https://caifxh.github.io/post/gao-jing-du/</id>
        <link href="https://caifxh.github.io/post/gao-jing-du/">
        </link>
        <updated>2020-04-07T16:40:47.000Z</updated>
        <content type="html"><![CDATA[<h4 id="é«˜ç²¾åº¦åŠ æ³•">é«˜ç²¾åº¦åŠ æ³•</h4>
<p>å½“è¿›è¡ŒåŠ æ³•è¿ç®—çš„æ•°å­—è¾ƒå¤§æ—¶ï¼Œå—å­˜å‚¨èŒƒå›´é™åˆ¶ï¼Œæ— æ³•ä½¿ç”¨intæˆ–longlongå‹å˜é‡è¿›è¡Œå­˜å‚¨ã€‚<br>
è€ƒè™‘åˆ°åŠ æ³•è¿ç®—çš„æœ¬è´¨ï¼Œä¸å¦¨å°†æ•°å­—æ‹†å¼€æ¥å­˜å‚¨ã€‚<br>
å¯¹äºä¸€ä¸ªè¶…è¿‡å˜é‡å­˜å‚¨æ•°æ®èŒƒå›´çš„æ•°å­—ï¼Œå¯ä»¥å°†è¿™ä¸ªæ•°å­—æ‹†å¼€ï¼Œæ‹†æˆä¸€ä½ä¸€ä½çš„ï¼Œæˆ–è€…æ˜¯å‡ ä½å‡ ä½çš„å­˜å‚¨åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œ ç”¨ä¸€ä¸ªæ•°ç»„å»è¡¨ç¤ºä¸€ä¸ªæ•°å­—</p>
<p>é‡‡ç”¨ç”¨é¡ºåºå­˜å‚¨æ•°æ®æ–¹å¼ï¼Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼šæœ€é«˜ä½è¿›ä½å˜å¾—å¾ˆå›°éš¾ã€‚<br>
æœ€é«˜ä½åœ¨num[0]ï¼Œæ‰€ä»¥ä¸€æ—¦æœ‰è¿›ä½ï¼Œéœ€è¦å°†num[]æ•°ç»„ä¸­æ¯ä¸€ä½éƒ½å¾€åç§»ï¼Œæ—¶é—´å¤æ‚åº¦O(len)<br>
Â·å€’åºå­˜å‚¨Â·ï¼šnum[]æ•°ç»„ä»0åˆ°len-1ä¾æ¬¡å­˜å‚¨æ•´æ•°ä¸ªä½åˆ°æœ€é«˜ä½ã€‚åˆ™æœ€é«˜ä½è¿›ä½æ—¶ï¼Œåªéœ€è¦num[len++]=tï¼Œtä¸ºæœ€é«˜ä½æ•°å­—</p>
<p>è¿›ä½ï¼š<br>
æ–¹æ³•ä¸€ï¼šè®¾ä¸€ä¸ªå˜é‡tï¼Œè®°å½•å½“å‰è¿›ä½<br>
è¾¹è®¡ç®—è¾¹è¿›ä½å’Œé€ä½ç›¸åŠ ä¸è¿›ä½æœ€åå†ç»Ÿä¸€è¿›ä½æ•ˆæœæ˜¯ä¸€æ ·çš„å¦‚ä¸‹ï¼Œå…ˆè¿›è¡Œä¸€éé€ä½ç›¸åŠ ã€‚<br>
ç„¶åï¼Œä»0å¼€å§‹éå†ä¸€éans.num[]ï¼Œå°†æœ¬ä½å¤§äº9çš„éƒ¨åˆ†è¿›ä½ç»™æ›´é«˜ä½ã€‚<br>
æœ€ååˆ¤æ–­æ˜¯å¦æœ€é«˜ä½æœ‰è¿›ä½ï¼Œæœ‰åˆ™ans.len++</p>
<p><a href="https://www.luogu.com.cn/problem/P1601">æ¨¡æ¿é¢˜</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=510;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum add(bignum a,bignum b)
{
	bignum c;
	c.len=max(a.len , b.len);
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]+b.m[i];
	for(int i=0;i&lt;c.len;i++)
		if(c.m[i] &gt; 9)
		{
			c.m[i+1]+=1;
			c.m[i]-=10;
		}
	if(c.m[c.len]) c.len++;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	len=strlen(s);
	b.len=len;
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=add(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="é«˜ç²¾åº¦å‡æ³•">é«˜ç²¾åº¦å‡æ³•</h4>
<ul>
<li>åˆ¤æ–­æ­£è´Ÿ</li>
<li>åŸºæœ¬å’ŒåŠ æ³•ä¸€æ¨¡ä¸€æ ·ï¼Œåªä¸è¿‡ä»è¿›ä½å˜æˆé€€ä½</li>
<li>é€€ä½åæ›´æ–°ç»“æœé•¿åº¦<br>
<a href="https://www.luogu.com.cn/problem/P2142">æ¨¡æ¿é¢˜</a></li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=10100;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

int judge(bignum a,bignum b)
{
	if(a.len &gt; b.len) return 1;
	if(a.len &lt; b.len) return -1;
	for(int i=a.len-1;i&gt;=0;i--)
	{
		if(a.m[i] &gt; b.m[i]) return 1;
		if(a.m[i] &lt; b.m[i]) return -1;
	}
	return 0;
}

bignum Minus(bignum a,bignum b)
{
	if(judge(a,b) == -1)
	{
		printf(&quot;-&quot;);
		return Minus(b,a);
	}

	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]-b.m[i];
	for(int i=0;i&lt;c.len;i++)
		if(c.m[i] &lt; 0)
		{
			c.m[i+1]-=1;
			c.m[i]+=10;
		}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	len=strlen(s);
	b.len=len;
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=Minus(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="é«˜ç²¾åº¦ä¹˜æ³•">é«˜ç²¾åº¦ä¹˜æ³•</h4>
<h4 id="1é«˜ç²¾ä½ç²¾">1.é«˜ç²¾*ä½ç²¾</h4>
<p>å°†åŠ æ³•è¿ç®—æ”¹ä¸ºä¹˜æ³•è¿ç®—å³å¯ã€‚<br>
æ³¨æ„ï¼š</p>
<ul>
<li>è¿›ä½çš„è¿ç®—</li>
<li>æœ€é«˜ä½è¿›ä½çš„å¤„ç†ï¼Œå¯èƒ½ä¸æ­¢è¿›ä¸€ä½<br>
<a href="https://www.acwing.com/problem/content/description/795/">æ¨¡æ¿é¢˜</a></li>
</ul>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=100010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum mul(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	for(int i=0;i&lt;c.len;i++) c.m[i]=a.m[i]*b;
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
		if(i == c.len-1 &amp;&amp; c.m[i+1]) c.len++;
	}

	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	int b;
	scanf(&quot;%d&quot;,&amp;b);

	bignum c=mul(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="2é«˜ç²¾é«˜ç²¾">2.é«˜ç²¾*é«˜ç²¾</h4>
<p>ä¹˜æ³•ç«–å¼ä¸­ï¼Œa.num[i]å’Œb.num[j]ç›¸ä¹˜çš„ç»“æœï¼Œæ”¾åœ¨äº†ans.num[i+j]çš„ä½ç½®ã€‚<br>
a,béƒ½ä¸ºæ­£æ•´æ•°æ—¶ï¼Œé•¿åº¦ä¸ºa.lenå’Œb.lençš„æ•°å­—ç›¸ä¹˜å¾—åˆ°ansï¼Œåˆ™<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/17/9969_ff4d713467-43.PNG" alt="43.PNG" loading="lazy"><br>
æ¨¡æ‹Ÿä¸Šä¾‹ç«–å¼è¿ç®—è¿‡ç¨‹å³å¯<br>
{æ¨¡æ¿é¢˜](https://www.luogu.com.cn/problem/P1303}</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=4010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};

bignum mul(bignum a,bignum b)
{
	bignum c;
	c.len=a.len+b.len;
	for(int i=0;i&lt;a.len;i++)
		for(int j=0;j&lt;b.len;j++)
			c.m[i+j]+=a.m[i]*b.m[j];
	for(int i=0;i&lt;c.len;i++)
	{
		c.m[i+1]+=c.m[i]/10;
		c.m[i]%=10;
	}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a,b;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	scanf(&quot;%s&quot;,s);
	b.len=len=strlen(s);
	for(int i=0;i&lt;len;i++)
		b.m[len-i-1]=s[i]-'0';
	bignum c=mul(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	return 0;
}
</code></pre>
<h4 id="é«˜ç²¾åº¦é™¤æ³•">é«˜ç²¾åº¦é™¤æ³•</h4>
<h4 id="1é«˜ç²¾ä½ç²¾-2">1.é«˜ç²¾/ä½ç²¾</h4>
<p>é™¤æ³•æ˜¯ä»é«˜ä½åˆ°ä½ä½è¿›è¡Œè¿ç®—çš„ã€‚ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥è®°å½•ä½™æ•°ï¼Œæ³¨æ„ç»†èŠ‚<br>
<a href="https://www.acwing.com/problem/content/description/796/">æ¨¡æ¿é¢˜</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=100010;
char s[N];
struct bignum
{
	int m[N],len;
	bignum()
	{
		memset(m,0,sizeof m);
		len=0;
	}
};
int t;

bignum Div(bignum a,int b)
{
	bignum c;
	c.len=a.len;
	t=0;
	for(int i=c.len-1;i&gt;=0;i--)
	{
		t=t*10+a.m[i];
		c.m[i]=t/b;
		t%=b;
	}
	while(c.len &gt; 1 &amp;&amp; !c.m[c.len-1]) c.len--;
	return c;
}

int main()
{
	scanf(&quot;%s&quot;,s);
	bignum a;
	int len=strlen(s);
	a.len=len;
	for(int i=0;i&lt;len;i++)
		a.m[len-i-1]=s[i]-'0';
	
	int b;
	scanf(&quot;%d&quot;,&amp;b);
	bignum c=Div(a,b);
	for(int i=c.len-1;i&gt;=0;i--)
		printf(&quot;%d&quot;,c.m[i]);
	puts(&quot;&quot;);
	printf(&quot;%d\n&quot;,t);

	return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/P1255">æ•°æ¥¼æ¢¯</a><br>
æ–æ³¢é‚£å¥‘é€’æ¨<br>
<a href="https://paste.ubuntu.com/p/JKWpDTPXrj/">code</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ ‘å½¢dp]]></title>
        <id>https://caifxh.github.io/post/shu-xing-dp/</id>
        <link href="https://caifxh.github.io/post/shu-xing-dp/">
        </link>
        <updated>2020-04-06T03:53:35.000Z</updated>
        <content type="html"><![CDATA[<h4 id="æ ‘çš„é‡å¿ƒ">æ ‘çš„é‡å¿ƒ</h4>
<p>å¯¹äºä¸€æ£µ n ä¸ªèŠ‚ç‚¹çš„æ— æ ¹æ ‘ï¼Œæ‰¾åˆ°ä¸€ä¸ªç‚¹ Aï¼Œä½¿å¾—æŠŠæ ‘å˜æˆä»¥<br>
è¯¥ç‚¹ä¸ºæ ¹çš„æœ‰æ ¹æ ‘æ—¶ï¼Œæœ€å¤§å­æ ‘çš„ç»“ç‚¹æ ‘æœ€å°ã€‚A å«åšé‡å¿ƒã€‚<br>
ç»™å®šä¸€æ£µæ ‘ï¼Œæ‰¾é‡å¿ƒã€‚<br>
æ±‚ä¸€ä¸‹æ¯ä¸ªç‚¹å­æ ‘çš„ç‚¹æ•°ï¼Œç„¶åå¯¹äºæ¯ä¸ªç‚¹è€ƒè™‘ä¸€ä¸‹ä»–ä½œä¸ºé‡å¿ƒ<br>
æ—¶å€™æœ€å¤§å­æ ‘çš„å¤§å°æ˜¯å¤šå°‘ï¼Œå’Œå½“å‰çš„é‡å¿ƒè¿›è¡Œæ¯”å¯¹å°±å¯ä»¥äº†ã€‚<br>
ä»£ç éå¸¸ç®€å•æ˜“æ‡‚ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
using namespace  std;
const int N=100010,M=N*2;
int h[N],e[M],ne[M],idx;
int ans=N;
bool st[N];
int cnt[N];
int n;
int poi;

void add(int a,int b)
{
    e[idx]=b;
    ne[idx]=h[a];
    h[a]=idx++;
}

void dfs(int u,int fa)
{
    cnt[u]=1;
    int res=0;
    for(int i=h[u];i!=-1;i=ne[i])
    {
        int j=e[i];
        if(j == fa)
            continue;
        dfs(j,u);
        cnt[u]+=cnt[j];
        res=max(res,cnt[j]);
    }
    res=max(res,n-cnt[u]);

    if(res &lt; ans)
    {
        ans=res;
        poi=u;
    }
}

int main()
{
    
    memset(h,-1,sizeof h);
    cin&gt;&gt;n;
    for(int i=0;i&lt;n-1;i++)
    {
        int a,b;
        cin&gt;&gt;a&gt;&gt;b;
        add(a,b);
        add(b,a);
    }
    
    dfs(1,-1);
    
    cout&lt;&lt;ans&lt;&lt;endl;
    //cout&lt;&lt;poi&lt;&lt;endl;é‡å¿ƒ
    return 0;
}
</code></pre>
<h3 id="æ ‘çš„æœ€é•¿è·¯å¾„"><a href="https://www.acwing.com/problem/content/description/1074/">æ ‘çš„æœ€é•¿è·¯å¾„</a></h3>
<p>å¦¨æšä¸¾ç›´å¾„åœ¨æ ‘ä¸Šè½¬å¼¯çš„ç‚¹ã€‚æ‰€ä»¥æˆ‘ä»¬ç»´æŠ¤å‡ºåˆ°ä¸€ä¸ªèŠ‚ç‚¹<br>
æ—¶å‘ä¸‹çš„æœ€é•¿é“¾å’Œæ¬¡é•¿é“¾ï¼Œç„¶åç”¨äºŒè€…åŠ å’Œæ¥æ›´æ–°ç­”æ¡ˆï¼ŒåŒæ—¶æ›´<br>
æ–°çˆ¶äº²èŠ‚ç‚¹çš„æœ€é•¿é“¾å’Œæ¬¡é•¿é“¾ã€‚<br>
f[i][0]è¡¨ç¤ºæ ¹èŠ‚ç‚¹ä¸ºiï¼Œå‘ä¸‹æ‰€èƒ½åˆ°è¾¾çš„æœ€é•¿è·¯å¾„é•¿åº¦<br>
f[i][1]è¡¨ç¤ºæ ¹èŠ‚ç‚¹ä¸ºiï¼Œå‘ä¸‹æ‰€èƒ½åˆ°è¾¾çš„æ¬¡é•¿è·¯å¾„é•¿åº¦</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=10010,M=N*2;
int h[N],e[M],ne[M],w[M],idx;
int n,m;
int ans;
int f[N][2];//0è¡¨ç¤ºæœ€é•¿è·¯å¾„ï¼Œ 1è¡¨ç¤ºæ¬¡é•¿è·¯å¾„

void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs(int u,int fa)
{
    for(int i=h[u];~i;i=ne[i])
    {
        int v=e[i];
        if(v == fa)
            continue;
        dfs(v,u);
        if(f[v][0] + w[i] &gt; f[u][0])
        {
            f[u][1]=f[u][0];
            f[u][0]=f[v][0]+w[i];
        }
        else if(f[v][0] + w[i] &gt; f[u][1])
            f[u][1]=f[v][0]+w[i];
    }
    
    ans=max(ans,f[u][0]+f[u][1]);
}

int main()
{
    cin&gt;&gt;n;
    memset(h,-1,sizeof h);
    for(int i=0;i&lt;n-1;i++)
    {
        int a,b,c;
        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;
        add(a,b,c);
        add(b,a,c);
    }

    dfs(1,-1);

    cout&lt;&lt;ans&lt;&lt;endl;

    return 0;
}
</code></pre>
<h3 id="hdu2196"><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2196">hdu2196</a></h3>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_8fd00bd859-5.png" alt="5.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_97f5be6659-6.png" alt="6.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_9a64697c59-7.png" alt="7.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_9cf7fd0c59-8.png" alt="8.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_a95f556859-9.png" alt="9.png" loading="lazy"><br>
f[i][0]è¡¨ç¤ºæ ¹èŠ‚ç‚¹ä¸ºiï¼Œå‘ä¸‹æ‰€èƒ½åˆ°è¾¾çš„æœ€é•¿è·¯å¾„é•¿åº¦<br>
f[i][1]è¡¨ç¤ºæ ¹èŠ‚ç‚¹ä¸ºiï¼Œå‘ä¸‹æ‰€èƒ½åˆ°è¾¾çš„æ¬¡é•¿è·¯å¾„é•¿åº¦<br>
f[i][2]è¡¨ç¤ºæ ¹èŠ‚ç‚¹ä¸ºiï¼Œå‘ä¸Šæ‰€èƒ½åˆ°è¾¾çš„æœ€é•¿è·¯å¾„é•¿åº¦</p>
<p>ï¼ˆ1ï¼‰f[i][0]ï¼Œf[i][1]çš„æ±‚æ³•åŒæ ‘çš„ç›´å¾„<br>
ï¼ˆ2ï¼‰f[i][2]çš„æ±‚æ³•åˆ†ä¸¤ç§æƒ…å†µï¼š<br>
â‘ ä»çˆ¶ç»“ç‚¹å‘ä¸Šèµ°çš„æœ€é•¿è·¯å¾„é•¿åº¦<br>
â‘¡ä»çˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°å…¶ä»–å­æ ‘çš„æœ€é•¿è·¯å¾„é•¿åº¦ï¼ˆè‹¥çˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°çš„æœ€é•¿è·¯å¾„ç»è¿‡å½“å‰ç‚¹ï¼Œåˆ™å‘ä¸‹èµ°å…¶ä»–å­æ ‘çš„æœ€é•¿è·¯å¾„é•¿åº¦ä¸ºçˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°çš„æ¬¡é•¿è·¯å¾„é•¿åº¦ï¼›è‹¥ä¸ç»è¿‡ï¼Œåˆ™å–çˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°çš„æœ€é•¿è·¯å¾„ï¼‰</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=10010,M=N*2;
int h[N],e[M],ne[M],w[M],idx;
int n;
int f[N][3]; // 0è¡¨ç¤ºå‘ä¸‹èµ°çš„æœ€å¤§é•¿åº¦ï¼Œ1è¡¨ç¤ºæ¬¡å¤§é•¿åº¦ï¼Œ2è¡¨ç¤ºå‘ä¸Šèµ°çš„æœ€å¤§é•¿åº¦

void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs_d(int u,int fa)
{
    int one=0,two=0;
    for(int i=h[u];~i;i=ne[i])
    {
        int j=e[i];
        if(j == fa)
            continue;
        dfs_d(j,u);
        //cout&lt;&lt;u&lt;&lt;&quot;:&quot;&lt;&lt;j&lt;&lt;&quot; &quot;&lt;&lt;d&lt;&lt;endl;
        int d=f[j][0]+w[i];
        if(d &gt; one) 
            two=one,one=d;
        else if(d &gt; two)
            two=d;
    }
    f[u][0]=one;
    f[u][1]=two;
}

void dfs_u(int u,int fa)//å…ˆæ›´æ–°åé€’å½’
{
    for(int i=h[u];~i;i=ne[i])
    {
        int j=e[i];
        if(j == fa) 
            continue;
        if(f[j][0] + w[i] == f[u][0])//çˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°çš„æœ€é•¿è·¯å¾„ç»è¿‡å½“å‰ç‚¹
            f[j][2]=max(f[u][2],f[u][1])+w[i];
        else 
            f[j][2]=max(f[u][2],f[u][0])+w[i];//çˆ¶èŠ‚ç‚¹å‘ä¸‹èµ°çš„æœ€é•¿è·¯å¾„ä¸ç»è¿‡å½“å‰ç‚¹
        dfs_u(j,u);
    }
}

int main()
{
    while(~scanf(&quot;%d&quot;,&amp;n))
    {
        memset(h,-1,sizeof h);
        memset(f,0,sizeof f);
        idx=0;
        
        for(int i=2;i&lt;=n;i++)
        {
            int a,b;
            cin&gt;&gt;a&gt;&gt;b;
            add(i,a,b);
            add(a,i,b);
        }
        
        dfs_d(1,-1);//å­èŠ‚ç‚¹æ›´æ–°çˆ¶èŠ‚ç‚¹
        
        dfs_u(1,-1);//çˆ¶èŠ‚ç‚¹æ›´æ–°å­èŠ‚ç‚¹
        
        for(int i=1;i&lt;=n;i++)
            cout&lt;&lt;max(f[i][0],f[i][2])&lt;&lt;endl;
    }
    
    return 0;
}
</code></pre>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_87cfb6ac54-azdp.png" alt="azdp.png" loading="lazy"><br>
æˆ‘ä»¬é€šå¸¸è®¤ä¸ºï¼Œæ ‘å½¢DPçš„å†™æ³•æœ‰ä¸¤ç§ï¼š<br>
a.æ ¹åˆ°å¶å­: ä¸è¿‡è¿™ç§åŠ¨æ€è§„åˆ’åœ¨å®é™…çš„é—®é¢˜ä¸­è¿ç”¨çš„ä¸å¤šã€‚<br>
b.å¶å­åˆ°æ ¹: æ—¢æ ¹çš„å­èŠ‚ç‚¹ä¼ é€’æœ‰ç”¨çš„ä¿¡æ¯ç»™æ ¹ï¼Œå®Œåæ ¹å¾—å‡ºæœ€ä¼˜è§£çš„è¿‡ç¨‹ã€‚è¿™ç±»çš„ä¹ é¢˜æ¯”è¾ƒçš„å¤šã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_9c10e58c54-1.png" alt="1.png" loading="lazy"><br>
<a href="http://acm.hdu.edu.cn/showproblem.php?pid=1520">hdu1520</a></p>
<h4 id="æœ€å¤§ç‹¬ç«‹é›†">æœ€å¤§ç‹¬ç«‹é›†</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_cc54b78254-2.png" alt="2.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_d8be803454-3.png" alt="3.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
using namespace std;
const int N=6000+10;
int val[N],dp[N][2],fa[N],n;
vector&lt;int&gt;E[N];

void dfs(int u){
	dp[u][0]=0;
	dp[u][1]=val[u];
	for(int i=0;i&lt;E[u].size();i++){
		int v=E[u][i];
		dfs(v);
		dp[u][0]+=max(dp[v][1],dp[v][0]);
		dp[u][1]+=dp[v][0];
	}
}

int main(){
	while(~scanf(&quot;%d&quot;,&amp;n)){
		for(int i=1;i&lt;=n;i++){
			scanf(&quot;%d&quot;,&amp;val[i]);
			E[i].clear();
			fa[i]=-1;
		}
		while(1){
			int a,b;
			scanf(&quot;%d%d&quot;,&amp;a,&amp;b);
	        if(a==0&amp;&amp;b==0) break;
	        E[b].push_back(a);
	        fa[a]=b;
		}
	    int rt=1;
	    while(fa[rt]!=-1) rt=fa[rt];
	    dfs(rt);
	    printf(&quot;%d\n&quot;,max(dp[rt][1],dp[rt][0]));
    }
    return 0;
}
</code></pre>
<p><a href="http://poj.org/problem?id=3398">poj3398</a></p>
<h4 id="æœ€å°æ”¯é…é›†">æœ€å°æ”¯é…é›†</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_0583dd4659-1.png" alt="1.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_9030541459-2.png" alt="2.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_a03cff4259-3.png" alt="3.png" loading="lazy"> <img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_b3418f3659-4.png" alt="4.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt; 
#include&lt;cstring&gt;
#include&lt;vector&gt;
#include&lt;algorithm&gt;
using namespace std;
const int maxn=10010;
int n;
vector&lt;int&gt; E[maxn];
int dp[maxn][3];

void dfs(int u,int fa)
{
    dp[u][0]=1; //åŠ ä¸Šè‡ªèº«ä¸ºæœåŠ¡å™¨,é€‰æ‹©å½“å‰ç»“ç‚¹ 
    dp[u][1]=0;//ä¸é€‰å½“å‰ç»“ç‚¹ï¼Œé€‰å…¶çˆ¶èŠ‚ç‚¹ 
    dp[u][2]=maxn;//é€‰ä¸€ä¸ªå­èŠ‚ç‚¹ 
    int k=E[u].size();
    for(int i=0;i&lt;k;i++)
    {
        int v=E[u][i];
        if(v==fa) continue;
        dfs(v,u);
        dp[u][0]+=min(dp[v][0],dp[v][1]);
        dp[u][1]+=dp[v][2];
    }
    for(int i=0;i&lt;k;i++)
    {
        int v=E[u][i];
        if(v==fa)  continue;
        dp[u][2]=min(dp[u][2],dp[u][1]-dp[v][2]+dp[v][0]);
    }
}

int main()
{
    int u,v;
    while(scanf(&quot;%d&quot;,&amp;n))
    {
        for(int i=1;i&lt;=n;i++)
            E[i].clear();
        for(int i=1;i&lt;n;i++)
        {
            scanf(&quot;%d%d&quot;,&amp;u,&amp;v);
            E[u].push_back(v);
            E[v].push_back(u);
        }
        dfs(1,0);
		printf(&quot;%d\n&quot;,min(dp[1][0],dp[1][2])); 
		int t;
		scanf(&quot;%d&quot;,&amp;t);
		if(t == -1)
			break;
    }
    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/1079/#">acwing1077</a><br>
é¢˜ç›®è¯´çš„å¾ˆæ¸…æ¥šï¼Œç”¨æœ€å°‘çš„ç‚¹è¦†ç›–æ‰€æœ‰çš„ç‚¹ã€‚é¢˜ç›®ç»™å‡ºçš„æ˜¯ä¸ªæ ‘,æ‰€ä»¥å¯ä»¥ç”¨åŠ¨æ€è§„åˆ’æ¥è§£å†³ã€‚<br>
ç»™å‡ºå¦‚ä¸‹å®šä¹‰ï¼š<br>
f[u][0]è¡¨ç¤º uä¸æ”¾çœ‹å®ˆ ,ä¸”uç‚¹è¢«çˆ¶èŠ‚ç‚¹ç›‘è§†,<br>
æ˜“å¾—åœ¨è¿™ç±»æƒ…å†µä¸‹å­èŠ‚ç‚¹å¯ä»¥è‡ªå·±æ”¾å®ˆå«æˆ–è€…åœ¨å­èŠ‚ç‚¹ä¸Šæ”¾å®ˆå«ã€‚<br>
ç”±äºæœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œä¸ºä½¿å¾—æ‰€æœ‰å­èŠ‚ç‚¹éƒ½è¢«çœ‹å®ˆï¼Œ<br>
æ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹çš„æœ€å°å€¼ç´¯åŠ æ±‚å’Œ<br>
f[u][0] = âˆ‘(min(f[j][1] , f[j][2]))</p>
<p>f[u][2]è¡¨ç¤ºuæ”¾çœ‹å®ˆ,<br>
æ—¢ç„¶uå·²ç»æ”¾ä¸Šäº†çœ‹å®ˆï¼Œè¯´æ˜å­èŠ‚ç‚¹å¿…ç„¶å·²ç»è¢«çœ‹åˆ°ï¼Œ<br>
å› æ­¤å¯¹äºæ‰€æœ‰å­èŠ‚ç‚¹å¯è‡ªå·±æ”¾å®ˆå«ï¼Œå¯è¢«çˆ¶èŠ‚ç‚¹ç›‘è§†ï¼Œå¯è¢«å­èŠ‚ç‚¹ç›‘è§†<br>
f[u][2] = âˆ‘min(min(f[j][0],f[j][1]),f[j][2])+w[u]</p>
<p>f[u][1]è¡¨ç¤º uä¸æ”¾çœ‹å®ˆ ,ä¸”uç‚¹è¢«ä¸€ä¸ªå„¿å­ç›‘è§†,<br>
é¦–å…ˆæˆ‘ä»¬å¯ä»¥æšä¸¾å½“å‰å“ªä¸€é¢—å­ç»“ç‚¹ç›‘è§†uï¼Œå…¶ä½™èŠ‚ç‚¹å¯è‡ªå·±æ”¾å®ˆå«æˆ–åœ¨å­èŠ‚ç‚¹æ”¾å®ˆå«ï¼Œ<br>
f[u][1]=min(f[u][1],f[j][2]+âˆ‘min(f[k][2],f[k][1])),jä¸ºå½“å‰ç›‘è§†uçš„ç»“ç‚¹ï¼Œkä¸ºé™¤äº†jä¹‹å¤–uå…¶ä»–çš„å­èŠ‚ç‚¹<br>
è€Œf[u][0]=âˆ‘(min(f[j][1] , f[j][2]))<br>
åˆ™f[u][1]=min(f[u][1],f[j][2]+f[u][0] - min(f[j][2],f[j][1]))</p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

const int N = 1510;

int n;
int h[N], w[N], e[N], ne[N], idx;
int f[N][3];
int fa[N];

void add(int a, int b)
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs(int u)
{
    f[u][2] = w[u];

    for (int i = h[u]; ~i; i = ne[i])
    {
        int j = e[i];
        dfs(j);
        f[u][0] += min(f[j][1], f[j][2]);
        f[u][2] += min(min(f[j][0], f[j][1]), f[j][2]);
    }

    f[u][1] = 1e9;
    for (int i = h[u]; ~i; i = ne[i])
    {
        int j = e[i];
        f[u][1] = min(f[u][1], f[u][0] + f[j][2] - min(f[j][1], f[j][2]));
    }
}

int main()
{
    cin &gt;&gt; n;

    memset(h, -1, sizeof h);
    memset(fa,-1,sizeof fa);
    for (int i = 1; i &lt;= n; i ++ )
    {
        int id, cost, cnt;
        cin &gt;&gt; id &gt;&gt; cost &gt;&gt; cnt;
        w[id] = cost;
        while (cnt -- )
        {
            int ver;
            cin &gt;&gt; ver;
            add(id, ver);
            fa[ver]=id;
        }
    }

    int root = 1;
    while (fa[root] != -1) root =fa[root] ;

    dfs(root);

    cout &lt;&lt; min(f[root][1], f[root][2]) &lt;&lt; endl;

    return 0;
}
</code></pre>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=2412">hdu2412</a></p>
<h4 id="æœ€å¤§ç‹¬ç«‹é›†å”¯ä¸€æ€§åˆ¤æ–­">æœ€å¤§ç‹¬ç«‹é›†+å”¯ä¸€æ€§åˆ¤æ–­</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_2ff74c5054-4.png" alt="4.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_3ad95a6454-5.png" alt="5.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_5315ab5054-6.png" alt="6.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_6272ec5c54-7.png" alt="7.png" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;string&gt;
#include&lt;cstring&gt;
#include&lt;map&gt;
#include&lt;vector&gt;
using namespace std;
const int N=200+10;
int dp[N][2],f[N][2],n;
vector&lt;int&gt;E[N];

void dfs(int u){
   	dp[u][0]=0;
	dp[u][1]=1;
	for(int i=0;i&lt;E[u].size();i++){
		int v=E[u][i];
		dfs(v);
		if(dp[v][0]==dp[v][1]){
			dp[u][0]+=dp[v][0];
			f[u][0]=0;
		}else if(dp[v][0]&gt;dp[v][1]){
			dp[u][0]+=dp[v][0];
			if(!f[v][0]) f[u][0]=0;
		}
		else{
			dp[u][0]+=dp[v][1];
			if(!f[v][1]) f[u][0]=0;
		}
		dp[u][1]+=dp[v][0];
		if(!f[v][0]) f[u][1]=0;
	}
}

int main(){
	int n,k;
	string s1,s2;
	map&lt;string,int&gt;mp;
	while(cin&gt;&gt;n&amp;&amp;n){//nä¸º0æ—¶ç»“æŸ 
		mp.clear();
		for(int i=0;i&lt;=n;i++)//å°½é‡ä¸è¦ä½¿ç”¨memsetæ¸…0çš„åŠæ³•ï¼Œå°½ç®¡ä¹Ÿå¯ä»¥ç”¨ 
			E[i].clear();
		memset(f,1,sizeof(f));
		k=1;
		cin&gt;&gt;s1;
		mp[s1]=k++;
		E[0].push_back(mp[s1]);//å¢åŠ è¶…æ ¹ 
		for(int i=1;i&lt;=n-1;i++){
			cin&gt;&gt;s1&gt;&gt;s2;
			if(mp[s1]==0)
				mp[s1]=k++;
			if(mp[s2]==0)
				mp[s2]=k++;
			E[mp[s2]].push_back(mp[s1]);
		}
	    dfs(0);
	    printf(&quot;%d &quot;,dp[0][0]);
	    if(f[0][0])
	    	printf(&quot;Yes\n&quot;);
		else
			printf(&quot;No\n&quot;);	
    }
    return 0;
}
</code></pre>
<p><a href="http://poj.org/problem?id=1463">poj1463</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_06bf19b654-8.png" alt="8.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_2d62973254-9.png" alt="9.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
using namespace std;
const int N=1500+10;
int val[N],dp[N][2],fa[N],n;
vector&lt;int&gt;E[N];

void dfs(int u){
	dp[u][0]=0;
	dp[u][1]=1;
	for(int i=0;i&lt;E[u].size();i++){
		int v=E[u][i];
		dfs(v);
		dp[u][1]+=min(dp[v][1],dp[v][0]);
		dp[u][0]+=dp[v][1];
	}
}

int main(){
	while(~scanf(&quot;%d&quot;,&amp;n)){
		for(int i=0;i&lt;n;i++)//ç¼–å·ä»0å¼€å§‹ 
			E[i].clear();
		memset(fa,-1,sizeof(fa));
		memset(dp,0,sizeof(dp));
		for(int i=0;i&lt;n;i++){
			int a,b,m;
			scanf(&quot;%d:(%d)&quot;,&amp;a,&amp;m);//æ³¨æ„è¯»å…¥ 
	        while(m--)
	        {
	        	scanf(&quot;%d&quot;,&amp;b);
	        	E[a].push_back(b);
	        	fa[b]=a;
			}
		}
	    int rt=0;//ç¼–å·ä»0å¼€å§‹
	    while(fa[rt]!=-1) rt=fa[rt];
	    dfs(rt);
	    printf(&quot;%d\n&quot;,min(dp[rt][1],dp[rt][0]));
    }
    return 0;
}
</code></pre>
<h4 id="èƒŒåŒ…ç±»æ ‘å½¢dp">èƒŒåŒ…ç±»æ ‘å½¢dp</h4>
<p><a href="http://acm.hdu.edu.cn/showproblem.php?pid=1561">hdu1561</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_e427e85a54-11.png" alt="11.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/22/9969_e76dea7854-12.png" alt="12.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/26/9969_8e4c463458-19.PNG" alt="19.PNG" loading="lazy"><br>
åŠ ä¸Šè™šæ ¹ä¸€å…±m+1ä¸ªç»“ç‚¹</p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

const int N = 210,M=N*2;
int n, m;
int w[N];
int h[N], e[M], ne[M], idx;
int f[N][N];

void add(int a, int b)
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs(int u)
{
    for (int i = h[u]; ~i; i = ne[i])
    {
        int son=e[i];
        dfs(son);
        for (int j = m ; j &gt;= 0; j -- )
            for (int k = 0; k &lt;= j; k ++ )
                f[u][j] = max(f[u][j], f[u][j - k] + f[son][k]);
    }

    for (int j = m+1; j &gt;= 1; j -- ) f[u][j] = f[u][j - 1] + w[u];
    for (int j = 0; j &lt; 1; j ++ ) f[u][j] = 0;
}

int main()
{
    while(cin &gt;&gt; n &gt;&gt; m &amp;&amp; n)
    {
    	memset(h, -1, sizeof h);
    	memset(f,0,sizeof f);
    	idx=0;
	    for (int i = 1; i &lt;= n; i ++ )
	    {
	    	int a,b;
	    	cin&gt;&gt;a&gt;&gt;b;
	    	if(!a)
	    		add(0,i);
	    	else 
	    		add(a,i);
	    	w[i]=b;
	    }
	
	    dfs(0);
	
	    cout &lt;&lt; f[0][m+1]&lt;&lt; endl;
	}

    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/288/">acwing286</a><br>
åŒèƒŒåŒ…ç±»æ ‘å½¢dp</p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

const int N = 310;

int n, m;
int h[N], e[N], ne[N], idx;
int w[N];
int f[N][N];

void add(int a, int b)
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs(int u)
{
    for (int i = h[u]; ~i; i = ne[i])
    {
        int son = e[i];
        dfs(son);

        for (int j = m - 1; j &gt;= 0; j -- )
            for (int k = 0; k &lt;= j; k ++ )
                f[u][j] = max(f[u][j], f[u][j - k] + f[son][k]);
    }

    for (int i = m; i&gt;=1; i -- ) f[u][i] = f[u][i - 1] + w[u];
    for(int i=0;i&lt;1;i++) f[u][i]=0;
}

int main()
{
    cin &gt;&gt; n &gt;&gt; m;

    memset(h, -1, sizeof h);
    for (int i = 1; i &lt;= n; i ++ )
    {
        int p;
        cin &gt;&gt; p &gt;&gt; w[i];
        add(p, i);
    }

    m ++ ;
    dfs(0);

    cout &lt;&lt; f[0][m] &lt;&lt; endl;

    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/1077/">acwing1075</a><br>
å¦‚æœxå’Œyå¯ä»¥äº’ç›¸è½¬åŒ–ï¼Œå°±è¿æ¥ä¸€æ¡æ— å‘è¾¹ï¼Œæœ€åå¾—åˆ°çš„å›¾å…¶å®æ˜¯ä¸€ä¸ªæ£®æ—ï¼Œæ¯æ£µæ ‘éƒ½æ˜¯æ— æ ¹æ ‘ï¼Œå…¶å®å°±æ˜¯è¦æ±‚ï¼Œæ•´ä¸ªæ£®æ—ä¸­ä¸¤ä¸ªè¿é€šçš„ç‚¹çš„æœ€è¿œè·ç¦»ï¼ˆè¿™é‡Œè¾¹æƒéƒ½æ˜¯1ï¼‰ï¼Œå’Œåœ¨æ— æ ¹æ ‘ä¸­æ±‚ä¸¤ç‚¹æœ€è¿œè·ç¦»æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡è¿™é¢˜çš„ç‰¹æ®Šæ€§ï¼Œå¯ä»¥æ›´æ–¹ä¾¿ç‚¹<br>
å¯¹äºä»»æ„ä¸€æ¡è¾¹ï¼Œå¿…æœ‰x&lt;yï¼Œåœ¨æ ‘ä¸­ï¼Œxå°±åº”è¯¥ä¸ºyçš„åŒäº²ï¼ˆå› ä¸ºyçš„çº¦æ•°å’Œæ˜¯å”¯ä¸€çš„ï¼Œä½†xå¯èƒ½æ˜¯å¾ˆå¤šä¸ªæ•°çš„çº¦æ•°å’Œï¼Œè¿™æ­£å¥½å¯¹åº”æ ‘çš„å…³ç³»ï¼ŒåŒäº²å”¯ä¸€ï¼Œå­©å­ä¸å®šï¼‰ã€‚è€Œdpæ€æƒ³ç…§æ ·æ˜¯æ‰¾å‡ºæ¯ä¸ªèŠ‚ç‚¹åˆ°å¶å­çš„æœ€å¤§å€¼m1å’Œæ¬¡å¤§å€¼m2ï¼Œå†ä¸¤è€…ç›¸åŠ çš„dp[rt]ï¼Œè€Œæ•´ä¸ªæ ‘ä¸­çš„æœ€å¤§å€¼ï¼Œå°±æ˜¯æ‰«æå…¨éƒ¨èŠ‚ç‚¹ï¼Œæ‰¾åˆ°æœ€å¤§çš„dp[rt]<br>
ç”±äºè¿™é¢˜ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„åŒäº²æ˜¯å¯ä»¥è®°å½•ä¸‹æ¥çš„ï¼Œæ‰€ä»¥dpçš„æ—¶å€™ä¸ç”¨é€’å½’ï¼Œè€Œå†™æˆé€’æ¨å¼ï¼Œç›´æ¥ä»å¶å¾€ä¸Šé€’æ¨ï¼Œ<br>
è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ—¶å€™å°±æ˜¯æ€ä¹ˆæ‰¾å‡ºçº¦æ•°å’Œï¼Œæ•°æ®æ¯”è¾ƒå¤§ï¼Œåº”è¯¥å°½é‡é¿å…å¤šä½™çš„åˆ¤æ–­ï¼Œç”¨ç­›æ³•æ±‚çº¦æ•°å’Œåˆ™æ˜¯ä¸€ä¸ªä¸é”™çš„æ–¹æ³•</p>
<pre><code>#include&lt;bits/stdc++.h&gt;
using namespace std;
int n;
const int N=50010;
int f[N][2];
int sum[N];
 
int main()
{
   cin&gt;&gt;n;
   
   for(int i=1;i&lt;=n;i++)
		for(int j=2*i;j&lt;=n;j+=i)//æ±‚çº¦æ•°å’Œ 
			sum[j]+=i;
	
	for(int i=n;i&gt;=1;i--)
	{
		if(sum[i]&lt;i)//åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ï¼Œæ³¨æ„å®¡é¢˜ã€‚
		{
			if(f[i][0]+1&gt;f[sum[i]][0])
			{
				f[sum[i]][1]=f[sum[i]][0];
				f[sum[i]][0]=f[i][0]+1;
			}
			else if(f[i][0]+1&gt;f[sum[i]][1])
				f[sum[i]][1]=f[i][0]+1;
		} 
	}
	int ans=0;
	for(int i=1;i&lt;=n;i++)
		ans=max(f[i][0]+f[i][1],ans);
	cout&lt;&lt;ans&lt;&lt;endl;
	
   return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/description/1076/">acwing1074</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/26/9969_ab1a78b058-20.png" alt="20.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/26/9969_b31a9ed258-21.PNG" alt="21.PNG" loading="lazy"></p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

const int N = 110, M = N * 2;

int n, m;
int h[N], e[M], w[M], ne[M], idx;
int f[N][N];

void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

void dfs(int u, int father)
{
    for (int i = h[u]; ~i; i = ne[i])
    {
        if (e[i] == father) continue;
        dfs(e[i], u);
        for (int j = m; j&gt;=0; j -- )
            for (int k = 0; k &lt; j; k ++ )
                f[u][j] = max(f[u][j], f[u][j - k - 1] + f[e[i]][k] + w[i]);
    }
}

int main()
{
    cin &gt;&gt; n &gt;&gt; m;
    memset(h, -1, sizeof h);
    for (int i = 0; i &lt; n - 1; i ++ )
    {
        int a, b, c;
        scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c);
        add(a, b, c), add(b, a, c);
    }

    dfs(1, -1);

    printf(&quot;%d\n&quot;, f[1][m]);

    return 0;
}
</code></pre>
<h4 id="å·¦å„¿å­å³å…„å¼Ÿ">å·¦å„¿å­å³å…„å¼Ÿ</h4>
<p><a href="http://poj.org/problem?id=2486">POJ2486</a><br>
é¢˜ç›®å¤§æ„ï¼šä¸€ä¸ªå«Wshxztçš„å¯çˆ±çš„å¥³å­©å­è¢«HXå¤§å”å¸¦åˆ°äº†ä¸€æ£µè‹¹æœæ ‘è¾¹ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œè‹¹<br>
æœæ ‘æ˜¯ä¸€ä¸ªæ ‘å½¢çš„ç»“æ„ï¼Œåœ¨èŠ‚ç‚¹å¤„é•¿æœ‰è‹¹æœï¼‰ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“Wshxztæ˜¯ä¸ªè‹¹æœæ§ï¼Œå¥¹åªè¦è®¿é—®åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¸€å®šä¼šåƒå…‰è¿™ä¸ªèŠ‚ç‚¹æ‰€æœ‰çš„è‹¹æœã€‚å½“ç„¶ä¸€ä¸ªèŠ‚ç‚¹çš„è‹¹æœåªèƒ½åƒä¸€æ¬¡ã€‚HXå¤§å”ä¸ºäº†é˜²æ­¢Wshxzté•¿èƒ–ï¼Œé™åˆ¶å¥¹åªèƒ½èµ°Kï¼ˆ1 â‰¤ K â‰¤ 200ï¼‰æ­¥ï¼Œä»ä¸€ä¸ªèŠ‚ç‚¹èµ°åˆ°å¦<br>
ä¸€ä¸ªç›¸é‚»çš„èŠ‚ç‚¹æ˜¯æ‰€è°“èµ°ä¸€æ­¥ã€‚Wshxztä»èŠ‚ç‚¹1å¼€å§‹ã€‚æ ‘ä¸Šçš„èŠ‚ç‚¹æœ‰Nï¼ˆ1 â‰¤ N â‰¤ 100ï¼‰<br>
ä¸ªï¼Œä½ éœ€è¦è®¡ç®—Wshxztæœ€å¤šèƒ½åƒåˆ°å¤šå°‘è‹¹æœã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_166db48459-001.png" alt="001.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_2201b2aa59-002.png" alt="002.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_367c7b2059-003.png" alt="003.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_3952b18e59-004.png" alt="004.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
using namespace std;
const int N=110,M=N*2;
int n,m,cnt;
//dp[u][j][0]è¡¨ç¤ºä»¥uä¸ºæ ¹çš„æ ‘ç»è¿‡jæ­¥æ²¡æœ‰å›åˆ°ç‚¹uå¾—åˆ°çš„æœ€å€¼
//dp[u][j][1]è¡¨ç¤ºä»¥uä¸ºæ ¹çš„æ ‘ç»è¿‡jæ­¥å›åˆ°ç‚¹uå¾—åˆ°çš„æœ€å€¼ 
int dp[N][M][2],val[N],head[N];
 
struct edge{
	int v,next;
}e[M];
 
void init(){
	memset(head,-1,sizeof(head));
	memset(dp,0,sizeof(dp));
	cnt=0;
}
 
void add(int u,int v){
	e[cnt].v=v;
	e[cnt].next=head[u];
	head[u]=cnt++;
}
 
void dfs(int u,int fa){
	for(int i=0;i&lt;=m;i++)//ä¸è®ºèµ°å¤šå°‘æ­¥ï¼Œå‡åˆå§‹åŒ–ä¸º 
		dp[u][i][0]=dp[u][i][1]=val[u];
	for(int i=head[u];~i;i=e[i].next){
		int v=e[i].v;
		if(v==fa) continue;
		dfs(v,u);
		for(int j=m;j&gt;=1;j--){//æ ‘å½¢èƒŒåŒ… 
			for(int k=1;k&lt;=j;k++){
				dp[u][j][0]=max(dp[u][j][0],dp[u][j-k][1]+dp[v][k-1][0]);
				if(k&gt;=2) dp[u][j][0]=max(dp[u][j][0],dp[u][j-k][0]+dp[v][k-2][1]);
				if(k&gt;=2) dp[u][j][1]=max(dp[u][j][1],dp[u][j-k][1]+dp[v][k-2][1]);
			}
		}
	}
}
 
int main(){
	int u,v;
	while(~scanf(&quot;%d%d&quot;,&amp;n,&amp;m)){
		init();
		for(int i=1;i&lt;=n;++i)
			scanf(&quot;%d&quot;,&amp;val[i]);
		for(int i=1;i&lt;n;++i){
			scanf(&quot;%d%d&quot;,&amp;u,&amp;v);
			add(u,v);
			add(v,u);
		}
		dfs(1,-1);
		printf(&quot;%d\n&quot;,max(dp[1][m][0],dp[1][m][1]));
	}
	return 0;
}
</code></pre>
<p><a href="https://www.luogu.com.cn/problem/UVA12186">uva12186</a><br>
ä¸€ä¸ªè€æ¿å’Œnä¸ªå‘˜å·¥ç»„æˆæ ‘çŠ¶ç»“æ„ï¼Œæ¯ä¸ªå‘˜å·¥éƒ½æœ‰è‡ªå·±çš„å”¯ä¸€ä¸Šå¸ï¼Œè€æ¿çš„ç¼–å·ä¸º0ï¼Œå‘˜å·¥1~nï¼Œå·¥äººä»¬æ‰“ç®—ç­¾ç½²ä¸€ä¸ªå¿—æ„¿ä¹¦ç»™è€æ¿ï¼Œä½†æ— æ³•è·¨çº§ï¼Œå½“ä¸€ä¸ªä¸­çº§å‘˜å·¥ï¼ˆéæ˜¯å·¥äººçš„å‘˜å·¥ï¼‰çš„ç›´å±ä¸‹å±ä¸­ä¸å°äºT%çš„äººç­¾å­—æ—¶ï¼Œä»–ä¹Ÿä¼šç­¾å­—å¹¶ä¸”é€’ç»™ä»–çš„ç›´å±ä¸Šå¸ï¼Œé—®ï¼šè¦è®©è€æ¿æ”¶åˆ°è¯·æ„¿ä¹¦è‡³å°‘éœ€è¦å¤šå°‘ä¸ªå·¥äººç­¾å­—ã€‚<br>
æ³¨æ„ï¼šè¿™é‡Œè¦æ±‚çš„æ˜¯æœ€åº•å±‚å·¥äººï¼ˆå³å¶å­ç»“ç‚¹ï¼‰çš„æœ€å°‘ä¸ªæ•°ã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_9266e0c059-0001.png" alt="0001.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/27/9969_73948b9259-0002.png" alt="0002.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
#include&lt;iostream&gt;

using namespace std;
const int N=100010;
vector&lt;int&gt; E[N];
int n,T;

int dfs(int u)
{
	if(E[u].size() == 0)
		return 1;
	vector&lt;int&gt; res;
    for(int i=0;i&lt;E[u].size();i++)
    {
    	int j=E[u][i];
    	int t=dfs(j);
    	res.push_back(t);
	}
	
	sort(res.begin(),res.end());
	int k=E[u].size();
	int c=(k*T-1)/100+1;
	int ans=0;
	for(int i=0;i&lt;c;i++)
		ans+=res[i];

	return ans;
}

int main()
{
    while(~scanf(&quot;%d%d&quot;,&amp;n,&amp;T)&amp;&amp;n){
        for(int i=0;i&lt;=n;i++)
			E[i].clear();
        for(int i=1;i&lt;=n;i++)
        {
            int u;
            scanf(&quot;%d&quot;,&amp;u);
            E[u].push_back(i);
        }
        printf(&quot;%d\n&quot;,dfs(0));
    }
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[LCA]]></title>
        <id>https://caifxh.github.io/post/lca/</id>
        <link href="https://caifxh.github.io/post/lca/">
        </link>
        <updated>2020-04-06T03:50:22.000Z</updated>
        <content type="html"><![CDATA[<p><img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_ebac8e3a56-0001.png" alt="0001.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_f3642cbe56-0002.png" alt="0002.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_01286f7256-0003.png" alt="0003.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_0e8b262856-0004.png" alt="0004.png" loading="lazy"></p>
<h4 id="æš´åŠ›">æš´åŠ›</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_25639d9456-0005.png" alt="0005.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_285eb8e456-0006.png" alt="0006.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_3b0b44da56-0007.png" alt="0007.png" loading="lazy"><br>
<a href="http://poj.org/problem?id=1330">poj1330</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_634786a256-01.png" alt="01.png" loading="lazy"></p>
<pre><code>#include&lt;cstdio&gt;
using namespace std;
const int maxn=10010;
int fa[maxn];
bool flag[maxn];

int LCA(int u,int v)
{
    if(u==v)
    	return u;
	flag[u]=1;
	while(fa[u]!=u)//uå‘ä¸Šèµ°åˆ°æ ¹ 
	{
		u=fa[u];
		flag[u]=1;
	}
	if(flag[v]) 
		return v;
	while(fa[v]!=v)//vå‘ä¸Šèµ°
	{
		v=fa[v];
		if(flag[v])
			return v;
	}
	return 0;   	
}

int main()
{
	int n,u,v,T;
	scanf(&quot;%d&quot;,&amp;T);
	while(T--)
	{
		scanf(&quot;%d&quot;,&amp;n);
		for(int i=1;i&lt;=n;i++)
		{
			fa[i]=i;
			flag[i]=0;
		} 
		for(int i=1;i&lt;n;i++)
		{
			scanf(&quot;%d%d&quot;,&amp;u,&amp;v);
			fa[v]=u;
		}
		scanf(&quot;%d%d&quot;,&amp;u,&amp;v);
		printf(&quot;%d\n&quot;,LCA(u,v));
	}
	return 0;
}
</code></pre>
<h4 id="æ ‘ä¸Šå€å¢">æ ‘ä¸Šå€å¢</h4>
<p>ç”¨æ ‘ä¸Šå€å¢æ³•æ±‚LCAçš„æ—¶é—´å¤æ‚åº¦ä¸ºO((n+m)logn)ã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_e1ee9b0856-02.png" alt="02.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_040ed6bc56-04.png" alt="04.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_073739f656-05.png" alt="05.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_0c3d228a56-06.png" alt="06.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_21a1fd3a56-07.png" alt="07.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_2e88049056-08.png" alt="08.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_3e3f101856-09.png" alt="09.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_4e5cc82856-10.png" alt="10.png" loading="lazy"></p>
<h4 id="æ­¥éª¤">æ­¥éª¤</h4>
<p>1.å»ºç«‹ä¸€ä¸ªç©ºé˜Ÿåˆ—ï¼Œå¹¶å°†æ ¹èŠ‚ç‚¹å…¥é˜Ÿï¼ŒåŒæ—¶å­˜å‚¨æ ¹èŠ‚ç‚¹çš„æ·±åº¦<br>
2.å–å‡ºé˜Ÿå¤´ï¼Œéå†å…¶æ‰€æœ‰å‡ºè¾¹ã€‚ç”±äºå­˜å‚¨çš„æ—¶å€™æ˜¯æŒ‰ç…§æ— å‘å›¾å­˜å‚¨ï¼Œå› æ­¤è¦è¿›è¡Œæ·±åº¦åˆ¤å®šï¼Œå¯¹äºè¿æ¥åˆ°å®ƒçˆ¶äº²èŠ‚ç‚¹çš„è¾¹ï¼Œç›´æ¥continueå³å¯ã€‚è®°å½“å‰è·¯å¾„çš„å¦ä¸€ç«¯èŠ‚ç‚¹ä¸ºyï¼Œå¤„ç†å‡ºyçš„dã€fä¸¤ä¸ªæ•°ç»„çš„å€¼ï¼Œç„¶åå°†yå…¥é˜Ÿã€‚<br>
3.é‡å¤ç¬¬2æ­¥ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸ºç©º<br>
ä»¥ä¸Šéƒ¨åˆ†æ˜¯æ ‘ä¸Šå€å¢æ³•çš„é¢„å¤„ç†ï¼Œä¹Ÿæ˜¯æ¯”è¾ƒé€šç”¨çš„å¯¹äºæ ‘ä¸Šå€å¢çš„é¢„å¤„ç†ï¼Œæ—¶é—´å¤æ‚åº¦O(nlogn)<br>
ã€‚æ¥ä¸‹æ¥æ˜¯æ±‚LCAçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_182d302457-00000.PNG" alt="00000.PNG" loading="lazy"><br>
<a href="https://www.acwing.com/problem/content/1174/">acwing1172</a></p>
<pre><code>#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

const int N = 40010, M = N * 2;

int n, m;
int h[N], e[M], ne[M], idx;
int depth[N], fa[N][16];
int q[N];

void add(int a, int b)
{
    e[idx] = b, ne[idx] = h[a], h[a] = idx ++ ;
}

void bfs(int root)
{
    memset(depth, 0x3f, sizeof depth);
    depth[0] = 0, depth[root] = 1;
    int hh = 0, tt = 0;
    q[0] = root;
    while (hh &lt;= tt)
    {
        int t = q[hh ++ ];
        for (int i = h[t]; ~i; i = ne[i])
        {
            int j = e[i];
            if (depth[j] &gt; depth[t] + 1)
            {
                depth[j] = depth[t] + 1;
                q[ ++ tt] = j;
                fa[j][0] = t;
                for (int k = 1; k &lt;= 15; k ++ )
                    fa[j][k] = fa[fa[j][k - 1]][k - 1];
            }
        }
    }
}

int lca(int a, int b)
{
    if (depth[a] &lt; depth[b]) swap(a, b);
    for (int k = 15; k &gt;= 0; k -- )
        if (depth[fa[a][k]] &gt;= depth[b])
            a = fa[a][k];
    if (a == b) return a;
    for (int k = 15; k &gt;= 0; k -- )
        if (fa[a][k] != fa[b][k])
        {
            a = fa[a][k];
            b = fa[b][k];
        }
    return fa[a][0];
}

int main()
{
    scanf(&quot;%d&quot;, &amp;n);
    int root = 0;
    memset(h, -1, sizeof h);

    for (int i = 0; i &lt; n; i ++ )
    {
        int a, b;
        scanf(&quot;%d%d&quot;, &amp;a, &amp;b);
        if (b == -1) root = a;
        else add(a, b), add(b, a);
    }

    bfs(root);

    scanf(&quot;%d&quot;, &amp;m);
    while (m -- )
    {
        int a, b;
        scanf(&quot;%d%d&quot;, &amp;a, &amp;b);
        int p = lca(a, b);
        if (p == a) puts(&quot;1&quot;);
        else if (p == b) puts(&quot;2&quot;);
        else puts(&quot;0&quot;);
    }

    return 0;
}
</code></pre>
<h4 id="ç¦»çº¿tarjan">ç¦»çº¿tarjan</h4>
<p>Tarjanç®—æ³•æ±‚LCAçš„æœ¬è´¨æ˜¯ç”¨å¹¶æŸ¥é›†å¯¹å‘ä¸Šæ ‡è®°æ³•è¿›è¡Œä¼˜åŒ–ï¼Œæ˜¯ä¸€ç§ç¦»çº¿ç®—æ³•ï¼Œæ—¶é—´å¤æ‚åº¦O(n+m)ã€‚<br>
åœ¨æ·±åº¦ä¼˜å…ˆéå†çš„ä»»æ„æ—¶åˆ»ï¼Œæ ‘ä¸­ç»“ç‚¹åˆ†ä¸ºä¸‰ç±»ï¼š<br>
1.å·²ç»è®¿é—®å®Œæ¯•å¹¶ä¸”å›æº¯çš„ç»“ç‚¹ï¼Œåœ¨è¿™äº›ç»“ç‚¹ä¸Šæ ‡è®°ä¸€ä¸ªæ•´æ•°2.<br>
2ï¼Œå·²ç»å¼€å§‹é€’å½’ï¼Œä½†å°šæœªå›æº¯çš„ç‚¹ã€‚è¿™äº›ç»“ç‚¹å°±æ˜¯å½“å‰æ­£åœ¨è®¿é—®çš„ç»“ç‚¹ï¼Œxä»¥åŠxçš„ç¥–å…ˆã€‚åœ¨è¿™äº›ç»“ç‚¹ä¸Šæ ‡è®°ä¸€ä¸ªæ•´æ•°1.<br>
3.å°šæœªè®¿é—®çš„ç»©ç‚¹ã€‚è¿™äº›ç»“ç‚¹æ²¡æœ‰æ ‡è®°ã€‚<br>
å¯¹äºæ­£åœ¨è®¿é—®çš„ç»“ç‚¹xï¼Œå®ƒåˆ°æ ¹èŠ‚ç‚¹çš„è·¯åŠ²å·²ç»æ ‡è®°ä¸º1.è‹¥yæ˜¯å·²ç»è®¿é—®å®Œæ¯•å¹¶ä¸”å›æº¯çš„èŠ‚ç‚¹ï¼Œåˆ™LCAï¼ˆxï¼Œyï¼‰å°±æ˜¯ä»yå‘ä¸Šèµ°åˆ°æ ¹ï¼Œç¬¬ä¸€ä¸ªé‡åˆ°çš„æ ‡è®°ä¸º1çš„èŠ‚ç‚¹ã€‚<br>
å¯ä»¥åˆ©ç”¨å¹¶æŸ¥é›†è¿›è¡Œä¼˜åŒ–ï¼Œå½“ä¸€ä¸ªç»“ç‚¹è·å¾—æ•´æ•°2çš„æ ‡è®°æ—¶ï¼ŒæŠŠå®ƒæ‰€åœ¨çš„é›†åˆåˆå¹¶åˆ°å®ƒçš„çˆ¶èŠ‚ç‚¹æ‰€åœ¨çš„é›†åˆä¸­ï¼ˆåˆå¹¶æ—¶å®ƒçš„çˆ¶èŠ‚ç‚¹æ ‡è®°ä¸€å®šä¸º1ï¼Œä¸”å•ç‹¬æ„æˆä¸€ä¸ªé›†åˆï¼‰ã€‚<br>
æ­¤æ—¶æ‰«æä¸xç›¸å…³çš„æ‰€æœ‰è¯¢é—®ï¼Œè‹¥è¯¢é—®çš„å¦ä¸€ä¸ªç‚¹yçš„æ ‡è®°ä¸º2ï¼Œå°±çŸ¥é“lè¯¥å­™æ–‡çš„å›ç­”åº”è¯¥æ˜¯yæ‰€åœ¨å¹¶æŸ¥é›†ä¸­çš„ä»£è¡¨å…ƒç´ ã€‚<br>
è¿™æ ·ï¼ŒTarjanç®—æ³•æ±‚LCAçš„æ­¥éª¤å°±å¾ˆæ˜äº†äº†ï¼š</p>
<p>1.ä»æ ¹èŠ‚ç‚¹å¼€å§‹è¿›è¡Œdfs<br>
2.å°†å½“å‰èŠ‚ç‚¹æ ‡è®°ä¸º1<br>
3.éå†å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰å‡ºè¾¹ï¼›è‹¥å½“å‰è¾¹çš„ç»ˆç‚¹è¿˜æ²¡æœ‰è®¿é—®è¿‡ï¼Œåˆ™è®¿é—®å®ƒï¼Œè®¿é—®è¿‡åå°†è¯¥èŠ‚ç‚¹åˆå¹¶åˆ°å½“å‰èŠ‚ç‚¹çš„é›†åˆä¸­ï¼›<br>
4.éå†ä¸å½“å‰èŠ‚ç‚¹ç›¸å…³çš„æ‰€æœ‰è¯¢é—®ï¼›è‹¥å½“å‰è¯¢é—®çš„å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ ‡è®°ä¸º2ï¼Œåˆ™è¯¥è¯¢é—®çš„ç­”æ¡ˆå³ä¸ºå¦ä¸€ä¸ªèŠ‚ç‚¹æ‰€åœ¨é›†åˆçš„ä»£è¡¨å…ƒç´ <br>
5.å°†å½“å‰èŠ‚ç‚¹æ ‡è®°ä¸º2</p>
<p><a href="https://www.acwing.com/problem/content/1173/">acwing1171</a></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;vector&gt;
using namespace std;
const int N=10010,M=N*2;
int h[N],e[M],ne[M],w[M],idx;
int n,m;
typedef pair&lt;int,int&gt; PII;
#define x firsst
#define y second
vector&lt;PII&gt; query[N];//firstå­˜å‚¨æŸ¥è¯¢çš„å¦å¤–ä¸€ä¸ªç‚¹ï¼Œsecondå­˜æŸ¥è¯¢ç¼–å·
int res[M];
int st[N];
int p[N];
int dist[N];

void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

int find(int x)
{
    if (p[x] != x) p[x] = find(p[x]);
    return p[x];
}


void dfs(int u,int fa)
{
    for(int i=h[u];~i;i=ne[i])
    {
        int j=e[i];
        if(j == fa)
            continue;
        dist[j]=dist[u]+w[i];
        dfs(j,u);
    }
}

void tarjan(int u)
{
    st[u]=1;
    for(int i=h[u];~i;i=ne[i])
    {
        int j=e[i];
        if(!st[j])
        {
            tarjan(j);
            p[j]=u;
        }
    }
    
    for(int i=0;i&lt;query[u].size();i++)
    {
        int y=query[u][i].first,id=query[u][i].second;
        if(st[y] == 2)
        {
            int anc=find(y);
            res[id]=dist[u]+dist[y]-dist[anc]*2;
        }
    }
    st[u]=2;
}

int main()
{
    cin&gt;&gt;n&gt;&gt;m;
    memset(h,-1,sizeof h);
    
    for(int i=0;i&lt;n-1;i++)
    {
        int a,b,c;
        cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;
        add(a,b,c);
        add(b,a,c);
    }
    
    for(int i=0;i&lt;m;i++)
    {
        int a,b;
        cin&gt;&gt;a&gt;&gt;b;
        if(a != b)
        {
            query[a].push_back({b,i});
            query[b].push_back({a,i});
        }
    }
    
    for(int i=1;i&lt;=n;i++)
        p[i]=i;
    
    dfs(1,-1);
    
    tarjan(1);
    
    for(int i=0;i&lt;m;i++)
        cout&lt;&lt;res[i]&lt;&lt;endl;
    return 0;
}
</code></pre>
<h4 id="lcaæ±‚æ¬¡å°ç”Ÿæˆæ ‘">lcaæ±‚æ¬¡å°ç”Ÿæˆæ ‘</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_ee11055656-13.PNG" alt="13.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_0fa2ff0856-2.png" alt="2.png" loading="lazy"><br>
æˆ‘ä»¬å‡è®¾ä¸€æ¡è·¯å¾„æ˜¯ç”±ä¸‰æ®µæ„é€ è€Œæˆ.æ˜¯ä¸‰æ®µ,ä¸æ˜¯å°±ä¸‰ä¸ªç‚¹.a-&gt;c,c-&gt;b,b-&gt;a(è½¬è‡ªç§¦åŒå­¦é¢˜è§£)<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_a07e83ee56-14.PNG" alt="14.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_a8d7c74856-15.png" alt="15.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_cb3cbf6e56-16.PNG" alt="16.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/24/9969_ceafad0056-17.PNG" alt="17.PNG" loading="lazy"></p>
<pre><code>#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;

using namespace std;

typedef long long LL;

const int N = 100010, M = 300010, INF = 0x3f3f3f3f;

int n, m;
struct Edge
{
    int a, b, w;
    bool used;
    bool operator&lt; (const Edge &amp;t) const
    {
        return w &lt; t.w;
    }
}edge[M];
int p[N];
int h[N], e[M], w[M], ne[M], idx;
int depth[N], fa[N][17], d1[N][17], d2[N][17];
int q[N];

void add(int a, int b, int c)
{
    e[idx] = b, w[idx] = c, ne[idx] = h[a], h[a] = idx ++ ;
}

int find(int x)
{
    if (p[x] != x) p[x] = find(p[x]);
    return p[x];
}

LL kruskal()
{
    for (int i = 1; i &lt;= n; i ++ ) p[i] = i;
    sort(edge, edge + m);
    LL res = 0;
    for (int i = 0; i &lt; m; i ++ )
    {
        int a = find(edge[i].a), b = find(edge[i].b), w = edge[i].w;
        if (a != b)
        {
            p[a] = b;
            res += w;
            add(edge[i].a, edge[i].b, w), add(edge[i].b, edge[i].a, w);
            edge[i].used=true;
        }
    }

    return res;
}

void bfs()
{
    memset(depth, 0x3f, sizeof depth);
    depth[0] = 0, depth[1] = 1;
    q[0] = 1;
    int hh = 0, tt = 0;
    while (hh &lt;= tt)
    {
        int t = q[hh ++ ];
        for (int i = h[t]; ~i; i = ne[i])
        {
            int j = e[i];
            if (depth[j] &gt; depth[t] + 1)
            {
                depth[j] = depth[t] + 1;
                q[ ++ tt] = j;
                fa[j][0] = t;
                d1[j][0] = w[i], d2[j][0] = -INF;
                for (int k = 1; k &lt;= 16; k ++ )
                {
                    int anc = fa[j][k - 1];
                    fa[j][k] = fa[anc][k - 1];
                    int distance[4] = {d1[j][k - 1], d2[j][k - 1], d1[anc][k - 1], d2[anc][k - 1]};
                    d1[j][k] = d2[j][k] = -INF;
                    for (int u = 0; u &lt; 4; u ++ )
                    {
                        int d = distance[u];
                        if (d &gt; d1[j][k]) d2[j][k] = d1[j][k], d1[j][k] = d;
                        else if (d &lt; d1[j][k] &amp;&amp; d &gt; d2[j][k]) d2[j][k] = d;
                    }
                }
            }
        }
    }
}

int lca(int a, int b, int w)
{
    static int distance[N * 2];
    int cnt = 0;
    if (depth[a] &lt; depth[b]) swap(a, b);
    for (int k = 16; k &gt;= 0; k -- )
        if (depth[fa[a][k]] &gt;= depth[b])
        {
            distance[cnt ++ ] = d1[a][k];
            distance[cnt ++ ] = d2[a][k];
            a = fa[a][k];
        }
    if (a != b)
    {
        for (int k = 16; k &gt;= 0; k -- )
            if (fa[a][k] != fa[b][k])
            {
                distance[cnt ++ ] = d1[a][k];
                distance[cnt ++ ] = d2[a][k];
                distance[cnt ++ ] = d1[b][k];
                distance[cnt ++ ] = d2[b][k];
                a = fa[a][k], b = fa[b][k];
            }
        distance[cnt ++ ] = d1[a][0];
        distance[cnt ++ ] = d1[b][0];
    }

    int dist1 = -INF, dist2 = -INF;
    for (int i = 0; i &lt; cnt; i ++ )
    {
        int d = distance[i];
        if (d &gt; dist1) dist2 = dist1, dist1 = d;
        else if (d &lt; dist1 &amp;&amp; d &gt; dist2) dist2 = d;
    }

    if (w != dist1) 
        return w - dist1;
    return w - dist2;
}

int main()
{
    scanf(&quot;%d%d&quot;, &amp;n, &amp;m);
    memset(h, -1, sizeof h);
    for (int i = 0; i &lt; m; i ++ )
    {
        int a, b, c;
        scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c);
        edge[i] = {a, b, c};
    }

    LL sum = kruskal();
    
    bfs();

    LL res = 1e18;
    for (int i = 0; i &lt; m; i ++ )
        if (!edge[i].used)
        {
            int a = edge[i].a, b = edge[i].b, w = edge[i].w;
            res = min(res, sum + lca(a, b, w));
        }
    printf(&quot;%lld\n&quot;, res);

    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[çŠ¶æ€æœº]]></title>
        <id>https://caifxh.github.io/post/zhuang-tai-ji/</id>
        <link href="https://caifxh.github.io/post/zhuang-tai-ji/">
        </link>
        <updated>2020-04-05T04:04:31.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://www.acwing.com/problem/content/1051/">acwing1049</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_6f0c7d4276-33.PNG" alt="33.PNG" loading="lazy"><br>
ä¸åˆæ³•çŠ¶æ€æŒ‰ç…§é—®é¢˜çš„æ€§è´¨åˆå§‹åŒ–ä¸ºINF(æ±‚æœ€å°å€¼)/-(æ±‚æœ€å¤§å€¼)</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=100010,INF=0x3f3f3f3f;
int w[N];
int f[N][2];

int main()
{
    int t;
    cin&gt;&gt;t;
    while(t--)
    {
        int n;
        scanf(&quot;%d&quot;,&amp;n);
        for(int i=1;i&lt;=n;i++)
            scanf(&quot;%d&quot;,&amp;w[i]);
        
        f[0][0]=0,f[0][1]=-INF;
        for(int i=1;i&lt;=n;i++)
        {
            f[i][0]=max(f[i-1][0],f[i-1][1]);
            f[i][1]=f[i-1][0]+w[i];
        }
        printf(&quot;%d\n&quot;,max(f[n][0],f[n][1]));
    }
    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/description/1059/">acwing1057</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/04/9969_1479fc8076-29.PNG" alt="29.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_f409bd6e76-31.PNG" alt="31.PNG" loading="lazy"></p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=100010,M=110;
int w[N];
int f[N][M][2];

int main()
{
    int n,k;
    cin&gt;&gt;n&gt;&gt;k;
    
    for(int i=1;i&lt;=n;i++)
        cin&gt;&gt;w[i];
    memset(f,-0x3f,sizeof f);
    for(int i=0;i&lt;=n;i++) f[i][0][0]=0;
    for(int i=1;i&lt;=n;i++)
        for(int j=1;j&lt;=k;j++)
        {
            f[i][j][0]=max(f[i-1][j][0],f[i-1][j][1]+w[i]);
            f[i][j][1]=max(f[i-1][j][1],f[i-1][j-1][0]-w[i]);
        }
    int res=0;
    for(int i=0;i&lt;=k;i++)
        res=max(res,f[n][i][0]);
    cout&lt;&lt;res&lt;&lt;endl;
    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/description/1060/">acwing1058</a><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_0cd946fa76-32.PNG" alt="32.PNG" loading="lazy"></p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
using namespace std;
const int N = 100010, INF = 0x3f3f3f3f;

int n;
int w[N];
int f[N][3];

int main()
{
    scanf(&quot;%d&quot;, &amp;n);

    for (int i = 1; i &lt;= n; i ++ ) scanf(&quot;%d&quot;, &amp;w[i]);

    f[0][0] = f[0][1] = -INF, f[0][2] = 0;
    for (int i = 1; i &lt;= n; i ++ )
    {
        f[i][0] = max(f[i - 1][0], f[i - 1][2] - w[i]);
        f[i][1] = f[i - 1][0] + w[i];
        f[i][2] = max(f[i - 1][2], f[i - 1][1]);
    }

    printf(&quot;%d\n&quot;, max(f[n][1], f[n][2]));

    return 0;
}
</code></pre>
<p><a href="https://vjudge.net/problem/POJ-3401">poj3401</a><br>
æœ€è¿‘ï¼Œlxhgwwæ²‰è¿·äºè‚¡ç¥¨ï¼Œç»è¿‡å‡ å¤©çš„ç ”ç©¶ï¼Œä»–å‘ç°äº†ä¸€äº›è§„å¾‹çš„æ¨¡å¼ã€‚<br>
ä»–é¢„æµ‹æœªæ¥Tå¤©çš„è‚¡ç¥¨å¸‚åœºã€‚ åœ¨ç¬¬iå¤©ï¼Œæ‚¨å¯ä»¥ä»¥APiçš„ä»·æ ¼è´­ä¹°ä¸€åªè‚¡ç¥¨æˆ–å–å‡ºä¸€åªè‚¡ç¥¨ä»¥è·å¾—BPiã€‚<br>
è¿˜æœ‰å…¶ä»–ä¸€äº›é™åˆ¶ï¼Œå³åœ¨ç¬¬ä¸€å¤©å°±å¯ä»¥è´­ä¹°æœ€å¤šASiè‚¡ç¥¨ï¼Œæœ€å¤šå¯ä»¥å–å‡ºBSiè‚¡ç¥¨ã€‚ä¸¤ä¸ªäº¤æ˜“æ—¥çš„é—´éš”åº”å¤§äºWå¤©ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾æ‚¨åœ¨ç¬¬iå¤©è¿›è¡Œäº†äº¤æ˜“ï¼ˆ<strong>ä»»ä½•ä¹°å–è‚¡ç¥¨éƒ½è¢«è§†ä¸ºä¸€é¡¹äº¤æ˜“</strong>ï¼‰ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªäº¤æ˜“æ—¥å¿…é¡»åœ¨ç¬¬ï¼ˆi + W + 1ï¼‰å¤©æˆ–æ›´æ™šçš„æ—¶é—´è¿›è¡Œã€‚è€Œä¸”ï¼Œä»»ä½•æ—¶å€™æœ€å¤šåªèƒ½æ‹¥æœ‰MaxPè‚¡ç¥¨ã€‚<br>
åœ¨ç¬¬ä¸€å¤©ä¹‹å‰ï¼Œlxhgwwå·²ç»æ‹¥æœ‰æ— é™çš„èµ„é‡‘ï¼Œä½†æ˜¯æ²¡æœ‰è‚¡ç¥¨ï¼Œå½“ç„¶ï¼Œä»–å¸Œæœ›ä»è‚¡å¸‚ä¸­èµšåˆ°å°½å¯èƒ½å¤šçš„é’±ã€‚ æ‰€ä»¥é—®é¢˜æ¥äº†ï¼Œä»–æœ€å¤šåªèƒ½èµšå¤šå°‘é’±ï¼Ÿ<br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_d66ad1ba76-34.png" alt="34.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_f1520dcc76-35.PNG" alt="35.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_4584aa0276-36.png" alt="36.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_79e2bd3476-37.png" alt="37.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_7d04775a76-38.PNG" alt="38.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_d9bc776276-40.PNG" alt="40.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/04/05/9969_dd41f1f076-39.png" alt="39.png" loading="lazy"><br>
åŠ¨æ€è§„åˆ’æ–¹ç¨‹ï¼š<br>
1.ä¸ä¹°ä¸å–ã€‚dp[i][j]=max(dp[i-1][j],dp[i][j]);<br>
2.ä¹°ä¸€äº›è‚¡ç¥¨ã€‚dp[i][j]=max(dp[i-1][k]-(j-k)*ap[i]);(0&lt;=k&lt;=j&lt;=Maxp)<br>
3.å–ä¸€äº›è‚¡ç¥¨ã€‚dp[i][j]=max(dp[i-1][k]+(k-j)*bp[i]);(0&lt;=j&lt;=k&lt;=Maxp)<br>
æ³¨æ„ï¼š<br>
1.æŠŠæ‰€æœ‰æœªå®šä¹‰çš„çŠ¶æ€éƒ½è®¾ç½®ä¸º-INFï¼Œ1~w+1å¤©å¾—åˆå§‹åŒ–ï¼Œå› ä¸ºè¿™äº›å¤©ä¸èƒ½æœ‰å‰é¢çš„çŠ¶æ€æ¨å‡ºæ¥ï¼Œåˆå§‹åŒ–ä¸ºå¯¹åº”è´­ä¹°å¤šå°‘è‚¡ç¥¨æ‰€å‡å»çš„é’±æ•°ï¼Œå› ä¸ºä¸€å¼€å§‹åªæœ‰ä¹°ï¼Œä¸èƒ½å–ã€‚<br>
2.å¾ªç¯çš„é€’å‡è¿˜æ˜¯é€’å¢é—®é¢˜ï¼Œè·Ÿå½“å‰è¦è®¿é—®çš„çŠ¶æ€æœ‰å…³ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=2010;
int f[N][N];
int ap[N],bp[N];//ä¹°å…¥ä»·æ ¼ï¼Œå–å‡ºä»·æ ¼ 
int as[N],bs[N];//ä¹°å…¥é™åˆ¶ï¼Œå–å‡ºé™åˆ¶
int q[N];
int n,m,w;

int main()
{
    int T;
    cin&gt;&gt;T;
    while(T--)
    {
        scanf(&quot;%d%d%d&quot;,&amp;n,&amp;m,&amp;w);
        for(int i=1;i&lt;=n;i++)
            scanf(&quot;%d%d%d%d&quot;,&amp;ap[i],&amp;bp[i],&amp;as[i],&amp;bs[i]);
    
        memset(f,-0x3f,sizeof f);
        f[0][0]=0;
        for(int i=1;i&lt;=w+1;i++)
            for(int j=0;j&lt;=as[i];j++)
                f[i][j]=-j*ap[i];
        
        for(int i=1;i&lt;=n;i++)
        {
            for(int j=0;j&lt;=m;j++)
                f[i][j]=max(f[i][j],f[i-1][j]);//æ²¡æœ‰äº¤æ˜“
            if(i &lt;= w+1) continue;
            int hh=0,tt=-1;
            for(int j=0;j&lt;=m;j++)
            {
                if(hh &lt;= tt &amp;&amp; j-as[i] &gt; q[hh]) 
                    hh++;
                
                while(hh&lt;=tt &amp;&amp; f[i-w-1][j]+j*ap[i] &gt;= f[i-w-1][q[tt]]+q[tt]*ap[i])
                    tt--;
                q[++tt]=j;
                f[i][j]=max(f[i][j],f[i-w-1][q[hh]]+q[hh]*ap[i]-j*ap[i]);//ä¹°å…¥ 
             } 
             
            hh=0,tt=-1;
            for(int j=m;j&gt;=0;j--)
            {
                if(hh &lt;= tt &amp;&amp; j+bs[i] &lt; q[hh]) 
                    hh++;
                
                while(hh&lt;=tt &amp;&amp; f[i-w-1][j]+j*bp[i] &gt;= f[i-w-1][q[tt]]+q[tt]*bp[i])
                    tt--;
                q[++tt]=j;
                f[i][j]=max(f[i][j],f[i-w-1][q[hh]]+q[hh]*bp[i]-j*bp[i]);//å–å‡º 
             } 
        }
        printf(&quot;%d\n&quot;,f[n][0]);
    }
    return 0;
 } 
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ¬§æ‹‰è·¯å¾„]]></title>
        <id>https://caifxh.github.io/post/ou-la-lu-jing/</id>
        <link href="https://caifxh.github.io/post/ou-la-lu-jing/">
        </link>
        <updated>2020-04-04T15:37:39.000Z</updated>
        <content type="html"><![CDATA[<h4 id="æ¬§æ‹‰è·¯">æ¬§æ‹‰è·¯</h4>
<p>é€šè¿‡å›¾ï¼ˆæ— å‘å›¾æˆ–æœ‰å‘å›¾ï¼‰ä¸­æ‰€æœ‰è¾¹ä¸€æ¬¡ä¸”ä»…ä¸€æ¬¡è¡Œéå›¾ä¸­æ‰€æœ‰é¡¶ç‚¹çš„é€šè·¯ç§°ä¸ºæ¬§æ‹‰é€šè·¯ï¼Œé€šè¿‡å›¾ä¸­æ‰€æœ‰è¾¹ä¸€æ¬¡ä¸”ä»…ä¸€æ¬¡è¡Œéæ‰€æœ‰é¡¶ç‚¹çš„å›è·¯ç§°ä¸ºæ¬§æ‹‰å›è·¯ã€‚å…·æœ‰æ¬§æ‹‰å›è·¯çš„å›¾ç§°ä¸ºæ¬§æ‹‰å›¾ï¼ˆEuler Graphï¼‰ï¼Œå…·æœ‰æ¬§æ‹‰é€šè·¯è€Œæ— æ¬§æ‹‰å›è·¯çš„å›¾ç§°ä¸ºåŠæ¬§æ‹‰å›¾ã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_eebc2c825a-1.PNG" alt="1.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_025de6545a-3.PNG" alt="3.PNG" loading="lazy"></p>
<p><img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_06e3a60e5a-2.PNG" alt="2.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_0436e9d05a-5.PNG" alt="5.PNG" loading="lazy"><br>
(æ³¨æ„ï¼šè¿™é‡Œè¯´æœ‰å‘å›¾è¿é€šï¼Œè¯´çš„æ˜¯æœ‰å‘å›¾æ˜¯å¼±è¿é€šå›¾ã€‚å³æŠŠæœ‰å‘å›¾ä¸­çš„è¾¹å˜æˆæ— å‘è¾¹ï¼Œåªè¦è¯¥å›¾è¿é€šï¼Œé‚£ä¹ˆåŸæœ‰å‘å›¾å³æ˜¯å¼±è¿é€šå›¾ã€‚å®é™…ä¸­å¯ç”¨å¹¶æŸ¥é›†åˆ¤æ–­æ˜¯å¦å¼±è¿é€š)<br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_bfab780c5a-6.PNG" alt="6.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_0be375da5a-7.PNG" alt="7.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/02/29/9969_c5661c205a-8.PNG" alt="8.PNG" loading="lazy"></p>
<p>â€¢ æ¬§æ‹‰å›è·¯çš„æ±‚è§£æ–¹æ³•ä¸»è¦æœ‰ä¸¤ç§ï¼š</p>
<ul>
<li>DFSæœç´¢</li>
<li>Fleuryç®—æ³•</li>
</ul>
<p>ç”¨ DFS æœç´¢æ€æƒ³æ±‚è§£æ¬§æ‹‰å›è·¯çš„æ€è·¯ä¸ºï¼š</p>
<ul>
<li>åˆ©ç”¨æ¬§æ‹‰å®šç†åˆ¤æ–­å‡ºä¸€ä¸ªå›¾å­˜åœ¨æ¬§æ‹‰é€šè·¯æˆ–æ¬§æ‹‰å›è·¯ã€‚</li>
<li>é€‰æ‹©ä¸€ä¸ªæ­£ç¡®çš„èµ·å§‹é¡¶ç‚¹ï¼Œç”¨ DFS ç®—æ³•éå†æ‰€æœ‰çš„è¾¹ï¼ˆæ¯æ¡è¾¹<br>
åªéå†ä¸€æ¬¡ï¼‰ï¼Œé‡åˆ°èµ°ä¸é€šå°±å›é€€ã€‚ â€¢ åœ¨æœç´¢å‰è¿›æ–¹å‘ä¸Šå°†éå†è¿‡çš„è¾¹æŒ‰é¡ºåºè®°å½•ä¸‹æ¥ã€‚</li>
<li>è¿™ç»„è¾¹çš„æ’åˆ—å°±ç»„æˆäº†ä¸€æ¡æ¬§æ‹‰é€šè·¯æˆ–æ¬§æ‹‰å›è·¯ã€‚</li>
</ul>
<h4 id="ä¾‹é¢˜">ä¾‹é¢˜</h4>
<p>ç»™å®š n å¼ éª¨ç‰Œï¼Œæ¯å¼ éª¨ç‰Œæœ‰å·¦å³ä¸¤ä¸ªç‚¹æ•°ï¼ˆä» 1 åˆ° 6ï¼‰ã€‚é—®èƒ½ä¸èƒ½<br>
é€šè¿‡äº¤æ¢éª¨ç‰Œçš„é¡ºåºå’Œäº¤æ¢å·¦å³ä¸¤ä¸ªç‚¹æ•°ï¼Œä½¿å¾—ä»»æ„ä¸¤ä¸ªç›¸é‚»éª¨ç‰Œçš„<br>
ç›¸é‚»æ®µä¸ºç›¸ç­‰çš„æ•°å­—ã€‚<br>
åŸå§‹ï¼š (1 2)(2 4)(2 4)(6 4)(2 1)<br>
é‡æ’åï¼š (4 2)(2 1)(1 2)(2 4)(4 6)</p>
<p>æœ¬é¢˜å¯ä»¥è½¬åŒ–æˆæ¬§æ‹‰å›è·¯æˆ–æ¬§æ‹‰é€šè·¯çš„æ±‚è§£é—®é¢˜ã€‚</p>
<ul>
<li>é¦–å…ˆè¦æ„é€ ä¸€ä¸ªå›¾ï¼Ÿ</li>
<li>æ¯å¼ éª¨ç‰Œå½“ä¸€ä¸ªç‚¹ï¼Ÿ</li>
<li>å¦‚ä½•è§£å†³äº¤æ¢éª¨ç‰Œå†…éƒ¨ä¸¤ä¸ªç‚¹æ•°ï¼Ÿ</li>
</ul>
<p>å›¾å»ºå¥½ä¹‹åï¼Œå…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¬§æ‹‰é€šè·¯æˆ–æ¬§æ‹‰å›è·¯ã€‚<br>
æ€»ç»“ï¼šå­˜åœ¨ â” é€‰æ‹©æ­£ç¡®çš„èµ·ç‚¹ â” 6 â” å¼€å§‹ DFS</p>
<p><a href="https://www.acwing.com/problem/content/1125/">acwing1123</a><br>
æˆ‘ä»¬å°†è¿™ä¸ªå›¾çœ‹æˆæœ‰å‘å›¾ï¼Œå¯¹äºæ¯è¾“å…¥ä¸€ç»„æ•°æ®åŠ ä¸¤æ¡æœ‰å‘è¾¹ï¼Œéœ€è¦æ¯æ¡è¾¹éƒ½è‡³å°‘èµ°ä¸€é<br>
æˆ‘ä»¬å…ˆå›æƒ³ä¸€ä¸‹å­˜åœ¨æœ‰å‘å›¾çš„æ¬§æ‹‰è·¯å¾„çš„å……åˆ†å¿…è¦æ¡ä»¶</p>
<ul>
<li>æ‰€æœ‰ç‚¹çš„å…¥åº¦éƒ½ç­‰äºå‡ºåº¦</li>
<li>é™¤äº†ä¸¤ä¸ªç‚¹ä»¥å¤–çš„ç‚¹å…¥åº¦ç­‰äºå‡ºåº¦ï¼Œ</li>
</ul>
<p>è¿™ä¸¤ä¸ªç‚¹ä¸€ä¸ª å…¥åº¦ = å‡ºåº¦ + 1ï¼Œå¦ä¸€ä¸ª å…¥åº¦ = å‡ºåº¦ - 1<br>
å› æ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘æ¯åŠ ä¸€æ¡è¾¹ï¼Œæ¯ä¸ªç‚¹çš„å…¥åº¦å’Œå‡ºåº¦éƒ½åŠ 1<br>
æ‰€ä»¥ï¼Œæ¯ä¸ªç‚¹çš„å…¥åº¦éƒ½ä¸€å®šç­‰äºå‡ºåº¦,ç¬¦åˆä¸Šè¿°çš„ç¬¬ä¸€æ¡<br>
æ•…è¿™ä¸ªå›¾å­˜åœ¨æ¬§æ‹‰è·¯å¾„ï¼Œå¹¶ä¸”å¯ä»¥é€‰ä»»æ„ç‚¹ä¸ºèµ·ç‚¹<br>
æ‰€ä»¥æˆ‘ä»¬åªéœ€ç»Ÿè®¡æ‰€æœ‰çš„è¾¹çš„é•¿åº¦æ€»å’Œï¼Œè·Ÿæ®20km/h ç®—å‡ºæ—¶é—´å³å¯</p>
<pre><code>#include &lt;cstring&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;cmath&gt;

using namespace std;

int main()
{
    double x1, y1, x2, y2;
    cin &gt;&gt; x1 &gt;&gt; y1;

    double sum = 0;
    while (cin &gt;&gt; x1 &gt;&gt; y1 &gt;&gt; x2 &gt;&gt; y2)
    {
        double dx = x1 - x2;
        double dy = y1 - y2;
        sum += sqrt(dx * dx + dy * dy) * 2;
    }

    int minutes = round(sum / 1000 / 20 * 60);
    int hours = minutes / 60;
    minutes %= 60;

    printf(&quot;%d:%02d\n&quot;, hours, minutes);

    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/description/1126/">acwing1124</a></p>
<p>æ— å‘å›¾çš„æ¬§æ‹‰è·¯å¾„&amp;æ¬§æ‹‰å›è·¯è£¸é¢˜</p>
<pre><code>#include&lt;iostream&gt;
using namespace std;
const int N=510;
int n=500,m;
int g[N][N];
int ans[1100];
int cnt;
int d[N];

void dfs(int u)
{
    for(int i=1;i&lt;=n;i++)//ä»å°åˆ°å¤§æšä¸¾ï¼Œå­—å…¸åºæœ€å°
    {
        if(g[u][i])
        {
            g[u][i]--,g[i][u]--;
            dfs(i);
        }
    }
    
    ans[cnt++]=u;
}

int main()
{
    cin&gt;&gt;m;
    
    int l=500,r=1;
    while(m--)
    {
        int a,b;
        cin&gt;&gt;a&gt;&gt;b;
        l=min(l,min(a,b));
        r=max(r,max(a,b));
        g[a][b]++,g[b][a]++;
        d[a]++,d[b]++;
    }
    
    int start=l;
    for(int i=l;i&lt;=r;i++)
    {
        if(d[i] % 2)
        {
            start=i;
            break;
        }
    }
    
    dfs(start);//æ¬§æ‹‰å›è·¯ä»å“ªå¼€å§‹éƒ½å¯ä»¥æœï¼Œæ¬§æ‹‰è·¯è¦ä»å¥‡ç‚¹å¼€å§‹
    
    for(int i=cnt-1;i&gt;=0;i--)//é€†åºè¾“å‡º
        printf(&quot;%d\n&quot;,ans[i]);
    return 0;
}
</code></pre>
<p><a href="https://www.acwing.com/problem/content/1187/">acwing1185</a><br>
æœ‰å‘å›¾ï¼Œé¦–å°¾è¿å•è¯ï¼Œå¯ç”¨DFSå’Œå¹¶æŸ¥é›†åˆ¤æ–­è¿é€šæ€§</p>
<pre><code>#include &lt;cstdio&gt;
#include &lt;iostream&gt;
#include &lt;cstring&gt;
using namespace std;
const int N = 26, L = 1005;
int n, cnt, g[N][N], in[N], out[N];
char s[L];

void dfs(int u) {
    for (int i = 0; i &lt; 26; i++) {
        if(g[u][i]) {
            cnt++;
            g[u][i] --;
            dfs(i);
        }
    }
}
int main() {
    int T; scanf(&quot;%d&quot;, &amp;T);
    while(T--) {
        cnt = 0;
        memset(g, 0, sizeof g);
        memset(in, 0, sizeof in);
        memset(out, 0, sizeof out);
        scanf(&quot;%d&quot;, &amp;n);
        for (int i = 0; i &lt; n; i++) {
            scanf(&quot;%s&quot;, s);
            int u = s[0] - 'a', v = s[strlen(s) - 1] - 'a';
            g[u][v]++;
            out[u]++, in[v]++;
        }

        bool ok = true;
        int s = 0, t = 0;
        for (int i = 0; i &lt; 26; i++) {
            if(in[i] != out[i]) {
                if(in[i] == out[i] + 1) t ++;
                else if(in[i] + 1 == out[i]) s++;
                else { ok = false; break; }
            }
        }


        if(!(!s &amp;&amp; !t || (s == 1 &amp;&amp; t == 1))) ok = false;

        s = 0;
        while(!out[s]) s++;
        for (int i = 0; i &lt; 26; i++)
            if(in[i] + 1 == out[i]) { s = i; break; }

        dfs(s);

        if(cnt &lt; n) ok = false;
        puts(ok ? &quot;Ordering is possible.&quot; : &quot;The door cannot be opened.&quot;);
    }
    return 0;
}
</code></pre>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstdio&gt;
#include&lt;cstring&gt;
using namespace std;
const int N=30;
int n;
int din[N], dout[N], p[N];
bool st[N];


int find(int x)
{
    if (p[x] != x) p[x] = find(p[x]);
    return p[x];
}

int main()
{
    int t;
    scanf(&quot;%d&quot;,&amp;t);
    while(t--)
    {
        scanf(&quot;%d&quot;,&amp;n);
        memset(din,0,sizeof din);
        memset(dout,0,sizeof dout);
        memset(st,0,sizeof st);
        for(int i=0;i&lt;26;i++)
            p[i]=i;
        
        for(int i=0;i&lt;n;i++)
        {
            char str[1010];
            scanf(&quot;%s&quot;,str);
            int len=strlen(str);
            int a=str[0]-'a',b=str[len-1]-'a';
            st[a]=st[b]=true;
            dout[a]++,din[b]++;
            p[find(a)]=find(b);
        }
        
        int start=0,end=0;
        bool success=true;
        for(int i=0;i&lt;26;i++)
            if(din[i] != dout[i])
            {
                if(din[i] == dout[i] + 1)
                    end++;
                else if(din[i] + 1 == dout[i])
                    start++;
                else
                {
                    success=false;
                    break;
                }
            }
            
        if(!(!start &amp;&amp; !end ||start == 1 &amp;&amp; end == 1))
            success=false;
        int rep = -1;
        for (int i = 0; i &lt; 26; i ++ )
            if (st[i])
            {
                if (rep == -1) rep = find(i);
                else if (rep != find(i))
                {
                    success = false;
                    break;
                }
            }

        if (success) puts(&quot;Ordering is possible.&quot;);
        else puts(&quot;The door cannot be opened.&quot;);

    }
    return 0;
}
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ‰©å±•KMP]]></title>
        <id>https://caifxh.github.io/post/kuo-zhan-kmp/</id>
        <link href="https://caifxh.github.io/post/kuo-zhan-kmp/">
        </link>
        <updated>2020-04-03T08:16:45.000Z</updated>
        <content type="html"><![CDATA[<h4 id="zç®—æ³•">Zç®—æ³•</h4>
<p><img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_ca07496a60-1.PNG" alt="1.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_f6f54a1c60-2.PNG" alt="2.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_33dfcb7e60-3.png" alt="3.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_3623ccf060-4.png" alt="4.png" loading="lazy"><br>
r[5] = 7<br>
r[6] = 7<br>
l[5] = 5<br>
l[6] = 5<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_5abceae260-5.png" alt="5.png" loading="lazy"><br>
å¯¹äº Z[2] æˆ‘ä»¬éœ€è¦æš´åŠ›è®¡ç®—ã€‚<br>
ä¹Ÿå°±æ˜¯æš´åŠ›è®¡ç®— S[1..|S|] å’Œ S[2..|S|] çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚<br>
å¦‚æœ Z[2] &gt; 0, é‚£ä¹ˆ r = r[2], l = l[2] = 2<br>
å¦‚æœ Z[2] = 0, é‚£ä¹ˆ r = r[2] = 0, l = l[2] = 0</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ç”¨å·²æœ‰çš„ Z[2], Z[3], ..., Z[k-1]ï¼Œæ¥æ¨<br>
å‡º Z[k].<br>
å‡è®¾ k = 121, Z[2..120] å·²ç»çŸ¥é“äº†<br>
r[120] = 130, l[120] = 100<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_884cb29e60-6.png" alt="6.png" loading="lazy"><br>
åˆ’åˆ†æˆ[l,i-1],[i,r]<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_cfa5d35a60-7.png" alt="7.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_37ddc43260-8.png" alt="8.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_61fb79d060-9.PNG" alt="9.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_83939b3660-10.PNG" alt="10.PNG" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_121af6c460-11.png" alt="11.png" loading="lazy"><br>
è“è‰²éƒ¨åˆ†ä¸€å®šä¸ç›¸ç­‰ï¼Œå¦åˆ™è¯´æ˜z-boxå¯ä»¥å³ç§»</p>
<p>ç¬¬ä¸€æ­¥ï¼š<br>
åˆå§‹åŒ– Z[]ï¼Œæš´åŠ›è®¡ç®— Z[2]</p>
<pre><code>for(int i = 1;i &lt;= n;i ++) z[i] = 0;
int l, r;
while(str[1 + z[2]] == str[2 + z[2]]) z[2] ++; 
l = 2, r = 2+ z[2]-1;
</code></pre>
<p>ç¬¬äºŒæ­¥ï¼š<br>
æšä¸¾ iï¼Œåˆ†ä¸‰ç§æƒ…å†µä¾æ¬¡è®¡ç®— Z[i]</p>
<pre><code>for(int i = 3;i &lt;= n;i ++)
{
    if(i &gt; r)
    {
        while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
        l = i, r = i + z[i] - 1;
    }
    else
    {
        if(z[i - l + 1] &lt; r - i + 1) z[i] = z[i - l + 1];
        else
        {
            z[i] = r - i;
            while(str[1 + z[i]] == str[i + z[i]]) z[i] ++; 
            l = i, r = i + z[i] - 1; 
        }
    } 
}
</code></pre>
<h4 id="æ—¶é—´å¤æ‚åº¦æ˜¯-on-çš„">æ—¶é—´å¤æ‚åº¦æ˜¯ O(n) çš„</h4>
<h4 id="æ‰©å±•kmp">æ‰©å±•KMP</h4>
<p>ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² S å’Œ Tï¼ˆé•¿åº¦åˆ†åˆ«ä¸º n å’Œ mï¼‰<br>
å®šä¹‰ extend[i] ä¸º S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€çš„é•¿åº¦ã€‚<br>
æ±‚å‡º extend æ•°ç»„<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_e93cf15860-12.PNG" alt="12.PNG" loading="lazy"><br>
å¦‚æœ S = Tï¼Œé‚£ä¹ˆ extend æ•°ç»„å°±æ˜¯ Z æ•°ç»„ã€‚<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_fe0303ca60-13.PNG" alt="13.PNG" loading="lazy"></p>
<p>å‡è®¾ç°åœ¨éå†åˆ°äº† S[i]ï¼Œä¸” S[1], S[2],â€¦, S[i-1]éƒ½å·²ç»ç®—å‡º<br>
ä¸ Z ç®—æ³•ç±»ä¼¼ï¼Œè®¾ç½®ä¸¤ä¸ªå˜é‡ l å’Œ rï¼Œr è¡¨ç¤ºèƒ½å’Œ T åŒ¹<br>
é…åˆ°çš„æœ€å³è¾¹çš„ä½ç½®ï¼Œl ä¸º r å¯¹åº”çš„èµ·å§‹ä½ç½®ã€‚<br>
ä¹Ÿå°±æ˜¯ S[l .. r] = T[1.. r-l+1]<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_1677f3ac60-14.PNG" alt="14.PNG" loading="lazy"></p>
<p>S[i] å¯¹åº”çš„æ˜¯ T[i-l+1]<br>
ç°åœ¨è¦è®¡ç®—çš„æ˜¯ S[i..n] ä¸ T çš„æœ€é•¿å…¬å…±å‰ç¼€<br>
æ³¨æ„åˆ°æ­¤æ—¶ S[i..r] = T[i-l+1 .. r-l+1]<br>
æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆå¯¹ T æ±‚ä¸€é Z æ•°ç»„ï¼Œç„¶åè€ƒå¯Ÿä¸€ä¸‹ Z[i-l+1]<br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_7411db9460-15.png" alt="15.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_a95260c660-15.png" alt="15.png" loading="lazy"><br>
<img src="https://cdn.acwing.com/media/article/image/2020/03/08/9969_de7d174760-16.png" alt="16.png" loading="lazy"></p>
<pre><code>void calc_Z(char *str) 
{
	int n = strlen(str + 1);
	for(int i = 1; i &lt;= n; i ++) z[i] = 0;
	z[1] = n;
	int l, r = 0;
	for(int i = 2; i &lt;= n; i ++) 
	{
		if(i &gt; r) 
		{
			while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
			l = i, r = i + z[i] - 1;
		} else 
		{
			if(z[i - l + 1] &lt; r - i + 1) z[i] = z[i - l + 1];
			else 
			{
				z[i] = r - i + 1;
				while(str[1 + z[i]] == str[i + z[i]]) z[i] ++;
				l = i, r = i + z[i] - 1;
			}
		}
	}
}
</code></pre>
<pre><code>void calc_extend(char *S, char *T) 
{
	calc_Z(T);
	int l, r = 0;
	int n = strlen(S + 1);
	int m = strlen(T + 1);
	for (int i = 1; i &lt;= n; i ++) 
	{
		if (i &gt; r) 
		{
			while (i + ext[i] &lt;= n &amp;&amp; 1 + ext[i] &lt;= m &amp;&amp;
			        S[i + ext[i]] == T[1 + ext[i]]) ext[i] ++;
			l = i, r = i + ext[i] - 1;
		}
		else 
		{
			if (i + z[i - l + 1] - 1 &lt; r) ext[i] = z[i - l + 1];
			else 
			{
				ext[i] = r - i + 1;
				while (i + ext[i] &lt;= n &amp;&amp; 1 + ext[i] &lt;= m &amp;&amp; S[i +ext[i]] == T[1 + ext[i]]) 
					ext[i] ++;
				l = i, r = i + ext[i] - 1;
			}
		}
	}
}
</code></pre>
<h4 id="ä¾‹é¢˜">ä¾‹é¢˜</h4>
<p>é¢˜æ„ï¼šç»™ä½ nä¸ªå­—ç¬¦ä¸²ï¼Œæ±‚è¿™nä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿å…¬å…±å­ä¸²</p>
<p><a href="https://vjudge.net/problem/HDU-4333">hdu4333</a><br>
ç»™ä¸€ä¸ª L ä½æ•°çš„æ­£æ•´æ•° Nï¼Œæ¯æ¬¡å¯ä»¥æŠŠè¿™ä¸ªæ•°çš„æœ€åä¸€ä½ç§»åˆ°æœ€å‰é¢æ¥ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„æ•°ã€‚<br>
æ€»å…±æœ€å¤šå¯ä»¥å¾—åˆ° n ä¸ªæ•°ï¼Œé‡å¤çš„åªç®—ä¸€æ¬¡ã€‚<br>
é—®è¿™äº›æ•°ä¸­ï¼Œç­‰äº n çš„ï¼Œå°äº nçš„ï¼Œå¤§äº n çš„æ•°åˆ†åˆ«æœ‰å‡ ä¸ªã€‚<br>
L â‰¤ 1e5</p>
<blockquote></blockquote>
<p>æ ·ä¾‹ï¼š<br>
341 ï¼ˆç­”æ¡ˆï¼š 1 1 1ï¼‰</p>
<p>æˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªæ•°å¤åˆ¶ä¸¤éï¼Œç„¶ååªè€ƒè™‘é•¿åº¦ä¸º n çš„å­ä¸²ã€‚è¿™äº›å­ä¸²å°±æ˜¯ç§»åŠ¨è¿‡ç¨‹ä¸­äº§ç”Ÿçš„æ•°ã€‚<br>
å¦‚ä½•å’ŒåŸæ•° N åšæ¯”è¾ƒå‘¢</p>
<p>å‡è®¾ç°åœ¨çš„æ•°æ˜¯ S[i .. i+L-1], N æ˜¯ S[1..L]<br>
æˆ‘ä»¬åªè¦æ±‚å‡ºä»–ä»¬çš„æœ€é•¿å…¬å…±å‰ç¼€ xï¼Œå¦‚æœ x = n è¯´æ˜è¿™ä¸¤ä¸ªæ•°ç›¸ç­‰ã€‚<br>
å¦åˆ™ï¼Œæ¯”è¾ƒ S[x] å’Œ S[i+x-1] çš„å¤§å°ï¼Œå°±å¯ä»¥ç¡®å®šä»–ä»¬çš„å¤§å°å…³ç³»ã€‚<br>
æ±‚ x ï¼Œå°±æ˜¯æ‰©å±• KMP ä¸­çš„ Z ç®—æ³•ã€‚x = min(n, Z[i])</p>
<p>æœ€åä¸€æ­¥å»é‡ã€‚å¯¹ N è·‘ä¸€æ¬¡ KMP<br>
å¦‚æœ L-next[L] æ˜¯ L çš„çº¦æ•°ï¼Œé‚£ä¹ˆ L-next[L] æ˜¯ N çš„æœ€å°å¾ªç¯èŠ‚ã€‚å¦åˆ™ N çš„ æœ€å°å¾ªç¯èŠ‚æ˜¯ Lã€‚<br>
å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾ä¸€éå³å¯,æˆ–é™¤ä»¥æœ€å°å¾ªç¯èŠ‚ä¸ªæ•°ã€‚<br>
æ—¶é—´å¤æ‚åº¦ O(L)</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=200010;
char str[N];
int ne[N];
int z[N];

int main()
{
    int T;
    scanf(&quot;%d&quot;,&amp;T);
    for(int kas=1;kas&lt;=T;kas++)
    {
        scanf(&quot;%s&quot;,str+1);
        
        int len=strlen(str+1);
        for(int i=2,j=0;i&lt;=len;i++)
        {
            while(j &amp;&amp; str[i] != str[j+1])
                j=ne[j];
            if(str[i] == str[j+1])
                j++;
            ne[i]=j;
        }
        
        for(int i=1;i&lt;=len;i++)
            str[i+len]=str[i];
        str[len*2+1]='\0';
        memset(z,0,sizeof z);
        z[1]=len*2;
        int l,r=0;
        
        for(int i=2;i&lt;=len*2;i++)
        {
            if(i&gt;r)
            {
                while(str[1+z[i]] == str[i+z[i]])
                    z[i]++;
                l=i,r=i+z[i]-1;
            }
            else 
            {
                if(z[i-l+1] &lt; r-i+1)
                    z[i]=z[i-l+1];
                else 
                {
                    z[i]=r-i;
                    while(str[1+z[i]] == str[i+z[i]])
                        z[i]++;
                    l=i,r=i+z[i]-1;
                }
            }
        }
        
        int gre=0,eql=0,les=0;
        for(int i=1;i&lt;=len;i++)
        {
            if(z[i] &gt;= len)
                eql++;
            else if(str[1+z[i]] &gt; str[i+z[i]])
                les++;
            else gre++;
        }
        
        int t;
        if(len%(len-ne[len]) == 0)
            t=len/(len-ne[len]);//å¾ªç¯èŠ‚ä¸ªæ•° 
        else 
            t=1;
        printf(&quot;Case %d: %d %d %d\n&quot;,kas,les/t,eql/t,gre/t);
    }
}
</code></pre>
<p>å¯¹å¾ªç¯èŠ‚å†…çš„æƒ…å†µæšä¸¾<a href="https://paste.ubuntu.com/p/HrvmzSySDv/">ä»£ç </a></p>
<p><a href="https://vjudge.net/problem/POJ-3376">poj3376</a><br>
ç»™ä½  n ä¸ªå­—ç¬¦ä¸² m[1], m[2], â€¦, m[n]ã€‚ æ±‚ S = m[i]m[j] ï¼ˆ1 &lt;= i,j &lt;= nï¼‰æ˜¯å›æ–‡ä¸²çš„æ•°é‡ã€‚<br>
n ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¹‹å’Œä¸è¶…è¿‡ 2Â·1e6</p>
<blockquote></blockquote>
<p>æ ·ä¾‹è¾“å…¥ï¼š<br>
3a<br>
ab<br>
ba<br>
ç­”æ¡ˆï¼š5ï¼ˆaa,aba,aba,abba,baab)</p>
<p>è€ƒè™‘ä»€ä¹ˆæƒ…å†µä¸‹ i å’Œ j æ‹¼èµ·æ¥ä¼šæ˜¯å›æ–‡ä¸²ã€‚</p>
<ul>
<li>
<p>içš„é•¿åº¦å°äºjï¼Œé‚£ä¹ˆiä¸€å®šæ˜¯jçš„åä¸²çš„å‰ç¼€ï¼Œä¸”jçš„åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²</p>
</li>
<li>
<p>içš„é•¿åº¦ç­‰äºjï¼Œé‚£ä¹ˆiç­‰äºjçš„åä¸²</p>
</li>
<li>
<p>içš„é•¿åº¦å¤§äºjï¼Œé‚£ä¹ˆjçš„åä¸²ä¸€å®šæ˜¯içš„å‰ç¼€ï¼Œä¸”iä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²</p>
</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™nä¸ªå­—ç¬¦ä¸²æ’å…¥trieï¼Œæ¯ä¸ªèŠ‚ç‚¹è¦ç»´æŠ¤ä¸¤ä¸ªå€¼ï¼š<br>
value1. åˆ°å½“å‰èŠ‚ç‚¹çš„å­—ç¬¦ä¸²ä¸ªæ•°ï¼›value2.å½“å‰èŠ‚ç‚¹åé¢çš„å›æ–‡å­ä¸²ä¸ªæ•°</p>
<p>æˆ‘ä»¬ç”¨æ¯ä¸ªå­—ç¬¦ä¸²çš„åä¸²å»trieä¸ŠæŸ¥æ‰¾ï¼Œè¦æ„æˆå›æ–‡ä¸²æœ‰ä»¥ä¸‹æƒ…å†µï¼š</p>
<ul>
<li>
<p>1.æ­¤åä¸²æ˜¯å…¶ä»–ä¸²çš„å‰ç¼€ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡å°±è¦åŠ ä¸Švalue2</p>
</li>
<li>
<p>2.æ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€æ˜¯å›æ–‡ä¸²ï¼Œé‚£ä¹ˆç»„åˆå›æ–‡ä¸²çš„æ•°é‡è¦åŠ ä¸Švalue1</p>
</li>
<li>
<p>3.2çš„ç‰¹ä¾‹ï¼šæ­¤åä¸²çš„å‰ç¼€æ˜¯æŸäº›å­—ç¬¦ä¸²ï¼Œä¸”åä¸²å‰©ä¸‹çš„åç¼€ä¸ºç©ºï¼ŒåŒæ ·è¦åŠ ä¸Švalue1ï¼Œè¿™ç§æƒ…å†µå¯ä»¥å’Œ2ä¸€èµ·å¤„ç†</p>
</li>
</ul>
<p>ç•™ä¸‹çš„é—®é¢˜å°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€ä¸­ï¼Œå“ªäº›æ˜¯å›æ–‡ä¸²ã€‚<br>
å¯¹äºä¸² Sï¼Œæˆ‘ä»¬å…ˆæ±‚å‡ºæ­£ä¸² S å¯¹åä¸² T çš„ extend[i]<br>
é‚£ä¹ˆå¯¹äºæ¯ä¸ª iï¼Œå¦‚æœ S[i..n] å’Œ T çš„æœ€é•¿å…¬å…±å‰ç¼€ç­‰äº<br>
S[i..n] çš„é•¿åº¦ï¼Œè¯´æ˜ S[i..n] æ˜¯ä¸€ä¸ªå›æ–‡ä¸²ã€‚<br>
å› æ­¤æ•´é“é¢˜å°±åœ¨çº¿æ€§çš„æ—¶é—´å¤æ‚åº¦å†…è§£å†³äº†ã€‚</p>
<pre><code>#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
using namespace std;
const int N=2e6+10;
int trie[N][26],tot=1;
int n;
char s[N],t[N];
int len[N];
int slen;
int z[N],ext[N];
bool flag[2][N];
int bg[N],ed[N];
typedef long long LL;
struct Node
{
	int v1,v2;
}cnt[N];

void get_z(char *s)
{
	int n=strlen(s+1);
	for(int i=1;i&lt;=n;i++) z[i]=0;
	z[1]=n;
	int l,r=0;
	for(int i=2;i&lt;=n;i++)
	{
		if(i&gt;r)
		{
			while(s[1+z[i]] == s[i+z[i]])
				z[i]++;
			l=i,r=i+z[i]-1;
		}
		else
		{
			if(z[i-l+1] &lt; r-i+1)
				z[i]=z[i-l+1];
			else
			{
				z[i]=r-i;
				while(s[1+z[i]] == s[i+z[i]])
					z[i]++;
				l=i,r=i+z[i]-1;
			}
		}
	}
}

void exkmp(int type,char *s,char *t)
{
	get_z(t);
	int n=strlen(s+1);
	int m=strlen(t+1);
	for(int i=1;i&lt;=n;i++)
		ext[i]=0;
	int l,r=0;
	for(int i=1;i&lt;=n;i++)
	{
		if(i&gt;r)
		{
			while(i+ext[i] &lt;=n &amp;&amp; 1+ext[i] &lt;=m &amp;&amp;
			s[i+ext[i]] == t[1+ext[i]])
				ext[i]++;
			l=i,r=i+ext[i]-1;
		}
		else
		{
			if(z[i-l+1] &lt; r-i+1)
				ext[i]=z[i-l+1];
			else
			{
				ext[i]=r-i+1;
				while(i + ext[i] &lt;= n &amp;&amp; 1 + ext[i] &lt;= m &amp;&amp; 
				s[i+ext[i]] == t[1+ext[i]])
					ext[i]++;
				l=i,r=i+ext[i]-1;
			}
		}
	}

	for(int i=1;i&lt;=n;i++)
	{
		//cout&lt;&lt;&quot;---&quot;&lt;&lt;ext[i]&lt;&lt;endl;
		if(ext[i] == n-i+1)
			flag[type][i+slen]=true;//s[i...n]ä¸ºå›æ–‡ä¸²
	}
}

void insert(int k)
{
	int p=1;
	for(int i=bg[k];i&lt;=ed[k];i++)
	{
		cnt[p].v2+=flag[0][i];
		int ch=s[i]-'a';
		if(!trie[p][ch])
			trie[p][ch]=++tot;
		p=trie[p][ch];
	}
	cnt[p].v1++;
}

void print(int k)
{
	int p=1;
	for(int i=bg[k];i&lt;=ed[k];i++)
	{
		int ch=s[i]-'a';
		p=trie[p][ch];
		cout&lt;&lt;&quot;---&quot;&lt;&lt;cnt[p].v2&lt;&lt;' '&lt;&lt;cnt[p].v1&lt;&lt;endl;
	}
}

int main()
{
	scanf(&quot;%d&quot;,&amp;n);
	
	for(int i=1;i&lt;=n;i++)
	{
		scanf(&quot;%d&quot;,&amp;len[i]);
		scanf(&quot;%s&quot;,s+1+slen);
		for(int j=1;j&lt;=len[i];j++)
			t[slen+j]=s[slen+len[i]+1-j];
		t[slen+len[i]+1]='\0';
		exkmp(0,s+slen,t+slen);
		exkmp(1,t+slen,s+slen);

		bg[i]=slen+1;
		slen+=len[i];
		ed[i]=slen;

		insert(i);
		//print(i);
	}

	LL ans=0;
	for(int i=1;i&lt;=n;i++)
	{
		int p=1;
		bool f=true;
		for(int j=ed[i];j&gt;=bg[i];j--)//ç”¨åä¸²å»trieä¸ŠåŒ¹é…
		{
			int k=s[j]-'a';
			if(!trie[p][k])
			{
				f=false;
				break;
			}
			else
				p=trie[p][k];
			if(flag[1][bg[i]+ed[i]-j+1] || j == bg[i])
				ans+=cnt[p].v1;
		}
		if(f)
			ans+=cnt[p].v2;
	}

	printf(&quot;%lld\n&quot;,ans);
	return 0;
}
</code></pre>
]]></content>
    </entry>
</feed>